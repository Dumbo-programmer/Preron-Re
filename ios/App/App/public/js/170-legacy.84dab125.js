"use strict";(self["webpackChunkpreyron_re"]=self["webpackChunkpreyron_re"]||[]).push([[170],{6170:(t,e,n)=>{
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function s(t){try{a(r.next(t))}catch(e){o(e)}}function u(t){try{a(r["throw"](t))}catch(e){o(e)}}function a(t){t.done?n(t.value):i(t.value).then(s,u)}a((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(t){return function(e){return a([t,e])}}function a(o){if(n)throw new TypeError("Generator is already executing.");while(s)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(u){o=[6,u],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}var a=n(7062),c=n(4594),h=n(1783),f=function(t,e){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},f(t,e)};function l(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function p(t){var e="function"===typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"===typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var d,v="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},y=y||{},g=v||self;function m(){}function w(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function b(t){var e=w(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function I(t){return Object.prototype.hasOwnProperty.call(t,E)&&t[E]||(t[E]=++T)}var E="closure_uid_"+(1e9*Math.random()>>>0),T=0;function A(t,e,n){return t.call.apply(t.bind,arguments)}function N(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function D(t,e,n){return D=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?A:N,D.apply(null,arguments)}function x(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var S=Date.now;function O(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function k(){this.j=this.j,this.i=this.i}var P=0;k.prototype.j=!1,k.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0!=P))I(this)},k.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var C=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},R=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"===typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function L(t){t:{for(var e=Wn,n=t.length,r="string"===typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}function V(t){return Array.prototype.concat.apply([],arguments)}function M(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function U(t){return/^[\s\xa0]*$/.test(t)}var j,q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function F(t,e){return-1!=t.indexOf(e)}function z(t,e){return t<e?-1:t>e?1:0}t:{var B=g.navigator;if(B){var G=B.userAgent;if(G){j=G;break t}}j=""}function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function W(t){var e={};for(var n in t)e[n]=t[n];return e}var H="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i],r)t[n]=r[n];for(var o=0;o<H.length;o++)n=H[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Q(t){return Q[" "](t),t}function X(t,e){var n=ct;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}Q[" "]=m;var $,J=F(j,"Opera"),Z=F(j,"Trident")||F(j,"MSIE"),tt=F(j,"Edge"),et=tt||Z,nt=F(j,"Gecko")&&!(F(j.toLowerCase(),"webkit")&&!F(j,"Edge"))&&!(F(j,"Trident")||F(j,"MSIE"))&&!F(j,"Edge"),rt=F(j.toLowerCase(),"webkit")&&!F(j,"Edge");function it(){var t=g.document;return t?t.documentMode:void 0}t:{var ot="",st=function(){var t=j;return nt?/rv:([^\);]+)(\)|;)/.exec(t):tt?/Edge\/([\d\.]+)/.exec(t):Z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):rt?/WebKit\/(\S+)/.exec(t):J?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(st&&(ot=st?st[1]:""),Z){var ut=it();if(null!=ut&&ut>parseFloat(ot)){$=String(ut);break t}}$=ot}var at,ct={};function ht(t){return X(t,(function(){for(var e=0,n=q(String($)).split("."),r=q(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=z(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||z(0==s[2].length,0==u[2].length)||z(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e}))}if(g.document&&Z){var ft=it();at=ft||(parseInt($,10)||void 0)}else at=void 0;var lt=at,pt=!Z||9<=Number(lt),dt=Z&&!ht("9"),vt=function(){if(!g.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{g.addEventListener("test",m,e),g.removeEventListener("test",m,e)}catch(n){}return t}();function yt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function gt(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(nt){t:{try{Q(e.nodeName);var i=!0;break t}catch(o){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:mt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}yt.prototype.b=function(){this.defaultPrevented=!0},O(gt,yt);var mt={2:"touch",3:"pen",4:"mouse"};gt.prototype.b=function(){gt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,dt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(Lr){}};var wt="closure_listenable_"+(1e6*Math.random()|0),bt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++bt,this.Y=this.Z=!1}function It(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Et(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=C(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(It(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function At(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Et.prototype.add=function(t,e,n,r,i){var o=t.toString();t=this.a[o],t||(t=this.a[o]=[],this.b++);var s=At(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):(e=new _t(e,this.src,o,!!r,i),e.Z=n,t.push(e)),e};var Nt="closure_lm_"+(1e6*Math.random()|0),Dt={};function xt(t,e,n,r,i){if(r&&r.once)return kt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[wt]?t.va(e,n,_(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!pt)return null;var u=Mt(t);if(u||(t[Nt]=u=new Et(t)),n=u.add(e,n,r,s,o),n.proxy)return n;if(r=Ot(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)vt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Rt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(){var t=Vt,e=pt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(n=t.call(e.src,e.listener,n),!n)return n};return e}function kt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)kt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[wt]?t.wa(e,n,_(r)?!!r.capture:!!r,i):St(t,e,n,!0,r,i)}function Pt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);else r=_(r)?!!r.capture:!!r,n=jt(n),t&&t[wt]?(t=t.c,e=String(e).toString(),e in t.a&&(o=t.a[e],n=At(o,n,r,i),-1<n&&(It(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=Mt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=At(e,n,r,i)),(n=-1<t?e[t]:null)&&Ct(n))}function Ct(t){if("number"!==typeof t&&t&&!t.Y){var e=t.src;if(e&&e[wt])Tt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Rt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[Nt]=null)):It(t)}}}function Rt(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(!pt){if(!e)t:{e=["window","event"];for(var n=g,r=0;r<e.length;r++)if(n=n[e[r]],null==n){e=null;break t}e=n}return e=new gt(e,this),Lt(t,e)}return Lt(t,new gt(e,this))}function Mt(t){return t=t[Nt],t instanceof Et?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(t){return"function"==w(t)?t:(t[Ut]||(t[Ut]=function(e){return t.handleEvent(e)}),t[Ut])}function qt(){k.call(this),this.c=new Et(this),this.J=this,this.C=null}function Ft(t,e,n,r){if(e=t.c.a[String(e)],!e)return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Tt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}O(qt,k),qt.prototype[wt]=!0,d=qt.prototype,d.addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},d.removeEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},d.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"===typeof t)t=new yt(t,n);else if(t instanceof yt)t.target=t.target||n;else{var i=t;t=new yt(r,n),Y(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Ft(s,r,!0,t)&&i}if(s=t.a=n,i=Ft(s,r,!0,t)&&i,i=Ft(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)s=t.a=e[o],i=Ft(s,r,!1,t)&&i;return i},d.G=function(){if(qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)It(n[r]);delete e.a[t],e.b--}}this.C=null},d.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},d.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=g.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,Kt=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new Ht}),(function(t){t.reset()}),100);function Wt(){var t=Jt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Ht(){this.next=this.b=this.a=null}function Yt(t){g.setTimeout((function(){throw t}),0)}function Qt(t,e){Gt||Xt(),$t||(Gt(),$t=!0),Jt.add(t,e)}function Xt(){var t=g.Promise.resolve(void 0);Gt=function(){t.then(Zt)}}Bt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Ht.prototype.reset=function(){this.next=this.b=this.a=null};var $t=!1,Jt=new Bt;function Zt(){for(var t;t=Wt();){try{t.a.call(t.b)}catch(n){Yt(n)}var e=Kt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}$t=!1}function te(t,e){qt.call(this),this.b=t||1,this.a=e||g,this.f=D(this.Ya,this),this.g=S()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==w(t))n&&(t=D(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=D(t.handleEvent,t)}return 2147483647<Number(e)?-1:g.setTimeout(t,e||0)}function re(t){t.a=ne((function(){t.a=null,t.c&&(t.c=!1,re(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}O(te,qt),d=te.prototype,d.aa=!1,d.M=null,d.Ya=function(){if(this.aa){var t=S()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start()))}},d.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=S())},d.G=function(){te.S.G.call(this),ee(this),delete this.a};var ie=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return l(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:re(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(g.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(k);function oe(t){k.call(this),this.b=t,this.a={}}O(oe,k);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){K(t.a,(function(t,e){this.a.hasOwnProperty(e)&&Ct(t)}),t),t.a={}}function ce(){this.a=!0}function he(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var f=h.split("_");s=2<=f.length&&"type"==f[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s}))}function fe(t,e,n,r,i,o,s){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s}))}function le(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+de(t,n)+(r?" "+r:"")}))}function pe(t,e){t.info((function(){return"TIMEOUT: "+e}))}function de(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(u){return e}}oe.prototype.G=function(){oe.S.G.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var ve=null;function ye(){return ve=ve||new qt}function ge(t){yt.call(this,"serverreachability",t)}function me(t){var e=ye();e.dispatchEvent(new ge(e,t))}function we(t){yt.call(this,"statevent",t)}function be(t){var e=ye();e.dispatchEvent(new we(e,t))}function _e(t){yt.call(this,"timingevent",t)}function Ie(t,e){if("function"!=w(t))throw Error("Fn must not be null and must be a function");return g.setTimeout((function(){t()}),e)}O(ge,yt),O(we,yt),O(_e,yt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Te={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ae(){}function Ne(t){var e;return(e=t.a)||(e=t.a={}),e}function De(){}Ae.prototype.a=null;var xe,Se={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){yt.call(this,"d")}function ke(){yt.call(this,"c")}function Pe(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new oe(this),this.P=Re,t=et?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}O(Oe,yt),O(ke,yt),O(Pe,Ae),xe=new Pe;var Re=45e3,Le={},Ve={};function Me(t,e,n){t.H=1,t.i=an(en(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=S(),Fe(t),t.l=en(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),En(n.b,"t",r),t.D=0,t.a=Ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(D(t.Ca,t,t.a),t.O)),ue(t.J,t.a,"readystatechange",t.Wa),e=t.B?W(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(1),he(t.c,t.m,t.l,t.f,t.T,t.j)}function je(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=qe(t,n);if(i==Ve){4==e&&(t.h=4,be(14),r=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(i==Le){t.h=4,be(15),le(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}le(t.c,t.f,i,null),We(t,i)}4==e&&0==n.length&&(t.h=1,be(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,e=t.g,e.a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),dr(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),Ge(t))}function qe(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?Ve:(n=Number(e.substring(n,r)),isNaN(n)?Le:(r+=1,r+n>e.length?Ve:(e=e.substr(r,n),t.D=r+n,e)))}function Fe(t){t.U=S()+t.P,ze(t,t.P)}function ze(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(D(t.Ua,t),e)}function Be(t){t.o&&(g.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||gr(t.g,t)}function Ke(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),ae(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function We(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||kn(n.b,t)))if(n.I=t.N,!t.C&&kn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(Ip){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;yr(n),ir(n)}pr(n),be(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=Ie(D(n.Ra,n),6e3));if(1>=On(n.b)&&n.ea){try{n.ea()}catch(Ip){}n.ea=void 0}}else wr(n,11)}else if((t.C||n.a==t)&&yr(n),!U(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"===typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var f=a.b;!f.a&&(F(h,"spdy")||F(h,"quic")||F(h,"h2"))&&(f.f=f.g,f.a=new Set,f.b&&(Pn(f,f.b),f.b=null))}if(a.A){var l=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;l&&(a.na=l,un(a.B,a.A,l))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=S()-t.u,n.c.info("Handshake RTT: "+n.N+"ms")),a=n;var p=t;if(a.la=_r(a,a.C?a.ga:null,a.fa),p.C){Cn(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Be(d),Fe(d)),a.a=p}else lr(a);0<n.g.length&&ur(n)}else"stop"!=i[0]&&"close"!=i[0]||wr(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?wr(n,7):rr(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);me(4)}catch(Ip){}}function He(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"===typeof t)return t.split("");if(b(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(b(t)||"string"===typeof t)R(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(b(t)||"string"===typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;r=He(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$e(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],$e(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}d=Ce.prototype,d.setTimeout=function(t){this.P=t},d.Wa=function(t){t=t.target;var e=this.F;e&&3==Jn(t)?e.f():this.Ca(t)},d.Ca=function(t){try{if(t==this.a)t:{var e=Jn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!et&&!this.a.$())){this.A||4!=e||7==n||me(8==n||0>=r?3:2),Be(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,fe(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,be(12),Ke(this),Ge(this);break t}le(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,We(this,a)}this.I?(je(this,e,o),et&&this.b&&3==e&&(ue(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,o,null),We(this,o)),4==e&&Ke(this),this.b&&!this.A&&(4==e?gr(this.g,this):(this.b=!1,Fe(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,be(12)):(this.h=0,be(13)),Ke(this),Ge(this)}}}catch(c){}},d.Va=function(){if(this.a){var t=Jn(this.a),e=this.a.$();this.D<e.length&&(Be(this),je(this,t,e),this.b&&4!=t&&Fe(this))}},d.cancel=function(){this.A=!0,Ke(this)},d.Ua=function(){this.o=null;var t=S();0<=t-this.U?(pe(this.c,this.l),2!=this.H&&(me(3),be(17)),Ke(this),this.h=2,Ge(this)):ze(this,this.U-t)},d=Qe.prototype,d.K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},d.L=function(){return Xe(this),this.a.concat()},d.get=function(t,e){return $e(this.b,t)?this.b[t]:e},d.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},d.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function tn(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof tn){this.a=void 0!==e?e:t.a,nn(this,t.f),this.j=t.j,rn(this,t.c),on(this,t.h),this.g=t.g,e=t.b;var n=new wn;n.c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),sn(this,n),this.i=t.i}else t&&(n=String(t).match(Je))?(this.a=!!e,nn(this,n[1]||"",!0),this.j=fn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.g=fn(n[5]||"",!0),sn(this,n[6]||"",!0),this.i=fn(n[7]||"")):(this.a=!!e,this.b=new wn(null,this.a))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?fn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.c=n?fn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function sn(t,e,n){e instanceof wn?(t.b=e,An(t.b,t.a)):(n||(e=ln(e,gn)),t.b=new wn(e,t.a))}function un(t,e,n){t.b.set(e,n)}function an(t){return un(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^S()).toString(36)),t}function cn(t){return t instanceof tn?en(t):new tn(t,void 0)}function hn(t,e,n,r){var i=new tn(null,void 0);return t&&nn(i,t),e&&rn(i,e),n&&on(i,n),r&&(i.g=r),i}function fn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ln(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,pn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function pn(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(ln(e,dn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(ln(e,dn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.h,null!=n&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(ln(n,"/"==n.charAt(0)?yn:vn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",ln(n,mn)),t.join("")};var dn=/[#\/\?@]/g,vn=/[#\?:]/g,yn=/[#\?]/g,gn=/[#\?@]/g,mn=/#/g;function wn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function bn(t){t.a||(t.a=new Qe,t.b=0,t.c&&Ze(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function _n(t,e){bn(t),e=Tn(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,$e(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function In(t,e){return bn(t),e=Tn(t,e),$e(t.a.b,e)}function En(t,e,n){_n(t,e),0<n.length&&(t.c=null,t.a.set(Tn(t,e),M(n)),t.b+=n.length)}function Tn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function An(t,e){e&&!t.f&&(bn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(_n(this,e),En(this,n,t))}),t)),t.f=e}function Nn(t,e){this.b=t,this.a=e}function Dn(t){this.g=t||xn,g.PerformanceNavigationTiming?(t=g.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(g.ia&&g.ia.ya&&g.ia.ya()&&g.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}d=wn.prototype,d.add=function(t,e){bn(this),this.c=null,t=Tn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},d.forEach=function(t,e){bn(this),this.a.forEach((function(n,r){R(n,(function(n){t.call(e,n,r,this)}),this)}),this)},d.L=function(){bn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},d.K=function(t){bn(this);var e=[];if("string"===typeof t)In(this,t)&&(e=V(e,this.a.get(Tn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=V(e,t[n])}return e},d.set=function(t,e){return bn(this),this.c=null,t=Tn(this,t),In(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},d.get=function(t,e){return t?(t=this.K(t),0<t.length?String(t[0]):e):e},d.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var xn=10;function Sn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function On(t){return t.b?1:t.a?t.a.size:0}function kn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function Pn(t,e){t.a?t.a.add(e):t.b=e}function Cn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Rn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=p(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return M(t.c)}function Ln(){}function Vn(){this.a=new Ln}function Mn(t,e,n){var r=n||"";try{Ye(t,(function(t,n){var i=t;_(t)&&(i=zt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Un(t,e){var n=new ce;if(g.Image){var r=new Image;r.onload=x(jn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=x(jn,n,r,"TestLoadImage: error",!1,e),r.onabort=x(jn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=x(jn,n,r,"TestLoadImage: timeout",!1,e),g.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}function jn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(o){}}Dn.prototype.cancel=function(){var t,e;if(this.c=Rn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=p(this.a.values()),r=n.next();!r.done;r=n.next()){var i=r.value;i.cancel()}}catch(o){t={error:o}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Ln.prototype.stringify=function(t){return g.JSON.stringify(t,void 0)},Ln.prototype.parse=function(t){return g.JSON.parse(t,void 0)};var qn=g.JSON.parse;function Fn(t){qt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=zn,this.D=this.F=!1}O(Fn,qt);var zn="",Bn=/^https?$/i,Gn=["POST","PUT"];function Kn(t){return Z&&ht(9)&&"number"===typeof t.timeout&&void 0!==t.ontimeout}function Wn(t){return"content-type"==t.toLowerCase()}function Hn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Yn(t),Xn(t)}function Yn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Qn(t){if(t.b&&"undefined"!=typeof y&&(!t.s[1]||4!=Jn(t)||2!=t.X()))if(t.l&&4==Jn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Jn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(Je)[1]||null;if(!o&&g.self&&g.self.location){var s=g.self.location.protocol;o=s.substr(0,s.length-1)}i=!Bn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Jn(t)?t.a.statusText:""}catch(a){u=""}t.f=u+" ["+t.X()+"]",Yn(t)}}finally{Xn(t)}}}function Xn(t,e){if(t.a){$n(t);var n=t.a,r=t.s[0]?m:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){}}}function $n(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(g.clearTimeout(t.m),t.m=null)}function Jn(t){return t.a?t.a.readyState:0}function Zn(t){var e="";return K(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function tr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Zn(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):un(t,e,n))}function er(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function nr(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=er("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=er("baseRetryDelayMs",5e3,t),this.Ma=er("retryDelaySeedMs",1e4,t),this.Ja=er("forwardChannelMaxRetries",2,t),this.ma=er("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Dn(t&&t.concurrentRequestLimit),this.ka=new Vn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function rr(t){if(or(t),3==t.v){var e=t.R++,n=en(t.B);un(n,"SID",t.J),un(n,"RID",e),un(n,"TYPE","terminate"),hr(t,n),e=new Ce(t,t.c,e,void 0),e.H=2,e.i=an(en(n)),n=!1,g.navigator&&g.navigator.sendBeacon&&(n=g.navigator.sendBeacon(e.i.toString(),"")),!n&&g.Image&&((new Image).src=e.i,n=!0),n||(e.a=Ir(e.g,null),e.a.ba(e.i)),e.u=S(),Fe(e)}br(t)}function ir(t){t.a&&(dr(t),t.a.cancel(),t.a=null)}function or(t){ir(t),t.j&&(g.clearTimeout(t.j),t.j=null),yr(t),t.b.cancel(),t.h&&("number"===typeof t.h&&g.clearTimeout(t.h),t.h=null)}function sr(t,e){t.g.push(new Nn(t.La++,e)),3==t.v&&ur(t)}function ur(t){Sn(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function ar(t,e){return!(On(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.g=e.s.concat(t.g),!0):!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja))&&(t.h=Ie(D(t.Ba,t,e),mr(t,t.u)),t.u++,!0))}function cr(t,e){var n;n=e?e.f:t.R++;var r=en(t.B);un(r,"SID",t.J),un(r,"RID",n),un(r,"AID",t.P),hr(t,r),t.i&&t.l&&tr(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=fr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Pn(t.b,n),Me(n,r,e)}function hr(t,e){t.f&&Ye({},(function(t,n){un(e,n,t)}))}function fr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?D(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(c-=o,0>c)o=Math.max(0,i[a].b-100),u=!1;else try{Mn(h,s,"req"+c+"_")}catch(ri){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function lr(t){t.a||t.j||(t.U=1,Qt(t.Aa,t),t.o=0)}function pr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(D(t.Aa,t),mr(t,t.o)),t.o++,!0)}function dr(t){null!=t.s&&(g.clearTimeout(t.s),t.s=null)}function vr(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=en(t.la);un(e,"RID","rpc"),un(e,"SID",t.J),un(e,"CI",t.H?"0":"1"),un(e,"AID",t.P),hr(t,e),un(e,"TYPE","xmlhttp"),t.i&&t.l&&tr(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(en(e)),n.j=null,n.I=!0,Ue(n,t)}function yr(t){null!=t.m&&(g.clearTimeout(t.m),t.m=null)}function gr(t,e){var n=null;if(t.a==e){yr(t),dr(t),t.a=null;var r=2}else{if(!kn(t.b,e))return;n=e.s,Cn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=S()-e.u;var i=t.u;r=ye(),r.dispatchEvent(new _e(r,n,e,i)),ur(t)}else lr(t);else if(i=e.h,3==i||0==i&&0<t.I||!(1==r&&ar(t,e)||2==r&&pr(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:wr(t,5);break;case 4:wr(t,10);break;case 3:wr(t,6);break;default:wr(t,2)}}function mr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function wr(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=D(t.Xa,t);n||(n=new tn("//www.google.com/images/cleardot.gif"),g.location&&"http"==g.location.protocol||nn(n,"https"),an(n)),Un(n.toString(),r)}else be(2);t.v=0,t.f&&t.f.ra(e),br(t),or(t)}function br(t){t.v=0,t.I=-1,t.f&&(0==Rn(t.b).length&&0==t.g.length||(t.b.c.length=0,M(t.g),t.g.length=0),t.f.qa())}function _r(t,e,n){var r=cn(n);if(""!=r.c)e&&rn(r,e+"."+r.c),on(r,r.h);else{var i=g.location;r=hn(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&K(t.W,(function(t,e){un(r,e,t)})),e=t.A,n=t.na,e&&n&&un(r,e,n),un(r,"VER",t.ha),hr(t,r),r}function Ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return e=new Fn(t.Ka),e.F=t.C,e}function Er(){}function Tr(){if(Z&&!(10<=Number(lt)))throw Error("Environmental error: no available transport.")}function Ar(t,e){qt.call(this),this.a=new nr(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!U(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!U(e)&&(this.a.A=e,t=this.b,null!==t&&e in t&&(t=this.b,e in t&&delete t[e])),this.f=new xr(this)}function Nr(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Dr(){ke.call(this),this.status=1}function xr(t){this.a=t}d=Fn.prototype,d.ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ne(this.H):Ne(xe),this.a.onreadystatechange=D(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(o){return void Hn(this,o)}t=n||"";var i=new Qe(this.headers);r&&Ye(r,(function(t,e){i.set(e,t)})),r=L(i.L()),n=g.FormData&&t instanceof g.FormData,!(0<=C(Gn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{$n(this),0<this.o&&((this.D=Kn(this.a))?(this.a.timeout=this.o,this.a.ontimeout=D(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(o){Hn(this,o)}},d.xa=function(){"undefined"!=typeof y&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},d.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Xn(this))},d.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Xn(this,!0)),Fn.S.G.call(this)},d.za=function(){this.j||(this.A||this.l||this.g?Qn(this):this.Ta())},d.Ta=function(){Qn(this)},d.X=function(){try{return 2<Jn(this)?this.a.status:-1}catch(t){return-1}},d.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},d.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),qn(e)}},d.ua=function(){return this.h},d.Qa=function(){return"string"===typeof this.f?this.f:String(this.f)},d=nr.prototype,d.ha=8,d.v=1,d.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?(r=W(r),Y(r,this.O)):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(o="__data__"in o.a&&(o=o.a.__data__,"string"===typeof o)?o.length:void 0,void 0===o)break;if(e+=o,4096<e){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=fr(this,n,e),i=en(this.B),un(i,"RID",t),un(i,"CVER",22),this.A&&un(i,"X-HTTP-Session-Id",this.A),hr(this,i),this.i&&r&&tr(i,this.i,r),Pn(this.b,n),this.Ga&&un(i,"TYPE","init"),this.da?(un(i,"$req",e),un(i,"SID","null"),n.V=!0,Me(n,i,null)):Me(n,i,e),this.v=2}}else 3==this.v&&(t?cr(this,t):0==this.g.length||Sn(this.b)||cr(this))},d.Aa=function(){if(this.j=null,vr(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=Ie(D(this.Sa,this),t)}},d.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,ir(this),vr(this))},d.Ra=function(){null!=this.m&&(this.m=null,ir(this),pr(this),be(19))},d.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),be(2)):(this.c.info("Failed to ping google.com"),be(1))},d=Er.prototype,d.ta=function(){},d.sa=function(){},d.ra=function(){},d.qa=function(){},d.Ha=function(){},Tr.prototype.a=function(t,e){return new Ar(t,e)},O(Ar,qt),d=Ar.prototype,d.addEventListener=function(t,e,n,r){Ar.S.addEventListener.call(this,t,e,n,r)},d.removeEventListener=function(t,e,n,r){Ar.S.removeEventListener.call(this,t,e,n,r)},d.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=_r(t,null,t.fa),ur(t)},d.close=function(){rr(this.a)},d.Pa=function(t){if("string"===typeof t){var e={};e.__data__=t,sr(this.a,e)}else this.g?(e={},e.__data__=zt(t),sr(this.a,e)):sr(this.a,t)},d.G=function(){this.a.f=null,delete this.f,rr(this.a),delete this.a,Ar.S.G.call(this)},O(Nr,Oe),O(Dr,ke),O(xr,Er),xr.prototype.ta=function(){this.a.dispatchEvent("a")},xr.prototype.sa=function(t){this.a.dispatchEvent(new Nr(t))},xr.prototype.ra=function(t){this.a.dispatchEvent(new Dr(t))},xr.prototype.qa=function(){this.a.dispatchEvent("b")},Tr.prototype.createWebChannel=Tr.prototype.a,Ar.prototype.send=Ar.prototype.Pa,Ar.prototype.open=Ar.prototype.Oa,Ar.prototype.close=Ar.prototype.close,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Te.COMPLETE="complete",De.EventType=Se,Se.OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",qt.prototype.listen=qt.prototype.va,Fn.prototype.listenOnce=Fn.prototype.wa,Fn.prototype.getLastError=Fn.prototype.Qa,Fn.prototype.getLastErrorCode=Fn.prototype.ua,Fn.prototype.getStatus=Fn.prototype.X,Fn.prototype.getResponseJson=Fn.prototype.Na,Fn.prototype.getResponseText=Fn.prototype.$,Fn.prototype.send=Fn.prototype.ba;var Sr=function(){return new Tr},Or=Ee,kr=Te,Pr=De,Cr=Fn;var Rr=n(8202),Lr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},Vr=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Mr=function(){function t(t){this.uid=t}return t.prototype.u=function(){return null!=this.uid},t.prototype.h=function(){return this.u()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Mr.UNAUTHENTICATED=new Mr(null),Mr.l=new Mr("google-credentials-uid"),Mr._=new Mr("first-party-uid");
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Ur=new c.Yd("@firebase/firestore");function jr(){return Ur.logLevel}function qr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ur.logLevel<=c["in"].DEBUG){var r=e.map(Br);Ur.debug.apply(Ur,u(["Firestore (8.1.0): "+t],r))}}function Fr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ur.logLevel<=c["in"].ERROR){var r=e.map(Br);Ur.error.apply(Ur,u(["Firestore (8.1.0): "+t],r))}}function zr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Ur.logLevel<=c["in"].WARN){var r=e.map(Br);Ur.warn.apply(Ur,u(["Firestore (8.1.0): "+t],r))}}function Br(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.1.0) INTERNAL ASSERTION FAILED: "+t;throw Fr(e),new Error(e)}function Kr(t,e){t||Gr()}function Wr(t,e){return t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Yr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return i(e,t),e}(Error),Qr=function(t,e){this.user=e,this.type="OAuth",this.T={},this.T.Authorization="Bearer "+t},Xr=function(){function t(){this.I=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.m=function(){},t.prototype.A=function(t){this.I=t,t(Mr.UNAUTHENTICATED)},t.prototype.R=function(){this.I=null},t}(),$r=function(){function t(t){var e=this;this.P=null,this.currentUser=Mr.UNAUTHENTICATED,this.g=!1,this.V=0,this.I=null,this.forceRefresh=!1,this.P=function(){e.V++,e.currentUser=e.p(),e.g=!0,e.I&&e.I(e.currentUser)},this.V=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.P):(this.P(null),t.get().then((function(t){e.auth=t,e.P&&e.auth.addAuthTokenListener(e.P)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.V,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.V!==e?(qr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Kr("string"==typeof n.accessToken),new Qr(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.m=function(){this.forceRefresh=!0},t.prototype.A=function(t){this.I=t,this.g&&t(this.currentUser)},t.prototype.R=function(){this.auth&&this.auth.removeAuthTokenListener(this.P),this.P=null,this.I=null},t.prototype.p=function(){var t=this.auth&&this.auth.getUid();return Kr(null===t||"string"==typeof t),new Mr(t)},t}(),Jr=function(){function t(t,e){this.v=t,this.S=e,this.type="FirstParty",this.user=Mr._}return Object.defineProperty(t.prototype,"T",{get:function(){var t={"X-Goog-AuthUser":this.S},e=this.v.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Zr=function(){function t(t,e){this.v=t,this.S=e}return t.prototype.getToken=function(){return Promise.resolve(new Jr(this.v,this.S))},t.prototype.A=function(t){t(Mr._)},t.prototype.R=function(){},t.prototype.m=function(){},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ti(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ei=function(){function t(){}return t.D=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=ti(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ni(t,e){return t<e?-1:t>e?1:0}function ri(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function ii(t){return t+"\0"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Yr(Hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Yr(Hr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Yr(Hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Yr(Hr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.C=function(t){return this.seconds===t.seconds?ni(this.nanoseconds,t.nanoseconds):ni(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),si=function(){function t(t){this.timestamp=t}return t.N=function(e){return new t(e)},t.min=function(){return new t(new oi(0,0))},t.prototype.F=function(t){return this.timestamp.C(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.O=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.M=function(){return this.timestamp},t}(),ui=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Gr(),void 0===n?n=t.length-e:n>t.length-e&&Gr(),this.segments=t,this.offset=e,this.k=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.$(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.L(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.B=function(t){return t=void 0===t?1:t,this.L(this.segments,this.offset+t,this.length-t)},t.prototype.q=function(){return this.L(this.segments,this.offset,this.length-1)},t.prototype.U=function(){return this.segments[this.offset]},t.prototype.K=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.W=function(){return 0===this.length},t.prototype.j=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.G=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.H=function(){return this.segments.slice(this.offset,this.limit())},t.$=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),ai=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.prototype.J=function(){return this.H().join("/")},e.prototype.toString=function(){return this.J()},e.Y=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid segment ("+s+"). Paths must not contain // in them.");r.push.apply(r,s.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.X=function(){return new e([])},e}(ui),ci=/^[_a-zA-Z][_a-zA-Z0-9]*$/,hi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.L=function(t,n,r){return new e(t,n,r)},e.Z=function(t){return ci.test(t)},e.prototype.J=function(){return this.H().map((function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.Z(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.J()},e.prototype.tt=function(){return 1===this.length&&"__name__"===this.get(0)},e.et=function(){return new e(["__name__"])},e.nt=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Yr(Hr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Yr(Hr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Yr(Hr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.X=function(){return new e([])},e}(ui),fi=function(){function t(t){this.path=t}return t.st=function(e){return new t(ai.Y(e))},t.it=function(e){return new t(ai.Y(e).B(5))},t.prototype.rt=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===ai.$(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.$=function(t,e){return ai.$(t.path,e.path)},t.ot=function(t){return t.length%2==0},t.ct=function(e){return new t(new ai(e.slice()))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function li(t){return null==t}function pi(t){return 0===t&&1/t==-1/0}function di(t){return"number"==typeof t&&Number.isInteger(t)&&!pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null};function yi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new vi(t,e,n,r,i,o,s)}function gi(t){var e=Wr(t);if(null===e.ut){var n=e.path.J();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.J()+t.op.toString()+lo(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.J()+t.dir}(t)})).join(","),li(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=vu(e.startAt)),e.endAt&&(n+="|ub:",n+=vu(e.endAt)),e.ut=n}return e.ut}function mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!bu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!ao(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gu(t.startAt,e.startAt)&&gu(t.endAt,e.endAt)}function wi(t){return fi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bi=function(){function t(t){this.at=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.at,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.at)},t.prototype.ht=function(){return 2*this.at.length},t.prototype.F=function(t){return ni(this.at,t.at)},t.prototype.isEqual=function(t){return this.at===t.at},t}();bi.lt=new bi("");var _i,Ii,Ei=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=si.min()),void 0===o&&(o=si.min()),void 0===s&&(s=bi.lt),this.target=t,this.targetId=e,this._t=n,this.sequenceNumber=r,this.ft=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.dt=function(e){return new t(this.target,this.targetId,this._t,e,this.ft,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.wt=function(e,n){return new t(this.target,this.targetId,this._t,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.Et=function(e){return new t(this.target,this.targetId,this._t,this.sequenceNumber,this.ft,e,this.resumeToken)},t}(),Ti=function(t){this.count=t};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ai(t){switch(t){case Hr.OK:return Gr();case Hr.CANCELLED:case Hr.UNKNOWN:case Hr.DEADLINE_EXCEEDED:case Hr.RESOURCE_EXHAUSTED:case Hr.INTERNAL:case Hr.UNAVAILABLE:case Hr.UNAUTHENTICATED:return!1;case Hr.INVALID_ARGUMENT:case Hr.NOT_FOUND:case Hr.ALREADY_EXISTS:case Hr.PERMISSION_DENIED:case Hr.FAILED_PRECONDITION:case Hr.ABORTED:case Hr.OUT_OF_RANGE:case Hr.UNIMPLEMENTED:case Hr.DATA_LOSS:return!0;default:return Gr()}}function Ni(t){if(void 0===t)return Fr("GRPC error has no .code"),Hr.UNKNOWN;switch(t){case _i.OK:return Hr.OK;case _i.CANCELLED:return Hr.CANCELLED;case _i.UNKNOWN:return Hr.UNKNOWN;case _i.DEADLINE_EXCEEDED:return Hr.DEADLINE_EXCEEDED;case _i.RESOURCE_EXHAUSTED:return Hr.RESOURCE_EXHAUSTED;case _i.INTERNAL:return Hr.INTERNAL;case _i.UNAVAILABLE:return Hr.UNAVAILABLE;case _i.UNAUTHENTICATED:return Hr.UNAUTHENTICATED;case _i.INVALID_ARGUMENT:return Hr.INVALID_ARGUMENT;case _i.NOT_FOUND:return Hr.NOT_FOUND;case _i.ALREADY_EXISTS:return Hr.ALREADY_EXISTS;case _i.PERMISSION_DENIED:return Hr.PERMISSION_DENIED;case _i.FAILED_PRECONDITION:return Hr.FAILED_PRECONDITION;case _i.ABORTED:return Hr.ABORTED;case _i.OUT_OF_RANGE:return Hr.OUT_OF_RANGE;case _i.UNIMPLEMENTED:return Hr.UNIMPLEMENTED;case _i.DATA_LOSS:return Hr.DATA_LOSS;default:return Gr()}}(Ii=_i||(_i={}))[Ii.OK=0]="OK",Ii[Ii.CANCELLED=1]="CANCELLED",Ii[Ii.UNKNOWN=2]="UNKNOWN",Ii[Ii.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ii[Ii.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ii[Ii.NOT_FOUND=5]="NOT_FOUND",Ii[Ii.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ii[Ii.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ii[Ii.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ii[Ii.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ii[Ii.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ii[Ii.ABORTED=10]="ABORTED",Ii[Ii.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ii[Ii.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ii[Ii.INTERNAL=13]="INTERNAL",Ii[Ii.UNAVAILABLE=14]="UNAVAILABLE",Ii[Ii.DATA_LOSS=15]="DATA_LOSS";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Di=function(){function t(t,e){this.$=t,this.root=e||Si.EMPTY}return t.prototype.Tt=function(e,n){return new t(this.$,this.root.Tt(e,n,this.$).copy(null,null,Si.It,null,null))},t.prototype.remove=function(e){return new t(this.$,this.root.remove(e,this.$).copy(null,null,Si.It,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.W();){var n=this.$(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.W();){var r=this.$(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.W=function(){return this.root.W()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.At=function(){return this.root.At()},t.prototype.Rt=function(){return this.root.Rt()},t.prototype.Pt=function(t){return this.root.Pt(t)},t.prototype.forEach=function(t){this.Pt((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.Pt((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.gt=function(t){return this.root.gt(t)},t.prototype.yt=function(){return new xi(this.root,null,this.$,!1)},t.prototype.Vt=function(t){return new xi(this.root,t,this.$,!1)},t.prototype.vt=function(){return new xi(this.root,null,this.$,!0)},t.prototype.bt=function(t){return new xi(this.root,t,this.$,!0)},t}(),xi=function(){function t(t,e,n,r){this.St=r,this.Dt=[];for(var i=1;!t.W();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.St?t.left:t.right;else{if(0===i){this.Dt.push(t);break}this.Dt.push(t),t=this.St?t.right:t.left}}return t.prototype.Ct=function(){var t=this.Dt.pop(),e={key:t.key,value:t.value};if(this.St)for(t=t.left;!t.W();)this.Dt.push(t),t=t.right;else for(t=t.right;!t.W();)this.Dt.push(t),t=t.left;return e},t.prototype.Nt=function(){return this.Dt.length>0},t.prototype.xt=function(){if(0===this.Dt.length)return null;var t=this.Dt[this.Dt.length-1];return{key:t.key,value:t.value}},t}(),Si=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.W=function(){return!1},t.prototype.Pt=function(t){return this.left.Pt(t)||t(this.key,this.value)||this.right.Pt(t)},t.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},t.prototype.min=function(){return this.left.W()?this:this.left.min()},t.prototype.At=function(){return this.min().key},t.prototype.Rt=function(){return this.right.W()?this.key:this.right.Rt()},t.prototype.Tt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.Tt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.Tt(t,e,n))).Ft()},t.prototype.Ot=function(){if(this.left.W())return t.EMPTY;var e=this;return e.left.Mt()||e.left.left.Mt()||(e=e.kt()),(e=e.copy(null,null,null,e.left.Ot(),null)).Ft()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.W()||i.left.Mt()||i.left.left.Mt()||(i=i.kt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.Mt()&&(i=i.$t()),i.right.W()||i.right.Mt()||i.right.left.Mt()||(i=i.Lt()),0===n(e,i.key)){if(i.right.W())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Ot())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Ft()},t.prototype.Mt=function(){return this.color},t.prototype.Ft=function(){var t=this;return t.right.Mt()&&!t.left.Mt()&&(t=t.Bt()),t.left.Mt()&&t.left.left.Mt()&&(t=t.$t()),t.left.Mt()&&t.right.Mt()&&(t=t.qt()),t},t.prototype.kt=function(){var t=this.qt();return t.right.left.Mt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.$t())).Bt()).qt()),t},t.prototype.Lt=function(){var t=this.qt();return t.left.left.Mt()&&(t=(t=t.$t()).qt()),t},t.prototype.Bt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.$t=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.qt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Ut=function(){var t=this.Qt();return Math.pow(2,t)<=this.size+1},t.prototype.Qt=function(){if(this.Mt()&&this.left.Mt())throw Gr();if(this.right.Mt())throw Gr();var t=this.left.Qt();if(t!==this.right.Qt())throw Gr();return t+(this.Mt()?0:1)},t}();Si.EMPTY=null,Si.RED=!0,Si.It=!1,Si.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Gr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Gr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.Tt=function(t,e,n){return new Si(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.W=function(){return!0},t.prototype.Pt=function(t){return!1},t.prototype.gt=function(t){return!1},t.prototype.At=function(){return null},t.prototype.Rt=function(){return null},t.prototype.Mt=function(){return!1},t.prototype.Ut=function(){return!0},t.prototype.Qt=function(){return 0},t}());
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Oi=function(){function t(t){this.$=t,this.data=new Di(this.$)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.At()},t.prototype.last=function(){return this.data.Rt()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.Pt((function(e,n){return t(e),!1}))},t.prototype.Kt=function(t,e){for(var n=this.data.Vt(t[0]);n.Nt();){var r=n.Ct();if(this.$(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Wt=function(t,e){var n;for(n=void 0!==e?this.data.Vt(e):this.data.yt();n.Nt();)if(!t(n.Ct().key))return},t.prototype.jt=function(t){var e=this.data.Vt(t);return e.Nt()?e.Ct().key:null},t.prototype.yt=function(){return new ki(this.data.yt())},t.prototype.Vt=function(t){return new ki(this.data.Vt(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).Tt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.W=function(){return this.data.W()},t.prototype.Gt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.yt(),r=e.data.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(0!==this.$(i,o))return!1}return!0},t.prototype.H=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.$);return n.data=e,n},t}(),ki=function(){function t(t){this.zt=t}return t.prototype.Ct=function(){return this.zt.Ct().key},t.prototype.Nt=function(){return this.zt.Nt()},t}(),Pi=new Di(fi.$);function Ci(){return Pi}function Ri(){return Ci()}var Li=new Di(fi.$);function Vi(){return Li}var Mi=new Di(fi.$),Ui=new Oi(fi.$);function ji(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ui,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var qi=new Oi(ni);function Fi(){return qi}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zi=function(){function t(t){this.$=t?function(e,n){return t(e,n)||fi.$(e.key,n.key)}:function(t,e){return fi.$(t.key,e.key)},this.Ht=Vi(),this.Jt=new Di(this.$)}return t.Yt=function(e){return new t(e.$)},t.prototype.has=function(t){return null!=this.Ht.get(t)},t.prototype.get=function(t){return this.Ht.get(t)},t.prototype.first=function(){return this.Jt.At()},t.prototype.last=function(){return this.Jt.Rt()},t.prototype.W=function(){return this.Jt.W()},t.prototype.indexOf=function(t){var e=this.Ht.get(t);return e?this.Jt.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Jt.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Jt.Pt((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ht.Tt(t.key,t),e.Jt.Tt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ht.remove(t),this.Jt.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Jt.yt(),r=e.Jt.yt();n.Nt();){var i=n.Ct().key,o=r.Ct().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.$=this.$,r.Ht=e,r.Jt=n,r},t}(),Bi=function(){function t(){this.Xt=new Di(fi.$)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Xt.get(e);n?0!==t.type&&3===n.type?this.Xt=this.Xt.Tt(e,t):3===t.type&&1!==n.type?this.Xt=this.Xt.Tt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Xt=this.Xt.Tt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Xt=this.Xt.remove(e):1===t.type&&2===n.type?this.Xt=this.Xt.Tt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Xt=this.Xt.Tt(e,{type:2,doc:t.doc}):Gr():this.Xt=this.Xt.Tt(e,t)},t.prototype.Zt=function(){var t=[];return this.Xt.Pt((function(e,n){t.push(n)})),t},t}(),Gi=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.te=n,this.docChanges=r,this.ee=i,this.fromCache=o,this.ne=s,this.se=u}return t.ie=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,zi.Yt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.ee.W()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.ne===t.ne&&this.ee.isEqual(t.ee)&&tu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.te.isEqual(t.te)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Ki=function(){function t(t,e,n,r,i){this.ft=t,this.re=e,this.oe=n,this.ce=r,this.ue=i}return t.ae=function(e,n){var r=new Map;return r.set(e,Wi.he(e,n)),new t(si.min(),r,Fi(),Ci(),ji())},t}(),Wi=function(){function t(t,e,n,r,i){this.resumeToken=t,this.le=e,this._e=n,this.fe=r,this.de=i}return t.he=function(e,n){return new t(bi.lt,n,ji(),ji(),ji())},t}(),Hi=function(t,e,n,r){this.we=t,this.removedTargetIds=e,this.key=n,this.Ee=r},Yi=function(t,e){this.targetId=t,this.Te=e},Qi=function(t,e,n,r){void 0===n&&(n=bi.lt),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Xi=function(){function t(){this.Ie=0,this.me=Zi(),this.Ae=bi.lt,this.Re=!1,this.Pe=!0}return Object.defineProperty(t.prototype,"le",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.Ae},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ge",{get:function(){return 0!==this.Ie},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ye",{get:function(){return this.Pe},enumerable:!1,configurable:!0}),t.prototype.Ve=function(t){t.ht()>0&&(this.Pe=!0,this.Ae=t)},t.prototype.pe=function(){var t=ji(),e=ji(),n=ji();return this.me.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Gr()}})),new Wi(this.Ae,this.Re,t,e,n)},t.prototype.ve=function(){this.Pe=!1,this.me=Zi()},t.prototype.be=function(t,e){this.Pe=!0,this.me=this.me.Tt(t,e)},t.prototype.Se=function(t){this.Pe=!0,this.me=this.me.remove(t)},t.prototype.De=function(){this.Ie+=1},t.prototype.Ce=function(){this.Ie-=1},t.prototype.Ne=function(){this.Pe=!0,this.Re=!0},t}(),$i=function(){function t(t){this.xe=t,this.Fe=new Map,this.Oe=Ci(),this.Me=Ji(),this.ke=new Oi(ni)}return t.prototype.$e=function(t){for(var e=0,n=t.we;e<n.length;e++){var r=n[e];t.Ee instanceof qs?this.Le(r,t.Ee):t.Ee instanceof Fs&&this.Be(r,t.key,t.Ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Be(s,t.key,t.Ee)}},t.prototype.qe=function(t){var e=this;this.Ue(t,(function(n){var r=e.Qe(n);switch(t.state){case 0:e.Ke(n)&&r.Ve(t.resumeToken);break;case 1:r.Ce(),r.ge||r.ve(),r.Ve(t.resumeToken);break;case 2:r.Ce(),r.ge||e.removeTarget(n);break;case 3:e.Ke(n)&&(r.Ne(),r.Ve(t.resumeToken));break;case 4:e.Ke(n)&&(e.We(n),r.Ve(t.resumeToken));break;default:Gr()}}))},t.prototype.Ue=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Fe.forEach((function(t,r){n.Ke(r)&&e(r)}))},t.prototype.je=function(t){var e=t.targetId,n=t.Te.count,r=this.Ge(e);if(r){var i=r.target;if(wi(i))if(0===n){var o=new fi(i.path);this.Be(e,o,new Fs(o,si.min()))}else Kr(1===n);else this.ze(e)!==n&&(this.We(e),this.ke=this.ke.add(e))}},t.prototype.He=function(t){var e=this,n=new Map;this.Fe.forEach((function(r,i){var o=e.Ge(i);if(o){if(r.le&&wi(o.target)){var s=new fi(o.target.path);null!==e.Oe.get(s)||e.Je(i,s)||e.Be(i,s,new Fs(s,t))}r.ye&&(n.set(i,r.pe()),r.ve())}}));var r=ji();this.Me.forEach((function(t,n){var i=!0;n.Wt((function(t){var n=e.Ge(t);return!n||2===n._t||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Ki(t,n,this.ke,this.Oe,r);return this.Oe=Ci(),this.Me=Ji(),this.ke=new Oi(ni),i},t.prototype.Le=function(t,e){if(this.Ke(t)){var n=this.Je(t,e.key)?2:0;this.Qe(t).be(e.key,n),this.Oe=this.Oe.Tt(e.key,e),this.Me=this.Me.Tt(e.key,this.Ye(e.key).add(t))}},t.prototype.Be=function(t,e,n){if(this.Ke(t)){var r=this.Qe(t);this.Je(t,e)?r.be(e,1):r.Se(e),this.Me=this.Me.Tt(e,this.Ye(e).delete(t)),n&&(this.Oe=this.Oe.Tt(e,n))}},t.prototype.removeTarget=function(t){this.Fe.delete(t)},t.prototype.ze=function(t){var e=this.Qe(t).pe();return this.xe.Xe(t).size+e._e.size-e.de.size},t.prototype.De=function(t){this.Qe(t).De()},t.prototype.Qe=function(t){var e=this.Fe.get(t);return e||(e=new Xi,this.Fe.set(t,e)),e},t.prototype.Ye=function(t){var e=this.Me.get(t);return e||(e=new Oi(ni),this.Me=this.Me.Tt(t,e)),e},t.prototype.Ke=function(t){var e=null!==this.Ge(t);return e||qr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.Ge=function(t){var e=this.Fe.get(t);return e&&e.ge?null:this.xe.Ze(t)},t.prototype.We=function(t){var e=this;this.Fe.set(t,new Xi),this.xe.Xe(t).forEach((function(n){e.Be(t,n,null)}))},t.prototype.Je=function(t,e){return this.xe.Xe(t).has(e)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(){return new Di(fi.$)}function Zi(){return new Di(fi.$)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function to(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function eo(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function no(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ro(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function io(t){var e=t.mapValue.fields.__previous_value__;return ro(e)?io(e):e}function oo(t){var e=vo(t.mapValue.fields.__local_write_time__.timestampValue);return new oi(e.seconds,e.nanos)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var so=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ro(t)?4:10:Gr()}function ao(t,e){var n=uo(t);if(n!==uo(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return oo(t).isEqual(oo(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vo(t.timestampValue),r=vo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return go(t.bytesValue).isEqual(go(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return yo(t.geoPointValue.latitude)===yo(e.geoPointValue.latitude)&&yo(t.geoPointValue.longitude)===yo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yo(t.integerValue)===yo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=yo(t.doubleValue),r=yo(e.doubleValue);return n===r?pi(n)===pi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ri(t.arrayValue.values||[],e.arrayValue.values||[],ao);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(to(n)!==to(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ao(n[i],r[i])))return!1;return!0}(t,e);default:return Gr()}}function co(t,e){return void 0!==(t.values||[]).find((function(t){return ao(t,e)}))}function ho(t,e){var n=uo(t),r=uo(e);if(n!==r)return ni(n,r);switch(n){case 0:return 0;case 1:return ni(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=yo(t.integerValue||t.doubleValue),r=yo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return fo(t.timestampValue,e.timestampValue);case 4:return fo(oo(t),oo(e));case 5:return ni(t.stringValue,e.stringValue);case 6:return function(t,e){var n=go(t),r=go(e);return n.F(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ni(n[i],r[i]);if(0!==o)return o}return ni(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ni(yo(t.latitude),yo(e.latitude));return 0!==n?n:ni(yo(t.longitude),yo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ho(n[i],r[i]);if(o)return o}return ni(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ni(r[s],o[s]);if(0!==u)return u;var a=ho(n[r[s]],i[o[s]]);if(0!==a)return a}return ni(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Gr()}}function fo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ni(t,e);var n=vo(t),r=vo(e),i=ni(n.seconds,r.seconds);return 0!==i?i:ni(n.nanos,r.nanos)}function lo(t){return po(t)}function po(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=vo(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?go(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,fi.it(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=po(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+po(t.fields[o])}return e+"}"}(t.mapValue):Gr();var e,n}function vo(t){if(Kr(!!t),"string"==typeof t){var e=0,n=so.exec(t);if(Kr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:yo(t.seconds),nanos:yo(t.nanos)}}function yo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function go(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function mo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.J()}}function wo(t){return!!t&&"integerValue"in t}function bo(t){return!!t&&"arrayValue"in t}function _o(t){return!!t&&"nullValue"in t}function Io(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Eo(t){return!!t&&"mapValue"in t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var To={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},No=function(t,e){this.t=t,this.tn=e};function Do(t){return{integerValue:""+t}}function xo(t,e){if(t.tn){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function So(t,e){return di(e)?Do(e):xo(t,e)}function Oo(t,e){return t.tn?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ko(t,e){return t.tn?e.toBase64():e.toUint8Array()}function Po(t,e){return Oo(t,e.M())}function Co(t){return Kr(!!t),si.N(function(t){var e=vo(t);return new oi(e.seconds,e.nanos)}(t))}function Ro(t,e){return function(t){return new ai(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).J()}function Lo(t){var e=ai.Y(t);return Kr(is(e)),e}function Vo(t,e){return Ro(t.t,e.path)}function Mo(t,e){var n=Lo(e);if(n.get(1)!==t.t.projectId)throw new Yr(Hr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.t.projectId);if(n.get(3)!==t.t.database)throw new Yr(Hr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.t.database);return new fi(Fo(n))}function Uo(t,e){return Ro(t.t,e)}function jo(t){var e=Lo(t);return 4===e.length?ai.X():Fo(e)}function qo(t){return new ai(["projects",t.t.projectId,"databases",t.t.database]).J()}function Fo(t){return Kr(t.length>4&&"documents"===t.get(4)),t.B(5)}function zo(t,e,n){return{name:Vo(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n;if(e instanceof xs)n={update:zo(t,e.key,e.value)};else if(e instanceof Rs)n={delete:Vo(t,e.key)};else if(e instanceof Ss)n={update:zo(t,e.key,e.data),updateMask:rs(e.en)};else if(e instanceof ks)n={transform:{document:Vo(t,e.key),fieldTransforms:e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof cs)return{fieldPath:e.field.J(),setToServerValue:"REQUEST_TIME"};if(n instanceof hs)return{fieldPath:e.field.J(),appendMissingElements:{values:n.elements}};if(n instanceof ls)return{fieldPath:e.field.J(),removeAllFromArray:{values:n.elements}};if(n instanceof ds)return{fieldPath:e.field.J(),increment:n.nn};throw Gr()}(0,t)}))}};else{if(!(e instanceof Ls))return Gr();n={verify:Vo(t,e.key)}}return e.rn.sn||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Po(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Gr()}(t,e.rn)),n}function Go(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?bs.updateTime(Co(t.updateTime)):void 0!==t.exists?bs.exists(t.exists):bs.on()}(e.currentDocument):bs.on();if(e.update){e.update.name;var r=Mo(t,e.update.name),i=new Vs({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new gs(e.map((function(t){return hi.nt(t)})))}(e.updateMask);return new Ss(r,i,o,n)}return new xs(r,i,n)}if(e.delete){var s=Mo(t,e.delete);return new Rs(s,n)}if(e.transform){var u=Mo(t,e.transform.document),a=e.transform.fieldTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Kr("REQUEST_TIME"===e.setToServerValue),n=new cs;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new hs(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new ls(i)}else"increment"in e?n=new ds(t,e.increment):Gr();var o=hi.nt(e.fieldPath);return new ms(o,n)}(t,e)}));return Kr(!0===n.exists),new ks(u,a)}if(e.verify){var c=Mo(t,e.verify);return new Ls(c,n)}return Gr()}function Ko(t,e){return{documents:[Uo(t,e.path)]}}function Wo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Uo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Uo(t,r.q()),n.structuredQuery.from=[{collectionId:r.K()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Io(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NAN"}};if(_o(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Io(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NAN"}};if(_o(t.value))return{unaryFilter:{field:Zo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zo(t.field),op:Jo(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Zo(t.field),direction:$o(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.tn||li(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=Qo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Qo(e.endAt)),n}function Ho(t){var e=jo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Kr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=Yo(n.where));var u=[];n.orderBy&&(u=n.orderBy.map((function(t){return function(t){return new mu(ts(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var a=null;n.limit&&(a=function(t){var e;return li(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Xo(n.startAt));var h=null;return n.endAt&&(h=Xo(n.endAt)),Gs(e,i,u,s,a,"F",c,h)}function Yo(t){return t?void 0!==t.unaryFilter?[ns(t)]:void 0!==t.fieldFilter?[es(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Yo(t)})).reduce((function(t,e){return t.concat(e)})):Gr():[]}function Qo(t){return{before:t.before,values:t.position}}function Xo(t){var e=!!t.before,n=t.values||[];return new du(n,e)}function $o(t){return To[t]}function Jo(t){return Ao[t]}function Zo(t){return{fieldPath:t.J()}}function ts(t){return hi.nt(t.fieldPath)}function es(t){return ou.create(ts(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Gr()}}(t.fieldFilter.op),t.fieldFilter.value)}function ns(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ts(t.unaryFilter.field);return ou.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ts(t.unaryFilter.field);return ou.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=ts(t.unaryFilter.field);return ou.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=ts(t.unaryFilter.field);return ou.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Gr()}}function rs(t){var e=[];return t.fields.forEach((function(t){return e.push(t.J())})),{fieldPaths:e}}function is(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var os=function(){this.cn=void 0};function ss(t,e,n){return t instanceof cs?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof hs?fs(t,e):t instanceof ls?ps(t,e):function(t,e){var n=as(t,e),r=vs(n)+vs(t.nn);return wo(n)&&wo(t.nn)?Do(r):xo(t.serializer,r)}(t,e)}function us(t,e,n){return t instanceof hs?fs(t,e):t instanceof ls?ps(t,e):n}function as(t,e){return t instanceof ds?wo(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(os),hs=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i(e,t),e}(os);function fs(t,e){for(var n=ys(e),r=function(t){n.some((function(e){return ao(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ls=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return i(e,t),e}(os);function ps(t,e){for(var n=ys(e),r=function(t){n=n.filter((function(e){return!ao(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ds=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.nn=n,r}return i(e,t),e}(os);function vs(t){return yo(t.integerValue||t.doubleValue)}function ys(t){return bo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gs=function(){function t(t){this.fields=t,t.sort(hi.$)}return t.prototype.un=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].j(t))return!0;return!1},t.prototype.isEqual=function(t){return ri(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ms=function(t,e){this.field=t,this.transform=e},ws=function(t,e){this.version=t,this.transformResults=e},bs=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.on=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"sn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function _s(t,e){return void 0!==t.updateTime?e instanceof qs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof qs}var Is=function(){};function Es(t,e,n){return t instanceof xs?function(t,e,n){return new qs(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof Ss?function(t,e,n){if(!_s(t.rn,e))return new zs(t.key,n.version);var r=Os(t,e);return new qs(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof ks?function(t,e,n){if(Kr(null!=n.transformResults),!_s(t.rn,e))return new zs(t.key,n.version);var r=Ps(t,e),i=function(t,e,n){var r=[];Kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof qs&&(u=e.field(o.field)),r.push(us(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Cs(t,r.data(),i);return new qs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new Fs(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function Ts(t,e,n,r){return t instanceof xs?function(t,e){if(!_s(t.rn,e))return e;var n=Ds(e);return new qs(t.key,n,t.value,{an:!0})}(t,e):t instanceof Ss?function(t,e){if(!_s(t.rn,e))return e;var n=Ds(e),r=Os(t,e);return new qs(t.key,n,r,{an:!0})}(t,e):t instanceof ks?function(t,e,n,r){if(!_s(t.rn,e))return e;var i=Ps(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof qs&&(c=n.field(u.field)),null===c&&r instanceof qs&&(c=r.field(u.field)),i.push(ss(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Cs(t,i.data(),o);return new qs(t.key,i.version,s,{an:!0})}(t,e,r,n):function(t,e){return _s(t.rn,e)?new Fs(t.key,si.min()):e}(t,e)}function As(t,e){return t instanceof ks?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof qs?e.field(o.field):void 0,u=as(o.transform,s||null);null!=u&&(n=null==n?(new Ms).set(o.field,u):n.set(o.field,u))}return n?n.hn():null}(t,e):null}function Ns(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.rn.isEqual(e.rn)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.en.isEqual(e.en):2!==t.type||ri(t.fieldTransforms,t.fieldTransforms,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof hs&&e instanceof hs||t instanceof ls&&e instanceof ls?ri(t.elements,e.elements,ao):t instanceof ds&&e instanceof ds?ao(t.nn,e.nn):t instanceof cs&&e instanceof cs}(t.transform,e.transform)}(t,e)})))}function Ds(t){return t instanceof qs?t.version:si.min()}var xs=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.rn=r,i.type=0,i}return i(e,t),e}(Is),Ss=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.en=r,o.rn=i,o.type=1,o}return i(e,t),e}(Is);function Os(t,e){return function(t,e){var n=new Ms(e);return t.en.fields.forEach((function(e){if(!e.W()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}})),n.hn()}(t,e instanceof qs?e.data():Vs.empty())}var ks=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.rn=bs.exists(!0),r}return i(e,t),e}(Is);function Ps(t,e){return e}function Cs(t,e,n){for(var r=new Ms(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.hn()}var Rs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=3,r}return i(e,t),e}(Is),Ls=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.rn=n,r.type=4,r}return i(e,t),e}(Is),Vs=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.W())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Eo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.K()])||null},t.prototype.isEqual=function(t){return ao(this.proto,t.proto)},t}(),Ms=function(){function t(t){void 0===t&&(t=Vs.empty()),this.ln=t,this._n=new Map}return t.prototype.set=function(t,e){return this.fn(t,e),this},t.prototype.delete=function(t){return this.fn(t,null),this},t.prototype.fn=function(t,e){for(var n=this._n,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===uo(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.K(),e)},t.prototype.hn=function(){var t=this.dn(hi.X(),this._n);return null!=t?new Vs(t):this.ln},t.prototype.dn=function(t,e){var n=this,r=!1,i=this.ln.field(t),o=Eo(i)?Object.assign({},i.mapValue.fields):{};return e.forEach((function(e,i){if(e instanceof Map){var s=n.dn(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)})),r?{mapValue:{fields:o}}:null},t}();function Us(t){var e=[];return eo(t.fields||{},(function(t,n){var r=new hi([t]);if(Eo(n)){var i=Us(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)})),new gs(e)
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var js=function(t,e){this.key=t,this.version=e},qs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).wn=r,o.an=!!i.an,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return i(e,t),e.prototype.field=function(t){return this.wn.field(t)},e.prototype.data=function(){return this.wn},e.prototype.En=function(){return this.wn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.an===t.an&&this.hasCommittedMutations===t.hasCommittedMutations&&this.wn.isEqual(t.wn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.wn.toString()+", {hasLocalMutations: "+this.an+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.an||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(js),Fs=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return i(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(js),zs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(js),Bs=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Tn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.In=null,this.mn=null,this.startAt,this.endAt};function Gs(t,e,n,r,i,o,s,u){return new Bs(t,e,n,r,i,o,s,u)}function Ks(t){return new Bs(t)}function Ws(t){return!li(t.limit)&&"F"===t.limitType}function Hs(t){return!li(t.limit)&&"L"===t.limitType}function Ys(t){return t.Tn.length>0?t.Tn[0].field:null}function Qs(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.An())return r.field}return null}function Xs(t){return null!==t.collectionGroup}function $s(t){var e=Wr(t);if(null===e.In){e.In=[];var n=Qs(e),r=Ys(e);if(null!==n&&null===r)n.tt()||e.In.push(new mu(n)),e.In.push(new mu(hi.et(),"asc"));else{for(var i=!1,o=0,s=e.Tn;o<s.length;o++){var u=s[o];e.In.push(u),u.field.tt()&&(i=!0)}if(!i){var a=e.Tn.length>0?e.Tn[e.Tn.length-1].dir:"asc";e.In.push(new mu(hi.et(),a))}}}return e.In}function Js(t){var e=Wr(t);if(!e.mn)if("F"===e.limitType)e.mn=yi(e.path,e.collectionGroup,$s(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=$s(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new mu(o.field,s))}var u=e.endAt?new du(e.endAt.position,!e.endAt.before):null,a=e.startAt?new du(e.startAt.position,!e.startAt.before):null;e.mn=yi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.mn}function Zs(t,e,n){return new Bs(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function tu(t,e){return mi(Js(t),Js(e))&&t.limitType===e.limitType}function eu(t){return gi(Js(t))+"|lt:"+t.limitType}function nu(t){return"Query(target="+function(t){var e=t.path.J();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.J()+" "+e.op+" "+lo(e.value);var e})).join(", ")+"]"),li(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.J()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+vu(t.startAt)),t.endAt&&(e+=", endAt: "+vu(t.endAt)),"Target("+e+")"}(Js(t))+"; limitType="+t.limitType+")"}function ru(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.rt(t.collectionGroup)&&t.path.j(n):fi.ot(t.path)?t.path.isEqual(n):t.path.G(n)}(t,e)&&function(t,e){for(var n=0,r=t.Tn;n<r.length;n++){var i=r[n];if(!i.field.tt()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!yu(t.startAt,$s(t),e))&&(!t.endAt||!yu(t.endAt,$s(t),e))}(t,e)}function iu(t){return function(e,n){for(var r=!1,i=0,o=$s(t);i<o.length;i++){var s=o[i],u=wu(s,e,n);if(0!==u)return u;r=r||s.field.tt()}return 0}}var ou=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return i(e,t),e.create=function(t,n,r){return t.tt()?"in"===n||"not-in"===n?this.Rn(t,n,r):new su(t,n,r):"array-contains"===n?new hu(t,r):"in"===n?new fu(t,r):"not-in"===n?new lu(t,r):"array-contains-any"===n?new pu(t,r):new e(t,n,r)},e.Rn=function(t,e,n){return"in"===e?new uu(t,n):new au(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.Pn(ho(e,this.value)):null!==e&&uo(this.value)===uo(e)&&this.Pn(ho(e,this.value))},e.prototype.Pn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Gr()}},e.prototype.An=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),su=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=fi.it(r.referenceValue),i}return i(e,t),e.prototype.matches=function(t){var e=fi.$(t.key,this.key);return this.Pn(e)},e}(ou),uu=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=cu("in",n),r}return i(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ou),au=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=cu("not-in",n),r}return i(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(ou);function cu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return fi.it(t.referenceValue)}))}var hu=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return i(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return bo(e)&&co(e.arrayValue,this.value)},e}(ou),fu=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return i(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&co(this.value.arrayValue,e)},e}(ou),lu=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return i(e,t),e.prototype.matches=function(t){if(co(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!co(this.value.arrayValue,e)},e}(ou),pu=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return i(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!bo(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return co(e.value.arrayValue,t)}))},e}(ou),du=function(t,e){this.position=t,this.before=e};function vu(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return lo(t)})).join(",")}function yu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.tt()?fi.$(fi.it(s.referenceValue),n.key):ho(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function gu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ao(t.position[n],e.position[n]))return!1;return!0}var mu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function wu(t,e,n){var r=t.field.tt()?fi.$(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?ho(r,i):Gr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Gr()}}function bu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _u=function(){function t(t,e,n,r){this.batchId=t,this.gn=e,this.baseMutations=n,this.mutations=r}return t.prototype.yn=function(t,e,n){for(var r=n.Vn,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Es(o,e,r[i]))}return e},t.prototype.pn=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ts(i,e,e,this.gn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Ts(a,e,o,this.gn))}return e},t.prototype.vn=function(t){var e=this,n=t;return this.mutations.forEach((function(r){var i=e.pn(r.key,t.get(r.key));i&&(n=n.Tt(r.key,i))})),n},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ji())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ri(this.mutations,t.mutations,(function(t,e){return Ns(t,e)}))&&ri(this.baseMutations,t.baseMutations,(function(t,e){return Ns(t,e)}))},t}(),Iu=function(){function t(t,e,n,r){this.batch=t,this.bn=e,this.Vn=n,this.Sn=r}return t.from=function(e,n,r){Kr(e.mutations.length===r.length);for(var i=Mi,o=e.mutations,s=0;s<o.length;s++)i=i.Tt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Eu=function(){function t(t,e){this.Dn=t,this.Cn=e,this.Nn={}}return t.prototype.get=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.Cn(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.Dn(t),r=this.Nn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.Cn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.Nn[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.Dn(t),n=this.Nn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.Cn(n[r][0],t))return 1===n.length?delete this.Nn[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){eo(this.Nn,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}}))},t.prototype.W=function(){return no(this.Nn)},t}(),Tu=function(){function t(t){var e=this;this.xn=null,this.Fn=null,this.result=void 0,this.error=void 0,this.On=!1,this.Mn=!1,t((function(t){e.On=!0,e.result=t,e.xn&&e.xn(t)}),(function(t){e.On=!0,e.error=t,e.Fn&&e.Fn(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Mn&&Gr(),this.Mn=!0,this.On?this.error?this.kn(n,this.error):this.$n(e,this.result):new t((function(t,i){r.xn=function(n){r.$n(e,n).next(t,i)},r.Fn=function(e){r.kn(n,e).next(t,i)}}))},t.prototype.Ln=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.Bn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.$n=function(e,n){return e?this.Bn((function(){return e(n)})):t.resolve(n)},t.prototype.kn=function(e,n){return e?this.Bn((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.qn=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.Un=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.qn(r)},t}(),Au=function(){function t(){this.Qn=new Eu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.Kn=!1}return t.prototype.Wn=function(t){var e=this.Qn.get(t);return e?e.readTime:si.min()},t.prototype.jn=function(t,e){this.Gn(),this.Qn.set(t.key,{zn:t,readTime:e})},t.prototype.Hn=function(t,e){void 0===e&&(e=null),this.Gn(),this.Qn.set(t,{zn:null,readTime:e})},t.prototype.Jn=function(t,e){this.Gn();var n=this.Qn.get(e);return void 0!==n?Tu.resolve(n.zn):this.Yn(t,e)},t.prototype.getEntries=function(t,e){return this.Xn(t,e)},t.prototype.apply=function(t){return this.Gn(),this.Kn=!0,this.Zn(t)},t.prototype.Gn=function(){},t}(),Nu=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){return new No(t,!0)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Su="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ou=function(){function t(){this.ts=[]}return t.prototype.es=function(t){this.ts.push(t)},t.prototype.ns=function(){this.ts.forEach((function(t){return t()}))},t}(),ku=function(){function t(t,e,n){this.ss=t,this.rs=e,this.os=n}return t.prototype.cs=function(t,e){var n=this;return this.rs.us(t,e).next((function(r){return n.hs(t,e,r)}))},t.prototype.hs=function(t,e,n){return this.ss.Jn(t,e).next((function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].pn(e,t);return t}))},t.prototype.ls=function(t,e,n){var r=Ri();return e.forEach((function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].pn(t,e);r=r.Tt(t,e)})),r},t.prototype._s=function(t,e){var n=this;return this.ss.getEntries(t,e).next((function(e){return n.fs(t,e)}))},t.prototype.fs=function(t,e){var n=this;return this.rs.ds(t,e).next((function(r){var i=n.ls(t,e,r),o=Ci();return i.forEach((function(t,e){e||(e=new Fs(t,si.min())),o=o.Tt(t,e)})),o}))},t.prototype.ws=function(t,e,n){return function(t){return fi.ot(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Es(t,e.path):Xs(e)?this.Ts(t,e,n):this.Is(t,e,n)},t.prototype.Es=function(t,e){return this.cs(t,new fi(e)).next((function(t){var e=Vi();return t instanceof qs&&(e=e.Tt(t.key,t)),e}))},t.prototype.Ts=function(t,e,n){var r=this,i=e.collectionGroup,o=Vi();return this.os.As(t,i).next((function(s){return Tu.forEach(s,(function(s){var u=function(t,e){return new Bs(e,null,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return r.Is(t,u,n).next((function(t){t.forEach((function(t,e){o=o.Tt(t,e)}))}))})).next((function(){return o}))}))},t.prototype.Is=function(t,e,n){var r,i,o=this;return this.ss.ws(t,e,n).next((function(n){return r=n,o.rs.Rs(t,e)})).next((function(e){return i=e,o.Ps(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),f=Ts(a,h,h,o.gn);r=f instanceof qs?r.Tt(c,f):r.remove(c)}}))})).next((function(){return r.forEach((function(t,n){ru(e,n)||(r=r.remove(t))})),r}))},t.prototype.Ps=function(t,e,n){for(var r=ji(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ss&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ss.getEntries(t,r).next((function(t){return t.forEach((function(t,e){null!==e&&e instanceof qs&&(c=c.Tt(t,e))})),c}))},t}(),Pu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.gs=n,this.ys=r}return t.Vs=function(e,n){for(var r=ji(),i=ji(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Cu=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ps=function(t){return n.vs(t)},this.bs=function(t){return e.Ss(t)})}return t.prototype.vs=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.bs&&this.bs(t),t},t}();Cu.Ds=-1;var Ru=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Cs=t,this.Ns=e,this.xs=n,this.Fs=r,this.Os=i,this.Ms=0,this.ks=null,this.$s=Date.now(),this.reset()}return t.prototype.reset=function(){this.Ms=0},t.prototype.Ls=function(){this.Ms=this.Os},t.prototype.Bs=function(t){var e=this;this.cancel();var n=Math.floor(this.Ms+this.qs()),r=Math.max(0,Date.now()-this.$s),i=Math.max(0,n-r);i>0&&qr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ms+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ks=this.Cs.Us(this.Ns,i,(function(){return e.$s=Date.now(),t()})),this.Ms*=this.Fs,this.Ms<this.xs&&(this.Ms=this.xs),this.Ms>this.Os&&(this.Ms=this.Os)},t.prototype.Qs=function(){null!==this.ks&&(this.ks.Ks(),this.ks=null)},t.prototype.cancel=function(){null!==this.ks&&(this.ks.cancel(),this.ks=null)},t.prototype.qs=function(){return(Math.random()-.5)*this.Ms},t}(),Lu=function(){function t(e,n,r){this.name=e,this.version=n,this.Ws=r,12.2===t.js((0,h.z$)())&&Fr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return qr("SimpleDb","Removing database:",t),Fu(window.indexedDB.deleteDatabase(t)).Ln()},t.Gs=function(){if("undefined"==typeof indexedDB)return!1;if(t.zs())return!0;var e=(0,h.z$)(),n=t.js(e),r=0<n&&n<10,i=t.Hs(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.zs=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t={NODE_ENV:"production",BASE_URL:"/"})||void 0===t?void 0:t.Js)},t.Ys=function(t,e){return t.store(e)},t.js=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Hs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Xs=function(t){return o(this,void 0,void 0,(function(){var e,n=this;return s(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(qr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new Mu(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Yr(Hr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Mu(t,n))},i.onupgradeneeded=function(t){qr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Ws.createOrUpgrade(e,i.transaction,t.oldVersion,n.version).next((function(){qr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Zs&&(this.db.onversionchange=function(t){return n.Zs(t)}),this.db)]}}))}))},t.prototype.ti=function(t){this.Zs=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return o(this,void 0,void 0,(function(){var i,o,u,a,c;return s(this,(function(h){switch(h.label){case 0:i="readonly"===e,o=0,u=function(){var e,u,c,h,f;return s(this,(function(s){switch(s.label){case 0:++o,s.label=1;case 1:return s.trys.push([1,4,,5]),[4,a.Xs(t)];case 2:return a.db=s.sent(),e=ju.open(a.db,t,i?"readonly":"readwrite",n),u=r(e).catch((function(t){return e.abort(t),Tu.reject(t)})).Ln(),c={},u.catch((function(){})),[4,e.ei];case 3:return[2,(c.value=(s.sent(),u),c)];case 4:return h=s.sent(),f="FirebaseError"!==h.name&&o<3,qr("SimpleDb","Transaction failed with error:",h.message,"Retrying:",f),a.close(),f?[3,5]:[2,{value:Promise.reject(h)}];case 5:return[2]}}))},a=this,h.label=1;case 1:return[5,u()];case 2:if("object"==typeof(c=h.sent()))return[2,c.value];h.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Vu=function(){function t(t){this.ni=t,this.si=!1,this.ii=null}return Object.defineProperty(t.prototype,"On",{get:function(){return this.si},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ri",{get:function(){return this.ii},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.ni=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.si=!0},t.prototype.oi=function(t){this.ii=t},t.prototype.delete=function(){return Fu(this.ni.delete())},t}(),Mu=function(t){function e(e,n){var r=this;return(r=t.call(this,Hr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return i(e,t),e}(Yr);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(t){return"IndexedDbTransactionError"===t.name}var ju=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ci=new Nu,this.transaction.oncomplete=function(){n.ci.resolve()},this.transaction.onabort=function(){e.error?n.ci.reject(new Mu(t,e.error)):n.ci.resolve()},this.transaction.onerror=function(e){var r=Bu(e.target.error);n.ci.reject(new Mu(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new Mu(n,e)}},Object.defineProperty(t.prototype,"ei",{get:function(){return this.ci.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ci.reject(t),this.aborted||(qr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new qu(e)},t}(),qu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(qr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(qr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Fu(n)},t.prototype.add=function(t){return qr("SimpleDb","ADD",this.store.name,t,t),Fu(this.store.add(t))},t.prototype.get=function(t){var e=this;return Fu(this.store.get(t)).next((function(n){return void 0===n&&(n=null),qr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return qr("SimpleDb","DELETE",this.store.name,t),Fu(this.store.delete(t))},t.prototype.count=function(){return qr("SimpleDb","COUNT",this.store.name),Fu(this.store.count())},t.prototype.ui=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ai(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.hi=function(t,e){qr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.li=!1;var r=this.cursor(n);return this.ai(r,(function(t,e,n){return n.delete()}))},t.prototype._i=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ai(r,e)},t.prototype.fi=function(t){var e=this.cursor({});return new Tu((function(n,r){e.onerror=function(t){var e=Bu(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.ai=function(t,e){var n=[];return new Tu((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Vu(i),s=e(i.primaryKey,i.value,o);if(s instanceof Tu){var u=s.catch((function(t){return o.done(),Tu.reject(t)}));n.push(u)}o.On?r():null===o.ri?i.continue():i.continue(o.ri)}else r()}})).next((function(){return Tu.qn(n)}))},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.li?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Fu(t){return new Tu((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Bu(t.target.error);n(e)}}))}var zu=!1;function Bu(t){var e=Lu.js((0,h.z$)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Yr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return zu||(zu=!0,setTimeout((function(){throw r}),0)),r}}return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gu(){return"undefined"!=typeof window?window:null}function Ku(){return"undefined"!=typeof document?document:null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wu=function(){function t(t,e,n,r,i){this.di=t,this.Ns=e,this.wi=n,this.op=r,this.Ei=i,this.Ti=new Nu,this.then=this.Ti.promise.then.bind(this.Ti.promise),this.Ti.promise.catch((function(t){}))}return t.Ii=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.mi=setTimeout((function(){return e.Ai()}),t)},t.prototype.Ks=function(){return this.Ai()},t.prototype.cancel=function(t){null!==this.mi&&(this.clearTimeout(),this.Ti.reject(new Yr(Hr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.Ai=function(){var t=this;this.di.Ri((function(){return null!==t.mi?(t.clearTimeout(),t.op().then((function(e){return t.Ti.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.mi&&(this.Ei(this),clearTimeout(this.mi),this.mi=null)},t}(),Hu=function(){function t(){var t=this;this.Pi=Promise.resolve(),this.gi=[],this.yi=!1,this.Vi=[],this.pi=null,this.vi=!1,this.bi=[],this.Si=new Ru(this,"async_queue_retry"),this.Di=function(){var e=Ku();e&&qr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Si.Qs()};var e=Ku();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Di)}return Object.defineProperty(t.prototype,"Ci",{get:function(){return this.yi},enumerable:!1,configurable:!0}),t.prototype.Ri=function(t){this.enqueue(t)},t.prototype.Ni=function(t){this.xi(),this.Fi(t)},t.prototype.Oi=function(){if(!this.yi){this.yi=!0;var t=Ku();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Di)}},t.prototype.enqueue=function(t){return this.xi(),this.yi?new Promise((function(t){})):this.Fi(t)},t.prototype.Mi=function(t){var e=this;this.Ri((function(){return e.gi.push(t),e.ki()}))},t.prototype.ki=function(){return o(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(n){switch(n.label){case 0:if(0===this.gi.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.gi[0]()];case 2:return n.sent(),this.gi.shift(),this.Si.reset(),[3,4];case 3:if(!Uu(t=n.sent()))throw t;return qr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.gi.length>0&&this.Si.Bs((function(){return e.ki()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Fi=function(t){var e=this,n=this.Pi.then((function(){return e.vi=!0,t().catch((function(t){throw e.pi=t,e.vi=!1,Fr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.vi=!1,t}))}));return this.Pi=n,n},t.prototype.Us=function(t,e,n){var r=this;this.xi(),this.bi.indexOf(t)>-1&&(e=0);var i=Wu.Ii(this,t,e,n,(function(t){return r.$i(t)}));return this.Vi.push(i),i},t.prototype.xi=function(){this.pi&&Gr()},t.prototype.Li=function(){},t.prototype.Bi=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,t=this.Pi];case 1:e.sent(),e.label=2;case 2:if(t!==this.Pi)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.qi=function(t){for(var e=0,n=this.Vi;e<n.length;e++)if(n[e].Ns===t)return!0;return!1},t.prototype.Ui=function(t){var e=this;return this.Bi().then((function(){e.Vi.sort((function(t,e){return t.wi-e.wi}));for(var n=0,r=e.Vi;n<r.length;n++){var i=r[n];if(i.Ks(),"all"!==t&&i.Ns===t)break}return e.Bi()}))},t.prototype.Qi=function(t){this.bi.push(t)},t.prototype.$i=function(t){var e=this.Vi.indexOf(t);this.Vi.splice(e,1)},t}();function Yu(t,e){if(Fr("AsyncQueue",e+": "+t),Uu(t))return new Yr(Hr.UNAVAILABLE,e+": "+t);throw t}function Qu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ni(n,i);return 0===s?ni(r,o):s}var Xu=function(){function t(t){this.Ki=t,this.buffer=new Oi(Qu),this.Wi=0}return t.prototype.ji=function(){return++this.Wi},t.prototype.Gi=function(t){var e=[t,this.ji()];if(this.buffer.size<this.Ki)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();Qu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),$u={zi:!1,Hi:0,Ji:0,Yi:0},Ju=function(){function t(t,e,n){this.Xi=t,this.Zi=e,this.tr=n}return t.er=function(e){return new t(e,t.nr,t.sr)},t}();Ju.nr=10,Ju.sr=1e3,Ju.ir=new Ju(41943040,Ju.nr,Ju.sr),Ju.rr=new Ju(-1,0,0);var Zu=function(){function t(t,e){this.cr=t,this.di=e,this.ur=!1,this.ar=null}return t.prototype.start=function(t){-1!==this.cr.params.Xi&&this.hr(t)},t.prototype.stop=function(){this.ar&&(this.ar.cancel(),this.ar=null)},Object.defineProperty(t.prototype,"lr",{get:function(){return null!==this.ar},enumerable:!1,configurable:!0}),t.prototype.hr=function(t){var e=this,n=this.ur?3e5:6e4;qr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ar=this.di.Us("lru_garbage_collection",n,(function(){return o(e,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:this.ar=null,this.ur=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t._r(this.cr)];case 2:return n.sent(),[3,7];case 3:return Uu(e=n.sent())?(qr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Nc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.hr(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),ta=function(){function t(t,e){this.dr=t,this.params=e}return t.prototype.wr=function(t,e){return this.dr.Er(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.Tr=function(t,e){var n=this;if(0===e)return Tu.resolve(Cu.Ds);var r=new Xu(e);return this.dr.Ue(t,(function(t){return r.Gi(t.sequenceNumber)})).next((function(){return n.dr.Ir(t,(function(t){return r.Gi(t)}))})).next((function(){return r.maxValue}))},t.prototype.mr=function(t,e,n){return this.dr.mr(t,e,n)},t.prototype.Ar=function(t,e){return this.dr.Ar(t,e)},t.prototype.Rr=function(t,e){var n=this;return-1===this.params.Xi?(qr("LruGarbageCollector","Garbage collection skipped; disabled"),Tu.resolve($u)):this.Pr(t).next((function(r){return r<n.params.Xi?(qr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.Xi),$u):n.gr(t,e)}))},t.prototype.Pr=function(t){return this.dr.Pr(t)},t.prototype.gr=function(t,e){var n,r,i,o,s,u,a,h=this,f=Date.now();return this.wr(t,this.params.Zi).next((function(e){return e>h.params.tr?(qr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.tr+" from "+e),r=h.params.tr):r=e,o=Date.now(),h.Tr(t,r)})).next((function(r){return n=r,s=Date.now(),h.mr(t,n,e)})).next((function(e){return i=e,u=Date.now(),h.Ar(t,n)})).next((function(t){return a=Date.now(),jr()<=c["in"].DEBUG&&qr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-f)+"ms\n\tDetermined least recently used "+r+" in "+(s-o)+"ms\n\tRemoved "+i+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(a-u)+"ms\nTotal Duration: "+(a-f)+"ms"),Tu.resolve({zi:!0,Hi:r,Ji:i,Yi:t})}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ra(e)),e=na(t.get(n),e);return ra(e)}function na(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ra(t){return t+""}function ia(t){var e=t.length;if(Kr(e>=2),2===e)return Kr(""===t.charAt(0)&&""===t.charAt(1)),ai.X();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Gr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Gr()}o=s+2}return new ai(r)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oa=function(t){this.yr=t};function sa(t,e){if(e.document)return function(t,e,n){var r=Mo(t,e.name),i=Co(e.updateTime),o=new Vs({mapValue:{fields:e.fields}});return new qs(r,i,o,{hasCommittedMutations:!!n})}(t.yr,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=fi.ct(e.noDocument.path),r=fa(e.noDocument.readTime);return new Fs(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=fi.ct(e.unknownDocument.path),o=fa(e.unknownDocument.version);return new zs(i,o)}return Gr()}function ua(t,e,n){var r=aa(n),i=e.key.path.q().H();if(e instanceof qs){var o=function(t,e){return{name:Vo(t,e.key),fields:e.En().mapValue.fields,updateTime:Oo(t,e.version.M())}}(t.yr,e),s=e.hasCommittedMutations;return new Ua(null,null,o,s,r,i)}if(e instanceof Fs){var u=e.key.path.H(),a=ha(e.version),c=e.hasCommittedMutations;return new Ua(null,new Va(u,a),null,c,r,i)}if(e instanceof zs){var h=e.key.path.H(),f=ha(e.version);return new Ua(new Ma(h,f),null,null,!0,r,i)}return Gr()}function aa(t){var e=t.M();return[e.seconds,e.nanoseconds]}function ca(t){var e=new oi(t[0],t[1]);return si.N(e)}function ha(t){var e=t.M();return new ka(e.seconds,e.nanoseconds)}function fa(t){var e=new oi(t.seconds,t.nanoseconds);return si.N(e)}function la(t,e){var n=(e.baseMutations||[]).map((function(e){return Go(t.yr,e)})),r=e.mutations.map((function(e){return Go(t.yr,e)})),i=oi.fromMillis(e.localWriteTimeMs);return new _u(e.batchId,i,n,r)}function pa(t){var e,n,r=fa(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?fa(t.lastLimboFreeSnapshotVersion):si.min();return void 0!==t.query.documents?(Kr(1===(n=t.query).documents.length),e=Js(Ks(jo(n.documents[0])))):e=function(t){return Js(Ho(t))}(t.query),new Ei(e,t.targetId,0,t.lastListenSequenceNumber,r,i,bi.fromBase64String(t.resumeToken))}function da(t,e){var n,r=ha(e.ft),i=ha(e.lastLimboFreeSnapshotVersion);n=wi(e.target)?Ko(t.yr,e.target):Wo(t.yr,e.target);var o=e.resumeToken.toBase64();return new qa(e.targetId,gi(e.target),r,o,e.sequenceNumber,i,n)}function va(t){var e=Ho({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Zs(e,e.limit,"L"):e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ya=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.os=n,this.Vr=r,this.pr={}}return t.vr=function(e,n,r,i){return Kr(""!==e.uid),new t(e.u()?e.uid:"",n,r,i)},t.prototype.br=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wa(t)._i({index:Ra.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.Sr=function(t,e,n,r){var i=this,o=ba(t),s=wa(t);return s.add({}).next((function(u){Kr("number"==typeof u);for(var a=new _u(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Bo(t.yr,e)})),i=n.mutations.map((function(e){return Bo(t.yr,e)}));return new Ra(e,n.batchId,n.gn.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],f=new Oi((function(t,e){return ni(t.J(),e.J())})),l=0,p=r;l<p.length;l++){var d=p[l],v=La.key(i.userId,d.key.path,u);f=f.add(d.key.path.q()),h.push(s.put(c)),h.push(o.put(v,La.PLACEHOLDER))}return f.forEach((function(e){h.push(i.os.Dr(t,e))})),t.es((function(){i.pr[u]=a.keys()})),Tu.qn(h).next((function(){return a}))}))},t.prototype.Cr=function(t,e){var n=this;return wa(t).get(e).next((function(t){return t?(Kr(t.userId===n.userId),la(n.serializer,t)):null}))},t.prototype.Nr=function(t,e){var n=this;return this.pr[e]?Tu.resolve(this.pr[e]):this.Cr(t,e).next((function(t){if(t){var r=t.keys();return n.pr[e]=r,r}return null}))},t.prototype.Fr=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return wa(t)._i({index:Ra.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Kr(e.batchId>=r),o=la(n.serializer,e)),i.done()})).next((function(){return o}))},t.prototype.Or=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return wa(t)._i({index:Ra.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.Mr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wa(t).ui(Ra.userMutationsIndex,n).next((function(t){return t.map((function(t){return la(e.serializer,t)}))}))},t.prototype.us=function(t,e){var n=this,r=La.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return ba(t)._i({range:i},(function(r,i,s){var u=r[0],a=r[1],c=r[2],h=ia(a);if(u===n.userId&&e.path.isEqual(h))return wa(t).get(c).next((function(t){if(!t)throw Gr();Kr(t.userId===n.userId),o.push(la(n.serializer,t))}));s.done()})).next((function(){return o}))},t.prototype.ds=function(t,e){var n=this,r=new Oi(ni),i=[];return e.forEach((function(e){var o=La.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=ba(t)._i({range:s},(function(t,i,o){var s=t[0],u=t[1],a=t[2],c=ia(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()}));i.push(u)})),Tu.qn(i).next((function(){return n.kr(t,r)}))},t.prototype.Rs=function(t,e){var n=this,r=e.path,i=r.length+1,o=La.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Oi(ni);return ba(t)._i({range:s},(function(t,e,o){var s=t[0],a=t[1],c=t[2],h=ia(a);s===n.userId&&r.j(h)?h.length===i&&(u=u.add(c)):o.done()})).next((function(){return n.kr(t,u)}))},t.prototype.kr=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(wa(t).get(e).next((function(t){if(null===t)throw Gr();Kr(t.userId===n.userId),r.push(la(n.serializer,t))})))})),Tu.qn(i).next((function(){return r}))},t.prototype.$r=function(t,e){var n=this;return ma(t.Lr,this.userId,e).next((function(r){return t.es((function(){n.Br(e.batchId)})),Tu.forEach(r,(function(e){return n.Vr.qr(t,e)}))}))},t.prototype.Br=function(t){delete this.pr[t]},t.prototype.Ur=function(t){var e=this;return this.br(t).next((function(n){if(!n)return Tu.resolve();var r=IDBKeyRange.lowerBound(La.prefixForUser(e.userId)),i=[];return ba(t)._i({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ia(t[1]);i.push(o)}else r.done()})).next((function(){Kr(0===i.length)}))}))},t.prototype.Qr=function(t,e){return ga(t,this.userId,e)},t.prototype.Kr=function(t){var e=this;return _a(t).get(this.userId).next((function(t){return t||new Ca(e.userId,-1,"")}))},t}();function ga(t,e,n){var r=La.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return ba(t)._i({range:o,li:!0},(function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()})).next((function(){return s}))}function ma(t,e,n){var r=t.store(Ra.store),i=t.store(La.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r._i({range:s},(function(t,e,n){return u++,n.delete()}));o.push(a.next((function(){Kr(1===u)})));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=La.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Tu.qn(o).next((function(){return c}))}function wa(t){return uc.Ys(t,Ra.store)}function ba(t){return uc.Ys(t,La.store)}function _a(t){return uc.Ys(t,Ca.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ia=function(){function t(t,e){this.serializer=t,this.os=e}return t.prototype.jn=function(t,e,n){return Aa(t).put(Na(e),n)},t.prototype.Hn=function(t,e){var n=Aa(t),r=Na(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.Wr(t,r)}))},t.prototype.Jn=function(t,e){var n=this;return Aa(t).get(Na(e)).next((function(t){return n.jr(t)}))},t.prototype.Gr=function(t,e){var n=this;return Aa(t).get(Na(e)).next((function(t){var e=n.jr(t);return e?{zn:e,size:Da(t)}:null}))},t.prototype.getEntries=function(t,e){var n=this,r=Ri();return this.zr(t,e,(function(t,e){var i=n.jr(e);r=r.Tt(t,i)})).next((function(){return r}))},t.prototype.Hr=function(t,e){var n=this,r=Ri(),i=new Di(fi.$);return this.zr(t,e,(function(t,e){var o=n.jr(e);o?(r=r.Tt(t,o),i=i.Tt(t,Da(e))):(r=r.Tt(t,null),i=i.Tt(t,0))})).next((function(){return{Jr:r,Yr:i}}))},t.prototype.zr=function(t,e,n){if(e.W())return Tu.resolve();var r=IDBKeyRange.bound(e.first().path.H(),e.last().path.H()),i=e.yt(),o=i.Ct();return Aa(t)._i({range:r},(function(t,e,r){for(var s=fi.ct(t);o&&fi.$(o,s)<0;)n(o,null),o=i.Ct();o&&o.isEqual(s)&&(n(o,e),o=i.Nt()?i.Ct():null),o?r.oi(o.path.H()):r.done()})).next((function(){for(;o;)n(o,null),o=i.Nt()?i.Ct():null}))},t.prototype.ws=function(t,e,n){var r=this,i=Vi(),o=e.path.length+1,s={};if(n.isEqual(si.min())){var u=e.path.H();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.H(),c=aa(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Ua.collectionReadTimeIndex}return Aa(t)._i(s,(function(t,n,s){if(t.length===o){var u=sa(r.serializer,n);e.path.j(u.key.path)?u instanceof qs&&ru(e,u)&&(i=i.Tt(u.key,u)):s.done()}})).next((function(){return i}))},t.prototype.Xr=function(t){return new Ea(this,!!t&&t.Zr)},t.prototype.eo=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return Ta(t).get(ja.key).next((function(t){return Kr(!!t),t}))},t.prototype.Wr=function(t,e){return Ta(t).put(ja.key,e)},t.prototype.jr=function(t){if(t){var e=sa(this.serializer,t);return e instanceof Fs&&e.version.isEqual(si.min())?null:e}return null},t}(),Ea=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).no=e,r.Zr=n,r.so=new Eu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return i(e,t),e.prototype.Zn=function(t){var e=this,n=[],r=0,i=new Oi((function(t,e){return ni(t.J(),e.J())}));return this.Qn.forEach((function(o,s){var u=e.so.get(o);if(s.zn){var a=ua(e.no.serializer,s.zn,e.Wn(o));i=i.add(o.path.q());var c=Da(a);r+=c-u,n.push(e.no.jn(t,o,a))}else if(r-=u,e.Zr){var h=ua(e.no.serializer,new Fs(o,si.min()),e.Wn(o));n.push(e.no.jn(t,o,h))}else n.push(e.no.Hn(t,o))})),i.forEach((function(r){n.push(e.no.os.Dr(t,r))})),n.push(this.no.updateMetadata(t,r)),Tu.qn(n)},e.prototype.Yn=function(t,e){var n=this;return this.no.Gr(t,e).next((function(t){return null===t?(n.so.set(e,0),null):(n.so.set(e,t.size),t.zn)}))},e.prototype.Xn=function(t,e){var n=this;return this.no.Hr(t,e).next((function(t){var e=t.Jr;return t.Yr.forEach((function(t,e){n.so.set(t,e)})),e}))},e}(Au);function Ta(t){return uc.Ys(t,ja.store)}function Aa(t){return uc.Ys(t,Ua.store)}function Na(t){return t.path.H()}function Da(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Gr();e=t.noDocument}return JSON.stringify(e).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xa=function(){function t(){this.io=new Sa}return t.prototype.Dr=function(t,e){return this.io.add(e),Tu.resolve()},t.prototype.As=function(t,e){return Tu.resolve(this.io.getEntries(e))},t}(),Sa=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.K(),n=t.q(),r=this.index[e]||new Oi(ai.$),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.K(),n=t.q(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Oi(ai.$)).H()},t}(),Oa=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Kr(n<r&&n>=0&&r<=11);var o=new ju("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Pa.store)}(t),function(t){t.createObjectStore(Ca.store,{keyPath:Ca.keyPath}),t.createObjectStore(Ra.store,{keyPath:Ra.keyPath,autoIncrement:!0}).createIndex(Ra.userMutationsIndex,Ra.userMutationsKeyPath,{unique:!0}),t.createObjectStore(La.store)}(t),Ga(t),function(t){t.createObjectStore(Ua.store)}(t));var s=Tu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Fa.store),t.deleteObjectStore(qa.store),t.deleteObjectStore(za.store)}(t),Ga(t)),s=s.next((function(){return function(t){var e=t.store(za.store),n=new za(0,0,si.min().M(),0);return e.put(za.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(s=s.next((function(){return function(t,e){return e.store(Ra.store).ui().next((function(n){t.deleteObjectStore(Ra.store),t.createObjectStore(Ra.store,{keyPath:Ra.keyPath,autoIncrement:!0}).createIndex(Ra.userMutationsIndex,Ra.userMutationsKeyPath,{unique:!0});var r=e.store(Ra.store),i=n.map((function(t){return r.put(t)}));return Tu.qn(i)}))}(t,o)}))),s=s.next((function(){!function(t){t.createObjectStore(Ka.store,{keyPath:Ka.keyPath})}(t)}))),n<5&&r>=5&&(s=s.next((function(){return i.removeAcknowledgedMutations(o)}))),n<6&&r>=6&&(s=s.next((function(){return function(t){t.createObjectStore(ja.store)}(t),i.addDocumentGlobal(o)}))),n<7&&r>=7&&(s=s.next((function(){return i.ensureSequenceNumbers(o)}))),n<8&&r>=8&&(s=s.next((function(){return i.createCollectionParentIndex(t,o)}))),n<9&&r>=9&&(s=s.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ua.store);e.createIndex(Ua.readTimeIndex,Ua.readTimeIndexPath,{unique:!1}),e.createIndex(Ua.collectionReadTimeIndex,Ua.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(s=s.next((function(){return i.rewriteCanonicalIds(o)}))),n<11&&r>=11&&(s=s.next((function(){!function(t){t.createObjectStore(Wa.store,{keyPath:Wa.keyPath})}(t),function(t){t.createObjectStore(Ha.store,{keyPath:Ha.keyPath})}(t)}))),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ua.store)._i((function(t,n){e+=Da(n)})).next((function(){var n=new ja(e);return t.store(ja.store).put(ja.key,n)}))},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Ca.store),r=t.store(Ra.store);return n.ui().next((function(n){return Tu.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.ui(Ra.userMutationsIndex,i).next((function(r){return Tu.forEach(r,(function(r){Kr(r.userId===n.userId);var i=la(e.serializer,r);return ma(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Fa.store),n=t.store(Ua.store);return t.store(za.store).get(za.key).next((function(t){var r=[];return n._i((function(n,i){var o=new ai(n),s=function(t){return[0,ea(t)]}(o);r.push(e.get(s).next((function(n){return n?Tu.resolve():function(n){return e.put(new Fa(0,ea(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Tu.qn(r)}))}))},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Ba.store,{keyPath:Ba.keyPath});var n=e.store(Ba.store),r=new Sa,i=function(t){if(r.add(t)){var e=t.K(),i=t.q();return n.put({collectionId:e,parent:ea(i)})}};return e.store(Ua.store)._i({li:!0},(function(t,e){var n=new ai(t);return i(n.q())})).next((function(){return e.store(La.store)._i({li:!0},(function(t,e){t[0];var n=t[1],r=(t[2],ia(n));return i(r.q())}))}))},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(qa.store);return n._i((function(t,r){var i=pa(r),o=da(e.serializer,i);return n.put(o)}))},t}(),ka=function(t,e){this.seconds=t,this.nanoseconds=e},Pa=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Pa.store="owner",Pa.key="owner";var Ca=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ca.store="mutationQueues",Ca.keyPath="userId";var Ra=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ra.store="mutations",Ra.keyPath="batchId",Ra.userMutationsIndex="userMutationsIndex",Ra.userMutationsKeyPath=["userId","batchId"];var La=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ea(e)]},t.key=function(t,e,n){return[t,ea(e),n]},t}();La.store="documentMutations",La.PLACEHOLDER=new La;var Va=function(t,e){this.path=t,this.readTime=e},Ma=function(t,e){this.path=t,this.version=e},Ua=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ua.store="remoteDocuments",Ua.readTimeIndex="readTimeIndex",Ua.readTimeIndexPath="readTime",Ua.collectionReadTimeIndex="collectionReadTimeIndex",Ua.collectionReadTimeIndexPath=["parentPath","readTime"];var ja=function(t){this.byteSize=t};ja.store="remoteDocumentGlobal",ja.key="remoteDocumentGlobalKey";var qa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};qa.store="targets",qa.keyPath="targetId",qa.queryTargetsIndexName="queryTargetsIndex",qa.queryTargetsKeyPath=["canonicalId","targetId"];var Fa=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Fa.store="targetDocuments",Fa.keyPath=["targetId","path"],Fa.documentTargetsIndex="documentTargetsIndex",Fa.documentTargetsKeyPath=["path","targetId"];var za=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};za.key="targetGlobalKey",za.store="targetGlobal";var Ba=function(t,e){this.collectionId=t,this.parent=e};function Ga(t){t.createObjectStore(Fa.store,{keyPath:Fa.keyPath}).createIndex(Fa.documentTargetsIndex,Fa.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(qa.store,{keyPath:qa.keyPath}).createIndex(qa.queryTargetsIndexName,qa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(za.store)}Ba.store="collectionParents",Ba.keyPath=["collectionId","parent"];var Ka=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ka.store="clientMetadata",Ka.keyPath="clientId";var Wa=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};Wa.store="bundles",Wa.keyPath="bundleId";var Ha=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};Ha.store="namedQueries",Ha.keyPath="name";var Ya=u(u(u(u([Ca.store,Ra.store,La.store,Ua.store,qa.store,Pa.store,za.store,Fa.store],[Ka.store]),[ja.store]),[Ba.store]),[Wa.store,Ha.store]),Qa=function(){function t(t){this.serializer=t}return t.prototype.ro=function(t,e){return Xa(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:fa(e.createTime),version:e.version};var e}))},t.prototype.oo=function(t,e){return Xa(t).put({bundleId:(n=e).id,createTime:ha(Co(n.createTime)),version:n.version});var n},t.prototype.co=function(t,e){return $a(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:va(e.bundledQuery),readTime:fa(e.readTime)};var e}))},t.prototype.uo=function(t,e){return $a(t).put(function(t){return{name:t.name,readTime:ha(Co(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(t){return uc.Ys(t,Wa.store)}function $a(t){return uc.Ys(t,Ha.store)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ja=function(){function t(){this.ao=new Sa}return t.prototype.Dr=function(t,e){var n=this;if(!this.ao.has(e)){var r=e.K(),i=e.q();t.es((function(){n.ao.add(e)}));var o={collectionId:r,parent:ea(i)};return Za(t).put(o)}return Tu.resolve()},t.prototype.As=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ii(e),""],!1,!0);return Za(t).ui(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ia(o.parent))}return n}))},t}();function Za(t){return uc.Ys(t,Ba.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tc=function(){function t(t){this.ho=t}return t.prototype.next=function(){return this.ho+=2,this.ho},t.lo=function(){return new t(0)},t._o=function(){return new t(-1)},t}(),ec=function(){function t(t,e){this.Vr=t,this.serializer=e}return t.prototype.fo=function(t){var e=this;return this.wo(t).next((function(n){var r=new tc(n.highestTargetId);return n.highestTargetId=r.next(),e.Eo(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.To=function(t){return this.wo(t).next((function(t){return si.N(new oi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.Io=function(t){return this.wo(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.mo=function(t,e,n){var r=this;return this.wo(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.M()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Eo(t,i)}))},t.prototype.Ao=function(t,e){var n=this;return this.Ro(t,e).next((function(){return n.wo(t).next((function(r){return r.targetCount+=1,n.Po(e,r),n.Eo(t,r)}))}))},t.prototype.yo=function(t,e){return this.Ro(t,e)},t.prototype.Vo=function(t,e){var n=this;return this.po(t,e.targetId).next((function(){return nc(t).delete(e.targetId)})).next((function(){return n.wo(t)})).next((function(e){return Kr(e.targetCount>0),e.targetCount-=1,n.Eo(t,e)}))},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return nc(t)._i((function(s,u){var a=pa(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.Vo(t,a)))})).next((function(){return Tu.qn(o)})).next((function(){return i}))},t.prototype.Ue=function(t,e){return nc(t)._i((function(t,n){var r=pa(n);e(r)}))},t.prototype.wo=function(t){return rc(t).get(za.key).next((function(t){return Kr(null!==t),t}))},t.prototype.Eo=function(t,e){return rc(t).put(za.key,e)},t.prototype.Ro=function(t,e){return nc(t).put(da(this.serializer,e))},t.prototype.Po=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.vo=function(t){return this.wo(t).next((function(t){return t.targetCount}))},t.prototype.bo=function(t,e){var n=gi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return nc(t)._i({range:r,index:qa.queryTargetsIndexName},(function(t,n,r){var o=pa(n);mi(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.So=function(t,e,n){var r=this,i=[],o=ic(t);return e.forEach((function(e){var s=ea(e.path);i.push(o.put(new Fa(n,s))),i.push(r.Vr.Do(t,n,e))})),Tu.qn(i)},t.prototype.Co=function(t,e,n){var r=this,i=ic(t);return Tu.forEach(e,(function(e){var o=ea(e.path);return Tu.qn([i.delete([n,o]),r.Vr.No(t,n,e)])}))},t.prototype.po=function(t,e){var n=ic(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.xo=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ic(t),i=ji();return r._i({range:n,li:!0},(function(t,e,n){var r=ia(t[1]),o=new fi(r);i=i.add(o)})).next((function(){return i}))},t.prototype.Qr=function(t,e){var n=ea(e.path),r=IDBKeyRange.bound([n],[ii(n)],!1,!0),i=0;return ic(t)._i({index:Fa.documentTargetsIndex,li:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.Ze=function(t,e){return nc(t).get(e).next((function(t){return t?pa(t):null}))},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(t){return uc.Ys(t,qa.store)}function rc(t){return uc.Ys(t,za.store)}function ic(t){return uc.Ys(t,Fa.store)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",sc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Lr=e,r.Fo=n,r}return i(e,t),e}(Ou),uc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Cs=o,this.window=s,this.document=u,this.Oo=c,this.Mo=h,this.ko=null,this.$o=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Lo=null,this.inForeground=!1,this.Bo=null,this.qo=null,this.Uo=Number.NEGATIVE_INFINITY,this.Qo=function(t){return Promise.resolve()},!t.Gs())throw new Yr(Hr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Vr=new hc(this,i),this.Ko=n+"main",this.serializer=new oa(a),this.Wo=new Lu(this.Ko,11,new Oa(this.serializer)),this.jo=new ec(this.Vr,this.serializer),this.os=new Ja,this.ss=function(t,e){return new Ia(t,e)}(this.serializer,this.os),this.Go=new Qa(this.serializer),this.window&&this.window.localStorage?this.zo=this.window.localStorage:(this.zo=null,!1===h&&Fr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Ys=function(t,e){if(t instanceof sc)return Lu.Ys(t.Lr,e);throw Gr()},t.prototype.start=function(){var t=this;return this.Ho().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Yr(Hr.FAILED_PRECONDITION,oc);return t.Jo(),t.Yo(),t.Xo(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.jo.Io(e)}))})).then((function(e){t.ko=new Cu(e,t.Oo)})).then((function(){t.$o=!0})).catch((function(e){return t.Wo&&t.Wo.close(),Promise.reject(e)}))},t.prototype.Zo=function(t){var e=this;return this.Qo=function(n){return o(e,void 0,void 0,(function(){return s(this,(function(e){return this.lr?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.tc=function(t){var e=this;this.Wo.ti((function(n){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.ec=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Cs.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.lr?[4,this.Ho()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.Ho=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return cc(e).put(new Ka(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.nc(e).next((function(e){e||(t.isPrimary=!1,t.Cs.Mi((function(){return t.Qo(!1)})))}))})).next((function(){return t.sc(e)})).next((function(n){return t.isPrimary&&!n?t.ic(e).next((function(){return!1})):!!n&&t.rc(e).next((function(){return!0}))}))})).catch((function(e){if(Uu(e))return qr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return qr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Cs.Mi((function(){return t.Qo(e)})),t.isPrimary=e}))},t.prototype.nc=function(t){var e=this;return ac(t).get(Pa.key).next((function(t){return Tu.resolve(e.oc(t))}))},t.prototype.cc=function(t){return cc(t).delete(this.clientId)},t.prototype.uc=function(){return o(this,void 0,void 0,(function(){var e,n,r,i,o=this;return s(this,(function(s){switch(s.label){case 0:return!this.isPrimary||this.ac(this.Uo,18e5)?[3,2]:(this.Uo=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var n=t.Ys(e,Ka.store);return n.ui().next((function(t){var e=o.hc(t,18e5),r=t.filter((function(t){return-1===e.indexOf(t)}));return Tu.forEach(r,(function(t){return n.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=s.sent(),this.zo)for(n=0,r=e;n<r.length;n++)i=r[n],this.zo.removeItem(this.lc(i.clientId));s.label=2;case 2:return[2]}}))}))},t.prototype.Xo=function(){var t=this;this.qo=this.Cs.Us("client_metadata_refresh",4e3,(function(){return t.Ho().then((function(){return t.uc()})).then((function(){return t.Xo()}))}))},t.prototype.oc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.sc=function(t){var e=this;return this.Mo?Tu.resolve(!0):ac(t).get(Pa.key).next((function(n){if(null!==n&&e.ac(n.leaseTimestampMs,5e3)&&!e._c(n.ownerId)){if(e.oc(n)&&e.networkEnabled)return!0;if(!e.oc(n)){if(!n.allowTabSynchronization)throw new Yr(Hr.FAILED_PRECONDITION,oc);return!1}}return!(!e.networkEnabled||!e.inForeground)||cc(t).ui().next((function(t){return void 0===e.hc(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&qr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.fc=function(){return o(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){switch(e.label){case 0:return this.$o=!1,this.dc(),this.qo&&(this.qo.cancel(),this.qo=null),this.wc(),this.Ec(),[4,this.Wo.runTransaction("shutdown","readwrite",[Pa.store,Ka.store],(function(e){var n=new sc(e,Cu.Ds);return t.ic(n).next((function(){return t.cc(n)}))}))];case 1:return e.sent(),this.Wo.close(),this.Tc(),[2]}}))}))},t.prototype.hc=function(t,e){var n=this;return t.filter((function(t){return n.ac(t.updateTimeMs,e)&&!n._c(t.clientId)}))},t.prototype.Ic=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return cc(e).ui().next((function(e){return t.hc(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.mc=function(t){return ya.vr(t,this.serializer,this.os,this.Vr)},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.Pc=function(){return this.os},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;qr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Wo.runTransaction(t,o,Ya,(function(o){return i=new sc(o,r.ko?r.ko.next():Cu.Ds),"readwrite-primary"===e?r.nc(i).next((function(t){return!!t||r.sc(i)})).next((function(e){if(!e)throw Fr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Cs.Mi((function(){return r.Qo(!1)})),new Yr(Hr.FAILED_PRECONDITION,Su);return n(i)})).next((function(t){return r.rc(i).next((function(){return t}))})):r.yc(i).next((function(){return n(i)}))})).then((function(t){return i.ns(),t}))},t.prototype.yc=function(t){var e=this;return ac(t).get(Pa.key).next((function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e._c(t.ownerId)&&!e.oc(t)&&!(e.Mo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Yr(Hr.FAILED_PRECONDITION,oc)}))},t.prototype.rc=function(t){var e=new Pa(this.clientId,this.allowTabSynchronization,Date.now());return ac(t).put(Pa.key,e)},t.Gs=function(){return Lu.Gs()},t.prototype.ic=function(t){var e=this,n=ac(t);return n.get(Pa.key).next((function(t){return e.oc(t)?(qr("IndexedDbPersistence","Releasing primary lease."),n.delete(Pa.key)):Tu.resolve()}))},t.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Fr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Jo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Bo=function(){t.Cs.Ri((function(){return t.inForeground="visible"===t.document.visibilityState,t.Ho()}))},this.document.addEventListener("visibilitychange",this.Bo),this.inForeground="visible"===this.document.visibilityState)},t.prototype.wc=function(){this.Bo&&(this.document.removeEventListener("visibilitychange",this.Bo),this.Bo=null)},t.prototype.Yo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Lo=function(){e.dc(),e.Cs.Ri((function(){return e.fc()}))},this.window.addEventListener("unload",this.Lo))},t.prototype.Ec=function(){this.Lo&&(this.window.removeEventListener("unload",this.Lo),this.Lo=null)},t.prototype._c=function(t){var e;try{var n=null!==(null===(e=this.zo)||void 0===e?void 0:e.getItem(this.lc(t)));return qr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Fr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.dc=function(){if(this.zo)try{this.zo.setItem(this.lc(this.clientId),String(Date.now()))}catch(t){Fr("Failed to set zombie client id.",t)}},t.prototype.Tc=function(){if(this.zo)try{this.zo.removeItem(this.lc(this.clientId))}catch(t){}},t.prototype.lc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function ac(t){return uc.Ys(t,Pa.store)}function cc(t){return uc.Ys(t,Ka.store)}var hc=function(){function t(t,e){this.db=t,this.cr=new ta(this,e)}return t.prototype.Er=function(t){var e=this.Vc(t);return this.db.Ac().vo(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.Vc=function(t){var e=0;return this.Ir(t,(function(t){e++})).next((function(){return e}))},t.prototype.Ue=function(t,e){return this.db.Ac().Ue(t,e)},t.prototype.Ir=function(t,e){return this.vc(t,(function(t,n){return e(n)}))},t.prototype.Do=function(t,e,n){return fc(t,n)},t.prototype.No=function(t,e,n){return fc(t,n)},t.prototype.mr=function(t,e,n){return this.db.Ac().mr(t,e,n)},t.prototype.qr=function(t,e){return fc(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return _a(t).fi((function(r){return ga(t,r,e).next((function(t){return t&&(n=!0),Tu.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.Ar=function(t,e){var n=this,r=this.db.Rc().Xr(),i=[],o=0;return this.vc(t,(function(s,u){if(u<=e){var a=n.bc(t,s).next((function(e){if(!e)return o++,r.Jn(t,s).next((function(){return r.Hn(s),ic(t).delete([0,ea(s.path)])}))}));i.push(a)}})).next((function(){return Tu.qn(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.dt(t.Fo);return this.db.Ac().yo(t,n)},t.prototype.Sc=function(t,e){return fc(t,e)},t.prototype.vc=function(t,e){var n,r=ic(t),i=Cu.Ds;return r._i({index:Fa.documentTargetsIndex},(function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Cu.Ds&&e(new fi(ia(n)),i),i=u,n=s):i=Cu.Ds})).next((function(){i!==Cu.Ds&&e(new fi(ia(n)),i)}))},t.prototype.Pr=function(t){return this.db.Rc().eo(t)},t}();function fc(t,e){return ic(t).put(function(t,e){return new Fa(0,ea(t.path),e)}(e,t.Fo))}function lc(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var pc=function(){function t(t,e,n,r){this.persistence=t,this.Dc=e,this.serializer=r,this.Cc=new Di(ni),this.Nc=new Eu((function(t){return gi(t)}),mi),this.xc=si.min(),this.rs=t.mc(n),this.Fc=t.Rc(),this.jo=t.Ac(),this.Oc=new ku(this.Fc,this.rs,this.persistence.Pc()),this.Go=t.gc(),this.Dc.Mc(this.Oc)}return t.prototype._r=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.Rr(n,e.Cc)}))},t}();function dc(t,e,n,r){return new pc(t,e,n,r)}function vc(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o;return s(this,(function(s){switch(s.label){case 0:return n=Wr(t),r=n.rs,i=n.Oc,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n.rs.Mr(t).next((function(s){return o=s,r=n.persistence.mc(e),i=new ku(n.Fc,r,n.persistence.Pc()),r.Mr(t)})).next((function(e){for(var n=[],r=[],s=ji(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return i._s(t,s).next((function(t){return{kc:t,$c:n,Lc:r}}))}))}))];case 1:return o=s.sent(),[2,(n.rs=r,n.Oc=i,n.Dc.Mc(n.Oc),o)]}}))}))}function yc(t,e){var n=Wr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.Fc.Xr({Zr:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=Tu.resolve();return o.forEach((function(t){s=s.next((function(){return r.Jn(e,t)})).next((function(e){var o=e,s=n.Sn.get(t);Kr(null!==s),(!o||o.version.F(s)<0)&&(o=i.yn(t,o,n))&&r.jn(o,n.bn)}))})),s.next((function(){return t.rs.$r(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n.rs.Ur(t)})).next((function(){return n.Oc._s(t,r)}))}))}function gc(t){var e=Wr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.jo.To(t)}))}function mc(t,e){var n=Wr(t),r=e.ft,i=n.Cc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.Fc.Xr({Zr:!0});i=n.Cc;var s=[];e.re.forEach((function(e,o){var u=i.get(o);if(u){s.push(n.jo.Co(t,e.de,o).next((function(){return n.jo.So(t,e._e,o)})));var a=e.resumeToken;if(a.ht()>0){var c=u.wt(a,r).dt(t.Fo);i=i.Tt(o,c),function(t,e,n){return Kr(e.resumeToken.ht()>0),0===t.resumeToken.ht()||e.ft.O()-t.ft.O()>=3e8||n._e.size+n.fe.size+n.de.size>0}(u,c,e)&&s.push(n.jo.yo(t,c))}}}));var u=Ci();if(e.ce.forEach((function(r,i){e.ue.has(r)&&s.push(n.persistence.Vr.Sc(t,r))})),s.push(function(t,e,n,r,i){var o=ji();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var i=Ci();return n.forEach((function(n,o){var s=t.get(n),u=r;o instanceof Fs&&o.version.isEqual(si.min())?(e.Hn(n,u),i=i.Tt(n,o)):null==s||o.version.F(s.version)>0||0===o.version.F(s.version)&&s.hasPendingWrites?(e.jn(o,u),i=i.Tt(n,o)):qr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),i}))}(t,o,e.ce,r).next((function(t){u=t}))),!r.isEqual(si.min())){var a=n.jo.To(t).next((function(e){return n.jo.mo(t,t.Fo,r)}));s.push(a)}return Tu.qn(s).next((function(){return o.apply(t)})).next((function(){return n.Oc.fs(t,u)}))})).then((function(t){return n.Cc=i,t}))}function wc(t,e){var n=Wr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n.rs.Fr(t,e)}))}function bc(t,e){var n=Wr(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.jo.bo(t,e).next((function(i){return i?(r=i,Tu.resolve(r)):n.jo.fo(t).next((function(i){return r=new Ei(e,i,0,t.Fo),n.jo.Ao(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Cc.get(t.targetId);return(null===r||t.ft.F(r.ft)>0)&&(n.Cc=n.Cc.Tt(t.targetId,t),n.Nc.set(e,t.targetId)),t}))}function _c(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o,u;return s(this,(function(s){switch(s.label){case 0:r=Wr(t),i=r.Cc.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.Vr.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!Uu(u=s.sent()))throw u;return qr("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.Cc=r.Cc.remove(e),r.Nc.delete(i.target),[2]}}))}))}function Ic(t,e,n){var r=Wr(t),i=si.min(),o=ji();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Wr(t),i=r.Nc.get(n);return void 0!==i?Tu.resolve(r.Cc.get(i)):r.jo.bo(e,n)}(r,t,Js(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.jo.xo(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.Dc.ws(t,e,n?i:si.min(),n?o:ji())})).next((function(t){return{documents:t,Bc:o}}))}))}function Ec(t,e){var n=Wr(t),r=Wr(n.jo),i=n.Cc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.Ze(t,e).next((function(t){return t?t.target:null}))}))}function Tc(t){var e=Wr(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Wr(t),i=Ci(),o=aa(n),s=Aa(e),u=IDBKeyRange.lowerBound(o,!0);return s._i({index:Ua.readTimeIndex,range:u},(function(t,e){var n=sa(r.serializer,e);i=i.Tt(n.key,n),o=e.readTime})).next((function(){return{qc:i,readTime:ca(o)}}))}(e.Fc,t,e.xc)})).then((function(t){var n=t.qc,r=t.readTime;return e.xc=r,n}))}function Ac(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return[2,(e=Wr(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Aa(t),n=si.min();return e._i({index:Ua.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=ca(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.xc=t}))]}))}))}function Nc(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){if(t.code!==Hr.FAILED_PRECONDITION||t.message!==Su)throw t;return qr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dc=function(){function t(t,e,n,r,i,o){this.Cs=t,this.Uc=n,this.Qc=r,this.Kc=i,this.listener=o,this.state=0,this.Wc=0,this.jc=null,this.stream=null,this.Si=new Ru(t,e)}return t.prototype.Gc=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.zc=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.Hc()},t.prototype.stop=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.Gc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.Jc=function(){this.state=0,this.Si.reset()},t.prototype.Yc=function(){var t=this;this.zc()&&null===this.jc&&(this.jc=this.Cs.Us(this.Uc,6e4,(function(){return t.Xc()})))},t.prototype.Zc=function(t){this.tu(),this.stream.send(t)},t.prototype.Xc=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return this.zc()?[2,this.close(0)]:[2]}))}))},t.prototype.tu=function(){this.jc&&(this.jc.cancel(),this.jc=null)},t.prototype.close=function(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return this.tu(),this.Si.cancel(),this.Wc++,3!==t?this.Si.reset():e&&e.code===Hr.RESOURCE_EXHAUSTED?(Fr(e.toString()),Fr("Using maximum backoff delay to prevent overloading the backend."),this.Si.Ls()):e&&e.code===Hr.UNAUTHENTICATED&&this.Kc.m(),null!==this.stream&&(this.eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.nu(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.su(this.Wc),n=this.Wc;this.Kc.getToken().then((function(e){t.Wc===n&&t.iu(e)}),(function(n){e((function(){var e=new Yr(Hr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.ru(e)}))}))},t.prototype.iu=function(t){var e=this,n=this.su(this.Wc);this.stream=this.ou(t),this.stream.cu((function(){n((function(){return e.state=2,e.listener.cu()}))})),this.stream.nu((function(t){n((function(){return e.ru(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.Hc=function(){var t=this;this.state=4,this.Si.Bs((function(){return o(t,void 0,void 0,(function(){return s(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.ru=function(t){return qr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.su=function(t){var e=this;return function(n){e.Cs.Ri((function(){return e.Wc===t?n():(qr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),xc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return i(e,t),e.prototype.ou=function(t){return this.Qc.uu("Listen",t)},e.prototype.onMessage=function(t){this.Si.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Gr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.tn?(Kr(void 0===e||"string"==typeof e),bi.fromBase64String(e||"")):(Kr(void 0===e||e instanceof Uint8Array),bi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?Hr.UNKNOWN:Ni(t.code);return new Yr(e,t.message||"")}(s);n=new Qi(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;var a=e.documentChange;a.document,a.document.name,a.document.updateTime;var c=Mo(t,a.document.name),h=Co(a.document.updateTime),f=new Vs({mapValue:{fields:a.document.fields}}),l=new qs(c,h,f,{}),p=a.targetIds||[],d=a.removedTargetIds||[];n=new Hi(p,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var y=Mo(t,v.document),g=v.readTime?Co(v.readTime):si.min(),m=new Fs(y,g),w=v.removedTargetIds||[];n=new Hi([],w,m.key,m)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var _=Mo(t,b.document),I=b.removedTargetIds||[];n=new Hi([],I,_,null)}else{if(!("filter"in e))return Gr();e.filter;var E=e.filter;E.targetId;var T=E.count||0,A=new Ti(T),N=E.targetId;n=new Yi(N,A)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return si.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?si.min():e.readTime?Co(e.readTime):si.min()}(t);return this.listener.au(e,n)},e.prototype.hu=function(t){var e={};e.database=qo(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=wi(r)?{documents:Ko(t,r)}:{query:Wo(t,r)}).targetId=e.targetId,e.resumeToken.ht()>0?n.resumeToken=ko(t,e.resumeToken):e.ft.F(si.min())>0&&(n.readTime=Oo(t,e.ft.M())),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Gr()}}(0,e._t);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.Zc(e)},e.prototype.lu=function(t){var e={};e.database=qo(this.serializer),e.removeTarget=t,this.Zc(e)},e}(Dc),Sc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s._u=!1,s}return i(e,t),Object.defineProperty(e.prototype,"fu",{get:function(){return this._u},enumerable:!1,configurable:!0}),e.prototype.start=function(){this._u=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.eu=function(){this._u&&this.du([])},e.prototype.ou=function(t){return this.Qc.uu("Write",t)},e.prototype.onMessage=function(t){if(Kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this._u){this.Si.reset();var e=function(t,e){return t&&t.length>0?(Kr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Co(t.updateTime):Co(e);n.isEqual(si.min())&&(n=Co(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new ws(n,r)}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Co(t.commitTime);return this.listener.wu(n,e)}return Kr(!t.writeResults||0===t.writeResults.length),this._u=!0,this.listener.Eu()},e.prototype.Tu=function(){var t={};t.database=qo(this.serializer),this.Zc(t)},e.prototype.du=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Bo(e.serializer,t)}))};this.Zc(n)},e}(Dc),Oc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Qc=n,i.serializer=r,i.Iu=!1,i}return i(e,t),e.prototype.mu=function(){if(this.Iu)throw new Yr(Hr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Au=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then((function(i){return r.Qc.Au(t,e,n,i)})).catch((function(t){throw t.code===Hr.UNAUTHENTICATED&&r.credentials.m(),t}))},e.prototype.Ru=function(t,e,n){var r=this;return this.mu(),this.credentials.getToken().then((function(i){return r.Qc.Ru(t,e,n,i)})).catch((function(t){throw t.code===Hr.UNAUTHENTICATED&&r.credentials.m(),t}))},e.prototype.terminate=function(){this.Iu=!1},e}((function(){})),kc=function(){function t(t,e){this.di=t,this.Pu=e,this.state="Unknown",this.gu=0,this.yu=null,this.Vu=!0}return t.prototype.pu=function(){var t=this;0===this.gu&&(this.vu("Unknown"),this.yu=this.di.Us("online_state_timeout",1e4,(function(){return t.yu=null,t.bu("Backend didn't respond within 10 seconds."),t.vu("Offline"),Promise.resolve()})))},t.prototype.Su=function(t){"Online"===this.state?this.vu("Unknown"):(this.gu++,this.gu>=1&&(this.Du(),this.bu("Connection failed 1 times. Most recent error: "+t.toString()),this.vu("Offline")))},t.prototype.set=function(t){this.Du(),this.gu=0,"Online"===t&&(this.Vu=!1),this.vu(t)},t.prototype.vu=function(t){t!==this.state&&(this.state=t,this.Pu(t))},t.prototype.bu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vu?(Fr(e),this.Vu=!1):qr("OnlineStateTracker",e)},t.prototype.Du=function(){null!==this.yu&&(this.yu.cancel(),this.yu=null)},t}(),Pc=function(t,e,n,r,i){var u=this;this.Cu=t,this.Nu=e,this.di=n,this.xu={},this.Fu=[],this.Ou=new Map,this.Mu=new Set,this.ku=[],this.$u=i,this.$u.Lu((function(t){n.Ri((function(){return o(u,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return Fc(this)?(qr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return(e=Wr(t)).Mu.add(4),[4,Rc(e)];case 1:return n.sent(),e.Bu.set("Unknown"),e.Mu.delete(4),[4,Cc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Bu=new kc(n,r)};function Cc(t){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:if(!Fc(t))return[3,4];e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Rc(t){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:e=0,n=t.ku,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Lc(t,e){var n=Wr(t);n.Ou.has(e.targetId)||(n.Ou.set(e.targetId,e),qc(n)?jc(n):nh(n).zc()&&Mc(n,e))}function Vc(t,e){var n=Wr(t),r=nh(n);n.Ou.delete(e),r.zc()&&Uc(n,e),0===n.Ou.size&&(r.zc()?r.Yc():Fc(n)&&n.Bu.set("Unknown"))}function Mc(t,e){t.qu.De(e.targetId),nh(t).hu(e)}function Uc(t,e){t.qu.De(e),nh(t).lu(e)}function jc(t){t.qu=new $i({Xe:function(e){return t.xu.Xe(e)},Ze:function(e){return t.Ou.get(e)||null}}),nh(t).start(),t.Bu.pu()}function qc(t){return Fc(t)&&!nh(t).Gc()&&t.Ou.size>0}function Fc(t){return 0===Wr(t).Mu.size}function zc(t){t.qu=void 0}function Bc(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return t.Ou.forEach((function(e,n){Mc(t,e)})),[2]}))}))}function Gc(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){return zc(t),qc(t)?(t.Bu.Su(e),jc(t)):t.Bu.set("Unknown"),[2]}))}))}function Kc(t,e,n){return o(this,void 0,void 0,(function(){var r,i,u;return s(this,(function(a){switch(a.label){case 0:if(t.Bu.set("Online"),!(e instanceof Qi&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o;return s(this,(function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Ou.has(o)?[4,t.xu.Uu(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Ou.delete(o),t.qu.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),qr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Wc(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Hi?t.qu.$e(e):e instanceof Yi?t.qu.je(e):t.qu.qe(e),n.isEqual(si.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,gc(t.Cu)];case 8:return i=a.sent(),n.F(i)>=0?[4,function(t,e){var n=t.qu.He(e);return n.re.forEach((function(n,r){if(n.resumeToken.ht()>0){var i=t.Ou.get(r);i&&t.Ou.set(r,i.wt(n.resumeToken,e))}})),n.oe.forEach((function(e){var n=t.Ou.get(e);if(n){t.Ou.set(e,n.wt(bi.lt,n.ft)),Uc(t,e);var r=new Ei(n.target,e,1,n.sequenceNumber);Mc(t,r)}})),t.xu.Qu(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return qr("RemoteStore","Failed to raise snapshot:",u=a.sent()),[4,Wc(t,u)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Wc(t,e,n){return o(this,void 0,void 0,(function(){var r=this;return s(this,(function(i){switch(i.label){case 0:if(!Uu(e))throw e;return t.Mu.add(1),[4,Rc(t)];case 1:return i.sent(),t.Bu.set("Offline"),n||(n=function(){return gc(t.Cu)}),t.di.Mi((function(){return o(r,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return qr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Mu.delete(1),[4,Cc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Hc(t,e){return e().catch((function(n){return Wc(t,n,e)}))}function Yc(t){return o(this,void 0,void 0,(function(){var e,n,r,i,o;return s(this,(function(s){switch(s.label){case 0:e=Wr(t),n=rh(e),r=e.Fu.length>0?e.Fu[e.Fu.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Fc(t)&&t.Fu.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,wc(e.Cu,r)];case 3:return null===(i=s.sent())?(0===e.Fu.length&&n.Yc(),[3,7]):(r=i.batchId,function(t,e){t.Fu.push(e);var n=rh(t);n.zc()&&n.fu&&n.du(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,Wc(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return Qc(e)&&Xc(e),[2]}}))}))}function Qc(t){return Fc(t)&&!rh(t).Gc()&&t.Fu.length>0}function Xc(t){rh(t).start()}function $c(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return rh(t).Tu(),[2]}))}))}function Jc(t){return o(this,void 0,void 0,(function(){var e,n,r,i;return s(this,(function(o){for(e=rh(t),n=0,r=t.Fu;n<r.length;n++)i=r[n],e.du(i.mutations);return[2]}))}))}function Zc(t,e,n){return o(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:return r=t.Fu.shift(),i=Iu.from(r,e,n),[4,Hc(t,(function(){return t.xu.Ku(i)}))];case 1:return o.sent(),[4,Yc(t)];case 2:return o.sent(),[2]}}))}))}function th(t,e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return e&&rh(t).fu?[4,function(t,e){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return Ai(r=e.code)&&r!==Hr.ABORTED?(n=t.Fu.shift(),rh(t).Jc(),[4,Hc(t,(function(){return t.xu.Wu(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Yc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Qc(t)&&Xc(t),[2]}}))}))}function eh(t,e){return o(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=Wr(t),e?(n.Mu.delete(2),[4,Cc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Mu.add(2),[4,Rc(n)]);case 3:r.sent(),n.Bu.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function nh(t){var e=this;return t.ju||(t.ju=function(t,e,n){var r=Wr(t);return r.mu(),new xc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:Bc.bind(null,t),nu:Gc.bind(null,t),au:Kc.bind(null,t)}),t.ku.push((function(n){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return n?(t.ju.Jc(),qc(t)?jc(t):t.Bu.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.ju.stop()];case 2:e.sent(),zc(t),e.label=3;case 3:return[2]}}))}))}))),t.ju}function rh(t){var e=this;return t.Gu||(t.Gu=function(t,e,n){var r=Wr(t);return r.mu(),new Sc(e,r.Qc,r.credentials,r.serializer,n)}(t.Nu,t.di,{cu:$c.bind(null,t),nu:th.bind(null,t),Eu:Jc.bind(null,t),wu:Zc.bind(null,t)}),t.ku.push((function(n){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return n?(t.Gu.Jc(),[4,Yc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Gu.stop()];case 3:e.sent(),t.Fu.length>0&&(qr("RemoteStore","Stopping write stream with "+t.Fu.length+" pending writes"),t.Fu=[]),e.label=4;case 4:return[2]}}))}))}))),t.Gu
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}var ih=function(){this.zu=void 0,this.listeners=[]},oh=function(){this.queries=new Eu((function(t){return eu(t)}),tu),this.onlineState="Unknown",this.Hu=new Set};function sh(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u,a,c;return s(this,(function(s){switch(s.label){case 0:if(n=Wr(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new ih),!i)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),u=o,[4,n.Ju(r)];case 2:return u.zu=s.sent(),[3,4];case 3:return a=s.sent(),c=Yu(a,"Initialization of query '"+nu(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Yu(n.onlineState),o.zu&&e.Xu(o.zu)&&hh(n),[2]}}))}))}function uh(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u;return s(this,(function(s){return n=Wr(t),r=e.query,i=!1,(o=n.queries.get(r))&&(u=o.listeners.indexOf(e))>=0&&(o.listeners.splice(u,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Zu(r))]:[2]}))}))}function ah(t,e){for(var n=Wr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.queries.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Xu(s)&&(r=!0);a.zu=s}}r&&hh(n)}function ch(t,e,n){var r=Wr(t),i=r.queries.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.queries.delete(e)}function hh(t){t.Hu.forEach((function(t){t.next()}))}var fh=function(){function t(t,e,n){this.query=t,this.ta=e,this.ea=!1,this.na=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Xu=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Gi(t.query,t.docs,t.te,e,t.ee,t.fromCache,t.ne,!0)}var o=!1;return this.ea?this.sa(t)&&(this.ta.next(t),o=!0):this.ia(t,this.onlineState)&&(this.ra(t),o=!0),this.na=t,o},t.prototype.onError=function(t){this.ta.error(t)},t.prototype.Yu=function(t){this.onlineState=t;var e=!1;return this.na&&!this.ea&&this.ia(this.na,t)&&(this.ra(this.na),e=!0),e},t.prototype.ia=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.oa&&n||t.docs.W()&&"Offline"!==e)},t.prototype.sa=function(t){if(t.docChanges.length>0)return!0;var e=this.na&&this.na.hasPendingWrites!==t.hasPendingWrites;return!(!t.ne&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.ra=function(t){t=Gi.ie(t.query,t.docs,t.ee,t.fromCache),this.ea=!0,this.ta.next(t)},t}(),lh=function(){function t(){this.ca=new Oi(ph.ua),this.aa=new Oi(ph.ha)}return t.prototype.W=function(){return this.ca.W()},t.prototype.Do=function(t,e){var n=new ph(t,e);this.ca=this.ca.add(n),this.aa=this.aa.add(n)},t.prototype.la=function(t,e){var n=this;t.forEach((function(t){return n.Do(t,e)}))},t.prototype.No=function(t,e){this._a(new ph(t,e))},t.prototype.fa=function(t,e){var n=this;t.forEach((function(t){return n.No(t,e)}))},t.prototype.da=function(t){var e=this,n=new fi(new ai([])),r=new ph(n,t),i=new ph(n,t+1),o=[];return this.aa.Kt([r,i],(function(t){e._a(t),o.push(t.key)})),o},t.prototype.wa=function(){var t=this;this.ca.forEach((function(e){return t._a(e)}))},t.prototype._a=function(t){this.ca=this.ca.delete(t),this.aa=this.aa.delete(t)},t.prototype.Ea=function(t){var e=new fi(new ai([])),n=new ph(e,t),r=new ph(e,t+1),i=ji();return this.aa.Kt([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.Qr=function(t){var e=new ph(t,0),n=this.ca.jt(e);return null!==n&&t.isEqual(n.key)},t}(),ph=function(){function t(t,e){this.key=t,this.Ta=e}return t.ua=function(t,e){return fi.$(t.key,e.key)||ni(t.Ta,e.Ta)},t.ha=function(t,e){return ni(t.Ta,e.Ta)||fi.$(t.key,e.key)},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(t,e){return"firestore_clients_"+t+"_"+e}function vh(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.u()&&(r+="_"+e.uid),r}function yh(t,e){return"firestore_targets_"+t+"_"+e}var gh=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Ia=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Yr(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Fr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),mh=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Ia=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Yr(r.error.code,r.error.message)),i?new t(e,r.state,o):(Fr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ma=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),wh=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Ia=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Fi(),s=0;i&&s<r.activeTargetIds.length;++s)i=di(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Fr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),bh=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Ia=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Fr("SharedClientState","Failed to parse online state: "+e),null)},t}(),_h=function(){function t(){this.activeTargetIds=Fi()}return t.prototype.Aa=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Ra=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ma=function(){var t={activeTargetIds:this.activeTargetIds.H(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ih=function(){function t(t,e,n,r,i){this.window=t,this.Cs=e,this.persistenceKey=n,this.Pa=r,this.ga=null,this.Pu=null,this.ps=null,this.ya=this.Va.bind(this),this.pa=new Di(ni),this.lr=!1,this.va=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ba=dh(this.persistenceKey,this.Pa),this.Sa=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.pa=this.pa.Tt(this.Pa,new _h),this.Da=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ca=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Na=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.xa=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Fa=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.ya)}return t.Gs=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i,o,u,a,c,h,f,l=this;return s(this,(function(s){switch(s.label){case 0:return[4,this.ga.Ic()];case 1:for(t=s.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Pa&&(i=this.getItem(dh(this.persistenceKey,r)))&&(o=wh.Ia(r,i))&&(this.pa=this.pa.Tt(o.clientId,o));for(this.Oa(),(u=this.storage.getItem(this.xa))&&(a=this.Ma(u))&&this.ka(a),c=0,h=this.va;c<h.length;c++)f=h[c],this.Va(f);return this.va=[],this.window.addEventListener("unload",(function(){return l.fc()})),this.lr=!0,[2]}}))}))},t.prototype.Ss=function(t){this.setItem(this.Sa,JSON.stringify(t))},t.prototype.$a=function(){return this.La(this.pa)},t.prototype.Ba=function(t){var e=!1;return this.pa.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.qa=function(t){this.Ua(t,"pending")},t.prototype.Qa=function(t,e,n){this.Ua(t,e,n),this.Ka(t)},t.prototype.Wa=function(t){var e="not-current";if(this.Ba(t)){var n=this.storage.getItem(yh(this.persistenceKey,t));if(n){var r=mh.Ia(t,n);r&&(e=r.state)}}return this.ja.Aa(t),this.Oa(),e},t.prototype.Ga=function(t){this.ja.Ra(t),this.Oa()},t.prototype.za=function(t){return this.ja.activeTargetIds.has(t)},t.prototype.Ha=function(t){this.removeItem(yh(this.persistenceKey,t))},t.prototype.Ja=function(t,e,n){this.Ya(t,e,n)},t.prototype.Xa=function(t,e,n){var r=this;e.forEach((function(t){r.Ka(t)})),this.currentUser=t,n.forEach((function(t){r.qa(t)}))},t.prototype.Za=function(t){this.th(t)},t.prototype.eh=function(){this.nh()},t.prototype.fc=function(){this.lr&&(this.window.removeEventListener("storage",this.ya),this.removeItem(this.ba),this.lr=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return qr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){qr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){qr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Va=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(qr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ba)return void Fr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Cs.Mi((function(){return o(e,void 0,void 0,(function(){var t,e,r,i,o,u;return s(this,(function(s){if(this.lr){if(null!==n.key)if(this.Da.test(n.key)){if(null==n.newValue)return t=this.sh(n.key),[2,this.ih(t,null)];if(e=this.rh(n.key,n.newValue))return[2,this.ih(e.clientId,e)]}else if(this.Ca.test(n.key)){if(null!==n.newValue&&(r=this.oh(n.key,n.newValue)))return[2,this.uh(r)]}else if(this.Na.test(n.key)){if(null!==n.newValue&&(i=this.ah(n.key,n.newValue)))return[2,this.hh(i)]}else if(n.key===this.xa){if(null!==n.newValue&&(o=this.Ma(n.newValue)))return[2,this.ka(o)]}else if(n.key===this.Sa)(u=function(t){var e=Cu.Ds;if(null!=t)try{var n=JSON.parse(t);Kr("number"==typeof n),e=n}catch(t){Fr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Cu.Ds&&this.ps(u);else if(n.key===this.Fa)return[2,this.ga.lh()]}else this.va.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"ja",{get:function(){return this.pa.get(this.Pa)},enumerable:!1,configurable:!0}),t.prototype.Oa=function(){this.setItem(this.ba,this.ja.ma())},t.prototype.Ua=function(t,e,n){var r=new gh(this.currentUser,t,e,n),i=vh(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ma())},t.prototype.Ka=function(t){var e=vh(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.th=function(t){var e={clientId:this.Pa,onlineState:t};this.storage.setItem(this.xa,JSON.stringify(e))},t.prototype.Ya=function(t,e,n){var r=yh(this.persistenceKey,t),i=new mh(t,e,n);this.setItem(r,i.ma())},t.prototype.nh=function(){this.setItem(this.Fa,"value-not-used")},t.prototype.sh=function(t){var e=this.Da.exec(t);return e?e[1]:null},t.prototype.rh=function(t,e){var n=this.sh(t);return wh.Ia(n,e)},t.prototype.oh=function(t,e){var n=this.Ca.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return gh.Ia(new Mr(i),r,e)},t.prototype.ah=function(t,e){var n=this.Na.exec(t),r=Number(n[1]);return mh.Ia(r,e)},t.prototype.Ma=function(t){return bh.Ia(t)},t.prototype.uh=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.ga._h(t.batchId,t.state,t.error)]:(qr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.hh=function(t){return this.ga.fh(t.targetId,t.state,t.error)},t.prototype.ih=function(t,e){var n=this,r=e?this.pa.Tt(t,e):this.pa.remove(t),i=this.La(this.pa),o=this.La(r),s=[],u=[];return o.forEach((function(t){i.has(t)||s.push(t)})),i.forEach((function(t){o.has(t)||u.push(t)})),this.ga.dh(s,u).then((function(){n.pa=r}))},t.prototype.ka=function(t){this.pa.get(t.clientId)&&this.Pu(t.onlineState)},t.prototype.La=function(t){var e=Fi();return t.forEach((function(t,n){e=e.Gt(n.activeTargetIds)})),e},t}(),Eh=function(){function t(){this.wh=new _h,this.Eh={},this.Pu=null,this.ps=null}return t.prototype.qa=function(t){},t.prototype.Qa=function(t,e,n){},t.prototype.Wa=function(t){return this.wh.Aa(t),this.Eh[t]||"not-current"},t.prototype.Ja=function(t,e,n){this.Eh[t]=e},t.prototype.Ga=function(t){this.wh.Ra(t)},t.prototype.za=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.Ha=function(t){delete this.Eh[t]},t.prototype.$a=function(){return this.wh.activeTargetIds},t.prototype.Ba=function(t){return this.wh.activeTargetIds.has(t)},t.prototype.start=function(){return this.wh=new _h,Promise.resolve()},t.prototype.Xa=function(t,e,n){},t.prototype.Za=function(t){},t.prototype.fc=function(){},t.prototype.Ss=function(t){},t.prototype.eh=function(){},t}(),Th=function(t){this.key=t},Ah=function(t){this.key=t},Nh=function(){function t(t,e){this.query=t,this.Th=e,this.Ih=null,this.le=!1,this.mh=ji(),this.ee=ji(),this.Ah=iu(t),this.Rh=new zi(this.Ah)}return Object.defineProperty(t.prototype,"Ph",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.gh=function(t,e){var n=this,r=e?e.yh:new Bi,i=e?e.Rh:this.Rh,o=e?e.ee:this.ee,s=i,u=!1,a=Ws(this.query)&&i.size===this.query.limit?i.last():null,c=Hs(this.query)&&i.size===this.query.limit?i.first():null;if(t.Pt((function(t,e){var h=i.get(t),f=e instanceof qs?e:null;f&&(f=ru(n.query,f)?f:null);var l=!!h&&n.ee.has(h.key),p=!!f&&(f.an||n.ee.has(f.key)&&f.hasCommittedMutations),d=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),d=!0):n.Vh(h,f)||(r.track({type:2,doc:f}),d=!0,(a&&n.Ah(f,a)>0||c&&n.Ah(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),d=!0):h&&!f&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(f?(s=s.add(f),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))})),Ws(this.query)||Hs(this.query))for(;s.size>this.query.limit;){var h=Ws(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Rh:s,yh:r,ph:u,ee:o}},t.prototype.Vh=function(t,e){return t.an&&e.hasCommittedMutations&&!e.an},t.prototype.Zn=function(t,e,n){var r=this,i=this.Rh;this.Rh=t.Rh,this.ee=t.ee;var o=t.yh.Zt();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gr()}};return n(t)-n(e)}(t.type,e.type)||r.Ah(t.doc,e.doc)})),this.bh(n);var s=e?this.Sh():[],u=0===this.mh.size&&this.le?1:0,a=u!==this.Ih;return this.Ih=u,0!==o.length||a?{snapshot:new Gi(this.query,t.Rh,i,o,t.ee,0===u,a,!1),Dh:s}:{Dh:s}},t.prototype.Yu=function(t){return this.le&&"Offline"===t?(this.le=!1,this.Zn({Rh:this.Rh,yh:new Bi,ee:this.ee,ph:!1},!1)):{Dh:[]}},t.prototype.Ch=function(t){return!this.Th.has(t)&&!!this.Rh.has(t)&&!this.Rh.get(t).an},t.prototype.bh=function(t){var e=this;t&&(t._e.forEach((function(t){return e.Th=e.Th.add(t)})),t.fe.forEach((function(t){})),t.de.forEach((function(t){return e.Th=e.Th.delete(t)})),this.le=t.le)},t.prototype.Sh=function(){var t=this;if(!this.le)return[];var e=this.mh;this.mh=ji(),this.Rh.forEach((function(e){t.Ch(e.key)&&(t.mh=t.mh.add(e.key))}));var n=[];return e.forEach((function(e){t.mh.has(e)||n.push(new Ah(e))})),this.mh.forEach((function(t){e.has(t)||n.push(new Th(t))})),n},t.prototype.Nh=function(t){this.Th=t.Bc,this.mh=ji();var e=this.gh(t.documents);return this.Zn(e,!0)},t.prototype.xh=function(){return Gi.ie(this.query,this.Rh,this.ee,0===this.Ih)},t}(),Dh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},xh=function(t){this.key=t,this.Fh=!1},Sh=function(){function t(t,e,n,r,i,o){this.Cu=t,this.Oh=e,this.Mh=n,this.kh=r,this.currentUser=i,this.$h=o,this.Lh={},this.Bh=new Eu((function(t){return eu(t)}),tu),this.qh=new Map,this.Uh=[],this.Qh=new Di(fi.$),this.Kh=new Map,this.Wh=new lh,this.jh={},this.Gh=new Map,this.zh=tc._o(),this.onlineState="Unknown",this.Hh=void 0}return Object.defineProperty(t.prototype,"Jh",{get:function(){return!0===this.Hh},enumerable:!1,configurable:!0}),t}();function Oh(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u,a;return s(this,(function(s){switch(s.label){case 0:return n=sf(t),(o=n.Bh.get(e))?(r=o.targetId,n.kh.Wa(r),i=o.view.xh(),[3,4]):[3,1];case 1:return[4,bc(n.Cu,Js(e))];case 2:return u=s.sent(),a=n.kh.Wa(u.targetId),r=u.targetId,[4,kh(n,e,r,"current"===a)];case 3:i=s.sent(),n.Jh&&Lc(n.Oh,u),s.label=4;case 4:return[2,i]}}))}))}function kh(t,e,n,r){return o(this,void 0,void 0,(function(){var i,u,a,c,h,f;return s(this,(function(l){switch(l.label){case 0:return t.Yh=function(e,n,r){return function(t,e,n,r){return o(this,void 0,void 0,(function(){var i,o,u;return s(this,(function(s){switch(s.label){case 0:return i=e.view.gh(n),i.ph?[4,Ic(t.Cu,e.query,!1).then((function(t){var n=t.documents;return e.view.gh(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.re.get(e.targetId),u=e.view.Zn(i,t.Jh,o),[2,(Gh(t,e.targetId,u.Dh),u.snapshot)]}}))}))}(t,e,n,r)},[4,Ic(t.Cu,e,!0)];case 1:return i=l.sent(),u=new Nh(e,i.Bc),a=u.gh(i.documents),c=Wi.he(n,r&&"Offline"!==t.onlineState),h=u.Zn(a,t.Jh,c),Gh(t,n,h.Dh),f=new Dh(e,n,u),[2,(t.Bh.set(e,f),t.qh.has(n)?t.qh.get(n).push(e):t.qh.set(n,[e]),h.snapshot)]}}))}))}function Ph(t,e){return o(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return n=Wr(t),r=n.Bh.get(e),(i=n.qh.get(r.targetId)).length>1?[2,(n.qh.set(r.targetId,i.filter((function(t){return!tu(t,e)}))),void n.Bh.delete(e))]:n.Jh?(n.kh.Ga(r.targetId),n.kh.Ba(r.targetId)?[3,2]:[4,_c(n.Cu,r.targetId,!1).then((function(){n.kh.Ha(r.targetId),Vc(n.Oh,r.targetId),zh(n,r.targetId)})).catch(Nc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return zh(n,r.targetId),[4,_c(n.Cu,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Ch(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o,u;return s(this,(function(s){switch(s.label){case 0:r=uf(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Wr(t),i=oi.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ji());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Oc._s(t,o).next((function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=As(c,n.get(c.key));null!=h&&s.push(new Ss(c.key,h,Us(h.proto.mapValue),bs.exists(!0)))}return r.rs.Sr(t,i,s,e)}))})).then((function(t){var e=t.vn(n);return{batchId:t.batchId,Qn:e}}))}(r.Cu,e)];case 2:return i=s.sent(),r.kh.qa(i.batchId),function(t,e,n){var r=t.jh[t.currentUser.h()];r||(r=new Di(ni)),r=r.Tt(e,n),t.jh[t.currentUser.h()]=r}(r,i.batchId,n),[4,Hh(r,i.Qn)];case 3:return s.sent(),[4,Yc(r.Oh)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),u=Yu(o,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}}))}))}function Rh(t,e){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:n=Wr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,mc(n.Cu,e)];case 2:return r=i.sent(),e.re.forEach((function(t,e){var r=n.Kh.get(e);r&&(Kr(t._e.size+t.fe.size+t.de.size<=1),t._e.size>0?r.Fh=!0:t.fe.size>0?Kr(r.Fh):t.de.size>0&&(Kr(r.Fh),r.Fh=!1))})),[4,Hh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Nc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Lh(t,e,n){var r=Wr(t);if(r.Jh&&0===n||!r.Jh&&1===n){var i=[];r.Bh.forEach((function(t,n){var r=n.view.Yu(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Wr(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Yu(e)&&(r=!0)})),r&&hh(n)}(r.Mh,e),i.length&&r.Lh.au(i),r.onlineState=e,r.Jh&&r.kh.Za(e)}}function Vh(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o,u,a,c;return s(this,(function(s){switch(s.label){case 0:return(r=Wr(t)).kh.Ja(e,"rejected",n),i=r.Kh.get(e),(o=i&&i.key)?(u=(u=new Di(fi.$)).Tt(o,new Fs(o,si.min())),a=ji().add(o),c=new Ki(si.min(),new Map,new Oi(ni),u,a),[4,Rh(r,c)]):[3,2];case 1:return s.sent(),r.Qh=r.Qh.remove(o),r.Kh.delete(e),Wh(r),[3,4];case 2:return[4,_c(r.Cu,e,!1).then((function(){return zh(r,e,n)})).catch(Nc)];case 3:s.sent(),s.label=4;case 4:return[2]}}))}))}function Mh(t,e){return o(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:n=Wr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,yc(n.Cu,e)];case 2:return i=o.sent(),Fh(n,r,null),qh(n,r),n.kh.Qa(r,"acknowledged"),[4,Hh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Nc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Uh(t,e,n){return o(this,void 0,void 0,(function(){var r,i;return s(this,(function(o){switch(o.label){case 0:r=Wr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Wr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n.rs.Cr(t,e).next((function(e){return Kr(null!==e),r=e.keys(),n.rs.$r(t,e)})).next((function(){return n.rs.Ur(t)})).next((function(){return n.Oc._s(t,r)}))}))}(r.Cu,e)];case 2:return i=o.sent(),Fh(r,e,n),qh(r,e),r.kh.Qa(e,"rejected",n),[4,Hh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Nc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function jh(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u;return s(this,(function(s){switch(s.label){case 0:Fc((n=Wr(t)).Oh)||qr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Wr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e.rs.Or(t)}))}(n.Cu)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Gh.get(r)||[]).push(e),n.Gh.set(r,i),[3,4]);case 3:return o=s.sent(),u=Yu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}}))}))}function qh(t,e){(t.Gh.get(e)||[]).forEach((function(t){t.resolve()})),t.Gh.delete(e)}function Fh(t,e,n){var r=Wr(t),i=r.jh[r.currentUser.h()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.jh[r.currentUser.h()]=i}}function zh(t,e,n){void 0===n&&(n=null),t.kh.Ga(e);for(var r=0,i=t.qh.get(e);r<i.length;r++){var o=i[r];t.Bh.delete(o),n&&t.Lh.Xh(o,n)}t.qh.delete(e),t.Jh&&t.Wh.da(e).forEach((function(e){t.Wh.Qr(e)||Bh(t,e)}))}function Bh(t,e){var n=t.Qh.get(e);null!==n&&(Vc(t.Oh,n),t.Qh=t.Qh.remove(e),t.Kh.delete(n),Wh(t))}function Gh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Th?(t.Wh.Do(o.key,e),Kh(t,o)):o instanceof Ah?(qr("SyncEngine","Document no longer in limbo: "+o.key),t.Wh.No(o.key,e),t.Wh.Qr(o.key)||Bh(t,o.key)):Gr()}}function Kh(t,e){var n=e.key;t.Qh.get(n)||(qr("SyncEngine","New document in limbo: "+n),t.Uh.push(n),Wh(t))}function Wh(t){for(;t.Uh.length>0&&t.Qh.size<t.$h;){var e=t.Uh.shift(),n=t.zh.next();t.Kh.set(n,new xh(e)),t.Qh=t.Qh.Tt(e,n),Lc(t.Oh,new Ei(Js(Ks(e.path)),n,2,Cu.Ds))}}function Hh(t,e,n){return o(this,void 0,void 0,(function(){var r,i,u,a;return s(this,(function(c){switch(c.label){case 0:return r=Wr(t),i=[],u=[],a=[],r.Bh.W()?[3,3]:(r.Bh.forEach((function(t,o){a.push(r.Yh(o,e,n).then((function(t){if(t){r.Jh&&r.kh.Ja(o.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Pu.Vs(o.targetId,t);u.push(e)}})))})),[4,Promise.all(a)]);case 1:return c.sent(),r.Lh.au(i),[4,function(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u,a,c,h,f;return s(this,(function(s){switch(s.label){case 0:n=Wr(t),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Tu.forEach(e,(function(e){return Tu.forEach(e.gs,(function(r){return n.persistence.Vr.Do(t,e.targetId,r)})).next((function(){return Tu.forEach(e.ys,(function(r){return n.persistence.Vr.No(t,e.targetId,r)}))}))}))}))];case 2:return s.sent(),[3,4];case 3:if(!Uu(r=s.sent()))throw r;return qr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)u=o[i],a=u.targetId,u.fromCache||(c=n.Cc.get(a),h=c.ft,f=c.Et(h),n.Cc=n.Cc.Tt(a,f));return[2]}}))}))}(r.Cu,u)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Yh(t,e){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return(n=Wr(t)).currentUser.isEqual(e)?[3,3]:(qr("SyncEngine","User change. New user:",e.h()),[4,vc(n.Cu,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Gh.forEach((function(t){t.forEach((function(t){t.reject(new Yr(Hr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Gh.clear()}(n),n.kh.Xa(e,r.$c,r.Lc),[4,Hh(n,r.kc)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Qh(t,e){var n=Wr(t),r=n.Kh.get(e);if(r&&r.Fh)return ji().add(r.key);var i=ji(),o=n.qh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.Bh.get(a);i=i.Gt(c.view.Ph)}return i}function Xh(t,e){return o(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return[4,Ic((n=Wr(t)).Cu,e.query,!0)];case 1:return r=o.sent(),i=e.view.Nh(r),[2,(n.Jh&&Gh(n,e.targetId,i.Dh),i)]}}))}))}function $h(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){return[2,Tc((e=Wr(t)).Cu).then((function(t){return Hh(e,t)}))]}))}))}function Jh(t,e,n,r){return o(this,void 0,void 0,(function(){var i,o;return s(this,(function(s){switch(s.label){case 0:return[4,function(t,e){var n=Wr(t),r=Wr(n.rs);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.Nr(t,e).next((function(e){return e?n.Oc._s(t,e):Tu.resolve(null)}))}))}((i=Wr(t)).Cu,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Yc(i.Oh)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Fh(i,e,r||null),qh(i,e),function(t,e){Wr(Wr(t).rs).Br(e)}(i.Cu,e)):Gr(),s.label=4;case 4:return[4,Hh(i,o)];case 5:return s.sent(),[3,7];case 6:qr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}}))}))}function Zh(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u,a,c,h;return s(this,(function(s){switch(s.label){case 0:return sf(n=Wr(t)),uf(n),!0!==e||!0===n.Hh?[3,3]:(r=n.kh.$a(),[4,tf(n,r.H())]);case 1:return i=s.sent(),n.Hh=!0,[4,eh(n.Oh,!0)];case 2:for(s.sent(),o=0,u=i;o<u.length;o++)a=u[o],Lc(n.Oh,a);return[3,7];case 3:return!1!==e||!1===n.Hh?[3,7]:(c=[],h=Promise.resolve(),n.qh.forEach((function(t,e){n.kh.za(e)?c.push(e):h=h.then((function(){return zh(n,e),_c(n.Cu,e,!0)})),Vc(n.Oh,e)})),[4,h]);case 4:return s.sent(),[4,tf(n,c)];case 5:return s.sent(),function(t){var e=Wr(t);e.Kh.forEach((function(t,n){Vc(e.Oh,n)})),e.Wh.wa(),e.Kh=new Map,e.Qh=new Di(fi.$)}(n),n.Hh=!1,[4,eh(n.Oh,!1)];case 6:s.sent(),s.label=7;case 7:return[2]}}))}))}function tf(t,e,n){return o(this,void 0,void 0,(function(){var n,r,i,o,u,a,c,h,f,l,p,d,v,y;return s(this,(function(s){switch(s.label){case 0:n=Wr(t),r=[],i=[],o=0,u=e,s.label=1;case 1:return o<u.length?(a=u[o],c=void 0,(h=n.qh.get(a))&&0!==h.length?[4,bc(n.Cu,Js(h[0]))]:[3,7]):[3,13];case 2:c=s.sent(),f=0,l=h,s.label=3;case 3:return f<l.length?(p=l[f],d=n.Bh.get(p),[4,Xh(n,d)]):[3,6];case 4:(v=s.sent()).snapshot&&i.push(v.snapshot),s.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,Ec(n.Cu,a)];case 8:return y=s.sent(),[4,bc(n.Cu,y)];case 9:return c=s.sent(),[4,kh(n,ef(y),a,!1)];case 10:s.sent(),s.label=11;case 11:r.push(c),s.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Lh.au(i),r)]}}))}))}function ef(t){return Gs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function nf(t){var e=Wr(t);return Wr(Wr(e.Cu).persistence).Ic()}function rf(t,e,n,r){return o(this,void 0,void 0,(function(){var i,o,u;return s(this,(function(s){switch(s.label){case 0:return(i=Wr(t)).Hh?(qr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.qh.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Tc(i.Cu)];case 3:return o=s.sent(),u=Ki.ae(e,"current"===n),[4,Hh(i,o,u)];case 4:return s.sent(),[3,8];case 5:return[4,_c(i.Cu,e,!0)];case 6:return s.sent(),zh(i,e,r),[3,8];case 7:Gr(),s.label=8;case 8:return[2]}}))}))}function of(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o,u,a,c,h,f,l,p;return s(this,(function(d){switch(d.label){case 0:if(!(r=sf(t)).Hh)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(u=o[i],r.qh.has(u)?(qr("SyncEngine","Adding an already active target "+u),[3,5]):[4,Ec(r.Cu,u)]):[3,6];case 2:return a=d.sent(),[4,bc(r.Cu,a)];case 3:return c=d.sent(),[4,kh(r,ef(a),c.targetId,!1)];case 4:d.sent(),Lc(r.Oh,c),d.label=5;case 5:return i++,[3,1];case 6:h=function(t){return s(this,(function(e){switch(e.label){case 0:return r.qh.has(t)?[4,_c(r.Cu,t,!1).then((function(){Vc(r.Oh,t),zh(r,t)})).catch(Nc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},f=0,l=n,d.label=7;case 7:return f<l.length?(p=l[f],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return f++,[3,7];case 10:return[2]}}))}))}function sf(t){var e=Wr(t);return e.Oh.xu.Qu=Rh.bind(null,e),e.Oh.xu.Xe=Qh.bind(null,e),e.Oh.xu.Uu=Vh.bind(null,e),e.Lh.au=ah.bind(null,e.Mh),e.Lh.Xh=ch.bind(null,e.Mh),e}function uf(t){var e=Wr(t);return e.Oh.xu.Ku=Mh.bind(null,e),e.Oh.xu.Wu=Uh.bind(null,e),e}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var af=function(){function t(){}return t.prototype.Mc=function(t){this.Zh=t},t.prototype.ws=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.Tn.length||1===t.Tn.length&&t.Tn[0].field.tt())}(e)||n.isEqual(si.min())?this.tl(t,e):this.Zh._s(t,r).next((function(o){var s=i.el(e,o);return(Ws(e)||Hs(e))&&i.ph(e.limitType,s,r,n)?i.tl(t,e):(jr()<=c["in"].DEBUG&&qr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),nu(e)),i.Zh.ws(t,e,n).next((function(t){return s.forEach((function(e){t=t.Tt(e.key,e)})),t})))}))},t.prototype.el=function(t,e){var n=new Oi(iu(t));return e.forEach((function(e,r){r instanceof qs&&ru(t,r)&&(n=n.add(r))})),n},t.prototype.ph=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.F(r)>0)},t.prototype.tl=function(t,e){return jr()<=c["in"].DEBUG&&qr("IndexFreeQueryEngine","Using full collection scan to execute query:",nu(e)),this.Zh.ws(t,e,si.min())},t}(),cf=function(){function t(t,e){this.os=t,this.Vr=e,this.rs=[],this.nl=1,this.sl=new Oi(ph.ua)}return t.prototype.br=function(t){return Tu.resolve(0===this.rs.length)},t.prototype.Sr=function(t,e,n,r){var i=this.nl;this.nl++,this.rs.length>0&&this.rs[this.rs.length-1];var o=new _u(i,e,n,r);this.rs.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.sl=this.sl.add(new ph(a.key,i)),this.os.Dr(t,a.key.path.q())}return Tu.resolve(o)},t.prototype.Cr=function(t,e){return Tu.resolve(this.il(e))},t.prototype.Fr=function(t,e){var n=e+1,r=this.rl(n),i=r<0?0:r;return Tu.resolve(this.rs.length>i?this.rs[i]:null)},t.prototype.Or=function(){return Tu.resolve(0===this.rs.length?-1:this.nl-1)},t.prototype.Mr=function(t){return Tu.resolve(this.rs.slice())},t.prototype.us=function(t,e){var n=this,r=new ph(e,0),i=new ph(e,Number.POSITIVE_INFINITY),o=[];return this.sl.Kt([r,i],(function(t){var e=n.il(t.Ta);o.push(e)})),Tu.resolve(o)},t.prototype.ds=function(t,e){var n=this,r=new Oi(ni);return e.forEach((function(t){var e=new ph(t,0),i=new ph(t,Number.POSITIVE_INFINITY);n.sl.Kt([e,i],(function(t){r=r.add(t.Ta)}))})),Tu.resolve(this.ol(r))},t.prototype.Rs=function(t,e){var n=e.path,r=n.length+1,i=n;fi.ot(i)||(i=i.child(""));var o=new ph(new fi(i),0),s=new Oi(ni);return this.sl.Wt((function(t){var e=t.key.path;return!!n.j(e)&&(e.length===r&&(s=s.add(t.Ta)),!0)}),o),Tu.resolve(this.ol(s))},t.prototype.ol=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.il(t);null!==r&&n.push(r)})),n},t.prototype.$r=function(t,e){var n=this;Kr(0===this.cl(e.batchId,"removed")),this.rs.shift();var r=this.sl;return Tu.forEach(e.mutations,(function(i){var o=new ph(i.key,e.batchId);return r=r.delete(o),n.Vr.qr(t,i.key)})).next((function(){n.sl=r}))},t.prototype.Br=function(t){},t.prototype.Qr=function(t,e){var n=new ph(e,0),r=this.sl.jt(n);return Tu.resolve(e.isEqual(r&&r.key))},t.prototype.Ur=function(t){return this.rs.length,Tu.resolve()},t.prototype.cl=function(t,e){return this.rl(t)},t.prototype.rl=function(t){return 0===this.rs.length?0:t-this.rs[0].batchId},t.prototype.il=function(t){var e=this.rl(t);return e<0||e>=this.rs.length?null:this.rs[e]},t}(),hf=function(){function t(t,e){this.os=t,this.ul=e,this.docs=new Di(fi.$),this.size=0}return t.prototype.jn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.ul(e);return this.docs=this.docs.Tt(r,{zn:e,size:s,readTime:n}),this.size+=s-o,this.os.Dr(t,r.path.q())},t.prototype.Hn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Jn=function(t,e){var n=this.docs.get(e);return Tu.resolve(n?n.zn:null)},t.prototype.getEntries=function(t,e){var n=this,r=Ri();return e.forEach((function(t){var e=n.docs.get(t);r=r.Tt(t,e?e.zn:null)})),Tu.resolve(r)},t.prototype.ws=function(t,e,n){for(var r=Vi(),i=new fi(e.path.child("")),o=this.docs.Vt(i);o.Nt();){var s=o.Ct(),u=s.key,a=s.value,c=a.zn,h=a.readTime;if(!e.path.j(u.path))break;h.F(n)<=0||c instanceof qs&&ru(e,c)&&(r=r.Tt(c.key,c))}return Tu.resolve(r)},t.prototype.al=function(t,e){return Tu.forEach(this.docs,(function(t){return e(t)}))},t.prototype.Xr=function(t){return new ff(this)},t.prototype.eo=function(t){return Tu.resolve(this.size)},t}(),ff=function(t){function e(e){var n=this;return(n=t.call(this)||this).no=e,n}return i(e,t),e.prototype.Zn=function(t){var e=this,n=[];return this.Qn.forEach((function(r,i){i&&i.zn?n.push(e.no.jn(t,i.zn,e.Wn(r))):e.no.Hn(r)})),Tu.qn(n)},e.prototype.Yn=function(t,e){return this.no.Jn(t,e)},e.prototype.Xn=function(t,e){return this.no.getEntries(t,e)},e}(Au),lf=function(){function t(t){this.persistence=t,this.hl=new Eu((function(t){return gi(t)}),mi),this.lastRemoteSnapshotVersion=si.min(),this.highestTargetId=0,this.ll=0,this._l=new lh,this.targetCount=0,this.fl=tc.lo()}return t.prototype.Ue=function(t,e){return this.hl.forEach((function(t,n){return e(n)})),Tu.resolve()},t.prototype.To=function(t){return Tu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Io=function(t){return Tu.resolve(this.ll)},t.prototype.fo=function(t){return this.highestTargetId=this.fl.next(),Tu.resolve(this.highestTargetId)},t.prototype.mo=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ll&&(this.ll=e),Tu.resolve()},t.prototype.Ro=function(t){this.hl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fl=new tc(e),this.highestTargetId=e),t.sequenceNumber>this.ll&&(this.ll=t.sequenceNumber)},t.prototype.Ao=function(t,e){return this.Ro(e),this.targetCount+=1,Tu.resolve()},t.prototype.yo=function(t,e){return this.Ro(e),Tu.resolve()},t.prototype.Vo=function(t,e){return this.hl.delete(e.target),this._l.da(e.targetId),this.targetCount-=1,Tu.resolve()},t.prototype.mr=function(t,e,n){var r=this,i=0,o=[];return this.hl.forEach((function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.hl.delete(s),o.push(r.po(t,u.targetId)),i++)})),Tu.qn(o).next((function(){return i}))},t.prototype.vo=function(t){return Tu.resolve(this.targetCount)},t.prototype.bo=function(t,e){var n=this.hl.get(e)||null;return Tu.resolve(n)},t.prototype.So=function(t,e,n){return this._l.la(e,n),Tu.resolve()},t.prototype.Co=function(t,e,n){this._l.fa(e,n);var r=this.persistence.Vr,i=[];return r&&e.forEach((function(e){i.push(r.qr(t,e))})),Tu.qn(i)},t.prototype.po=function(t,e){return this._l.da(e),Tu.resolve()},t.prototype.xo=function(t,e){var n=this._l.Ea(e);return Tu.resolve(n)},t.prototype.Qr=function(t,e){return Tu.resolve(this._l.Qr(e))},t}(),pf=function(){function t(t){this.serializer=t,this.dl=new Map,this.wl=new Map}return t.prototype.ro=function(t,e){return Tu.resolve(this.dl.get(e))},t.prototype.oo=function(t,e){var n;return this.dl.set(e.id,{id:(n=e).id,version:n.version,createTime:Co(n.createTime)}),Tu.resolve()},t.prototype.co=function(t,e){return Tu.resolve(this.wl.get(e))},t.prototype.uo=function(t,e){var n;return this.wl.set(e.name,{name:(n=e).name,query:va(n.bundledQuery),readTime:Co(n.readTime)}),Tu.resolve()},t}(),df=function(){function t(t,e){var n=this;this.El={},this.ko=new Cu(0),this.$o=!1,this.$o=!0,this.Vr=t(this),this.jo=new lf(this),this.os=new xa,this.ss=function(t,e){return new hf(t,(function(t){return n.Vr.Tl(t)}))}(this.os),this.serializer=new oa(e),this.Go=new pf(this.serializer)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.fc=function(){return this.$o=!1,Promise.resolve()},Object.defineProperty(t.prototype,"lr",{get:function(){return this.$o},enumerable:!1,configurable:!0}),t.prototype.tc=function(){},t.prototype.ec=function(){},t.prototype.Pc=function(){return this.os},t.prototype.mc=function(t){var e=this.El[t.h()];return e||(e=new cf(this.os,this.Vr),this.El[t.h()]=e),e},t.prototype.Ac=function(){return this.jo},t.prototype.Rc=function(){return this.ss},t.prototype.gc=function(){return this.Go},t.prototype.runTransaction=function(t,e,n){var r=this;qr("MemoryPersistence","Starting transaction:",t);var i=new vf(this.ko.next());return this.Vr.Il(),n(i).next((function(t){return r.Vr.ml(i).next((function(){return t}))})).Ln().then((function(t){return i.ns(),t}))},t.prototype.Al=function(t,e){return Tu.Un(Object.values(this.El).map((function(n){return function(){return n.Qr(t,e)}})))},t}(),vf=function(t){function e(e){var n=this;return(n=t.call(this)||this).Fo=e,n}return i(e,t),e}(Ou),yf=function(){function t(t){this.persistence=t,this.Rl=new lh,this.Pl=null}return t.gl=function(e){return new t(e)},Object.defineProperty(t.prototype,"yl",{get:function(){if(this.Pl)return this.Pl;throw Gr()},enumerable:!1,configurable:!0}),t.prototype.Do=function(t,e,n){return this.Rl.Do(n,e),this.yl.delete(n.toString()),Tu.resolve()},t.prototype.No=function(t,e,n){return this.Rl.No(n,e),this.yl.add(n.toString()),Tu.resolve()},t.prototype.qr=function(t,e){return this.yl.add(e.toString()),Tu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.Rl.da(e.targetId).forEach((function(t){return n.yl.add(t.toString())}));var r=this.persistence.Ac();return r.xo(t,e.targetId).next((function(t){t.forEach((function(t){return n.yl.add(t.toString())}))})).next((function(){return r.Vo(t,e)}))},t.prototype.Il=function(){this.Pl=new Set},t.prototype.ml=function(t){var e=this,n=this.persistence.Rc().Xr();return Tu.forEach(this.yl,(function(r){var i=fi.st(r);return e.Vl(t,i).next((function(t){t||n.Hn(i)}))})).next((function(){return e.Pl=null,n.apply(t)}))},t.prototype.Sc=function(t,e){var n=this;return this.Vl(t,e).next((function(t){t?n.yl.delete(e.toString()):n.yl.add(e.toString())}))},t.prototype.Tl=function(t){return 0},t.prototype.Vl=function(t,e){var n=this;return Tu.Un([function(){return Tu.resolve(n.Rl.Qr(e))},function(){return n.persistence.Ac().Qr(t,e)},function(){return n.persistence.Al(t,e)}])},t}(),gf=function(){function t(t){this.pl=t.pl,this.vl=t.vl}return t.prototype.cu=function(t){this.bl=t},t.prototype.nu=function(t){this.Sl=t},t.prototype.onMessage=function(t){this.Dl=t},t.prototype.close=function(){this.vl()},t.prototype.send=function(t){this.pl(t)},t.prototype.Cl=function(){this.bl()},t.prototype.Nl=function(t){this.Sl(t)},t.prototype.xl=function(t){this.Dl(t)},t}(),mf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},wf=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.i=e.i,n}return i(e,t),e.prototype.Ll=function(t,e,n,r){return new Promise((function(i,o){var s=new Cr;s.listenOnce(kr.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case Or.NO_ERROR:var e=s.getResponseJson();qr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case Or.TIMEOUT:qr("Connection",'RPC "'+t+'" timed out'),o(new Yr(Hr.DEADLINE_EXCEEDED,"Request time out"));break;case Or.HTTP_ERROR:var n=s.getStatus();if(qr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=t.toLowerCase().replace("_","-");return Object.values(Hr).indexOf(e)>=0?e:Hr.UNKNOWN}(r.status);o(new Yr(u,r.message))}else o(new Yr(Hr.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Yr(Hr.UNAVAILABLE,"Connection failed."));break;default:Gr()}}finally{qr("Connection",'RPC "'+t+'" completed.')}}));var u=JSON.stringify(r);s.send(e,"POST",u,n,15)}))},e.prototype.uu=function(t,e){var n=[this.Ol,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Sr(),i={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.$l(i.initMessageHeaders,e),(0,h.uI)()||(0,h.b$)()||(0,h.d)()||(0,h.w1)()||(0,h.Mn)()||(0,h.ru)()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");qr("Connection","Creating WebChannel: "+o,i);var s=r.createWebChannel(o,i),u=!1,a=!1,c=new gf({pl:function(t){a?qr("Connection","Not sending because WebChannel is closed:",t):(u||(qr("Connection","Opening WebChannel transport."),s.open(),u=!0),qr("Connection","WebChannel sending:",t),s.send(t))},vl:function(){return s.close()}}),f=function(t,e){s.listen(t,(function(t){try{e(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(Pr.EventType.OPEN,(function(){a||qr("Connection","WebChannel transport opened.")})),f(Pr.EventType.CLOSE,(function(){a||(a=!0,qr("Connection","WebChannel transport closed"),c.Nl())})),f(Pr.EventType.ERROR,(function(t){a||(a=!0,zr("Connection","WebChannel transport errored:",t),c.Nl(new Yr(Hr.UNAVAILABLE,"The operation could not be completed")))})),f(Pr.EventType.MESSAGE,(function(t){var e;if(!a){var n=t.data[0];Kr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){qr("Connection","WebChannel received error:",i);var o=i.status,u=function(t){var e=_i[t];if(void 0!==e)return Ni(e)}(o),h=i.message;void 0===u&&(u=Hr.INTERNAL,h="Unknown error status: "+o+" with message "+i.message),a=!0,c.Nl(new Yr(u,h)),s.close()}else qr("Connection","WebChannel received:",n),c.xl(n)}})),setTimeout((function(){c.Cl()}),0),c},e}(function(){function t(t){this.Fl=t,this.t=t.t;var e=t.ssl?"https":"http";this.Ol=e+"://"+t.host,this.Ml="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}return t.prototype.Au=function(t,e,n,r){var i=this.kl(t,e);qr("RestConnection","Sending: ",i,n);var o={};return this.$l(o,r),this.Ll(t,i,o,n).then((function(t){return qr("RestConnection","Received: ",t),t}),(function(e){throw zr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Ru=function(t,e,n,r){return this.Au(t,e,n,r)},t.prototype.$l=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.1.0",t["Content-Type"]="text/plain",e)for(var n in e.T)e.T.hasOwnProperty(n)&&(t[n]=e.T[n])},t.prototype.kl=function(t,e){var n=mf[t];return this.Ol+"/v1/"+e+":"+n},t}()),bf=function(){function t(){var t=this;this.Bl=function(){return t.ql()},this.Ul=function(){return t.Ql()},this.Kl=[],this.Wl()}return t.prototype.Lu=function(t){this.Kl.push(t)},t.prototype.fc=function(){window.removeEventListener("online",this.Bl),window.removeEventListener("offline",this.Ul)},t.prototype.Wl=function(){window.addEventListener("online",this.Bl),window.addEventListener("offline",this.Ul)},t.prototype.ql=function(){qr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(0)},t.prototype.Ql=function(){qr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kl;t<e.length;t++)(0,e[t])(1)},t.Gs=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),_f=function(){function t(){}return t.prototype.Lu=function(t){},t.prototype.fc=function(){},t}(),If=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.serializer=Du(t.Fl.t),this.kh=this.jl(t),this.persistence=this.Gl(t),[4,this.persistence.start()];case 1:return e.sent(),this.zl=this.Hl(t),this.Cu=this.Jl(t),[2]}}))}))},t.prototype.Hl=function(t){return null},t.prototype.Jl=function(t){return dc(this.persistence,new af,t.Yl,this.serializer)},t.prototype.Gl=function(t){return new df(yf.gl,this.serializer)},t.prototype.jl=function(t){return new Eh},t.prototype.terminate=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.zl&&this.zl.stop(),[4,this.kh.fc()];case 1:return t.sent(),[4,this.persistence.fc()];case 2:return t.sent(),[2]}}))}))},t}(),Ef=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Xl=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return i(e,t),e.prototype.initialize=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Ac(this.Cu)];case 2:return n.sent(),[4,this.Xl.initialize(this,e)];case 3:return n.sent(),[4,uf(this.Xl.ga)];case 4:return n.sent(),[4,Yc(this.Xl.Oh)];case 5:return n.sent(),[2]}}))}))},e.prototype.Jl=function(t){return dc(this.persistence,new af,t.Yl,this.serializer)},e.prototype.Hl=function(t){var e=this.persistence.Vr.cr;return new Zu(e,t.di)},e.prototype.Gl=function(t){var e=lc(t.Fl.t,t.Fl.persistenceKey),n=void 0!==this.cacheSizeBytes?Ju.er(this.cacheSizeBytes):Ju.ir;return new uc(this.synchronizeTabs,e,t.clientId,n,t.di,Gu(),Ku(),this.serializer,this.kh,!!this.forceOwnership)},e.prototype.jl=function(t){return new Eh},e}(If),Tf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Xl=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return i(e,t),e.prototype.initialize=function(e){return o(this,void 0,void 0,(function(){var n,r=this;return s(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Xl.ga,this.kh instanceof Ih?(this.kh.ga={_h:Jh.bind(null,n),fh:rf.bind(null,n),dh:of.bind(null,n),Ic:nf.bind(null,n),lh:$h.bind(null,n)},[4,this.kh.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.Zo((function(t){return o(r,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,Zh(this.Xl.ga,t)];case 1:return e.sent(),this.zl&&(t&&!this.zl.lr?this.zl.start(this.Cu):t||this.zl.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.jl=function(t){var e=Gu();if(!Ih.Gs(e))throw new Yr(Hr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=lc(t.Fl.t,t.Fl.persistenceKey);return new Ih(e,t.di,n,t.clientId,t.Yl)},e}(Ef),Af=function(){function t(){}return t.prototype.initialize=function(t,e){return o(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){switch(r.label){case 0:return this.Cu?[3,2]:(this.Cu=t.Cu,this.kh=t.kh,this.Nu=this.Zl(e),this.Oh=this.t_(e),this.Mh=this.e_(e),this.ga=this.n_(e,!t.synchronizeTabs),this.kh.Pu=function(t){return Lh(n.ga,t,1)},this.Oh.xu.s_=Yh.bind(null,this.ga),[4,eh(this.Oh,this.ga.Jh)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.e_=function(t){return new oh},t.prototype.Zl=function(t){var e,n=Du(t.Fl.t),r=(e=t.Fl,new wf(e));return function(t,e,n){return new Oc(t,e,n)}(t.credentials,r,n)},t.prototype.t_=function(t){var e,n,r,i,o,s=this;return e=this.Cu,n=this.Nu,r=t.di,i=function(t){return Lh(s.ga,t,0)},o=bf.Gs()?new bf:new _f,new Pc(e,n,r,i,o)},t.prototype.n_=function(t,e){return function(t,e,n,r,i,o,s){var u=new Sh(t,e,n,r,i,o);return s&&(u.Hh=!0),u}(this.Cu,this.Oh,this.Mh,this.kh,t.Yl,t.$h,e)},t.prototype.terminate=function(){return function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return e=Wr(t),qr("RemoteStore","RemoteStore shutting down."),e.Mu.add(5),[4,Rc(e)];case 1:return n.sent(),e.$u.fc(),e.Bu.set("Unknown"),[2]}}))}))}(this.Oh)},t}(),Nf=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.i_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.i_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.r_=function(){this.muted=!0},t.prototype.i_=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),Df=function(t){this.o_=t};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xf(t,e,n){if(!n)throw new Yr(Hr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Sf(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Of(t,e,n,r){if(!0===e&&!0===r)throw new Yr(Hr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function kf(t){if(!fi.ot(t))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Pf(t){if(fi.ot(t))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Cf(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Gr()}function Rf(t,e){if(t instanceof Df&&(t=t.o_),!(t instanceof e)){if(e.name===t.constructor.name)throw new Yr(Hr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Cf(t);throw new Yr(Hr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Lf(t,e){if(e<=0)throw new Yr(Hr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vf=function(t){this.c_=t},Mf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.u_=function(t){if(2!==t.a_)throw 1===t.a_?t.h_(this.c_+"() can only appear at the top level of your update data"):t.h_(this.c_+"() cannot be used with set() unless you pass {merge:true}");return t.en.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Vf);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uf(t,e,n){return new Fl({a_:3,l_:e.settings.l_,methodName:t.c_,__:n},e.t,e.serializer,e.ignoreUndefinedProperties)}var jf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.u_=function(t){return new ms(t.path,new cs)},e.prototype.isEqual=function(t){return t instanceof e},e}(Vf),qf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return i(e,t),e.prototype.u_=function(t){var e=Uf(this,t,!0),n=this.f_.map((function(t){return Hl(t,e)})),r=new hs(n);return new ms(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Vf),Ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).f_=n,r}return i(e,t),e.prototype.u_=function(t){var e=Uf(this,t,!0),n=this.f_.map((function(t){return Hl(t,e)})),r=new ls(n);return new ms(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Vf),zf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).d_=n,r}return i(e,t),e.prototype.u_=function(t){var e=new ds(t.serializer,So(t.serializer,this.d_));return new ms(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Vf),Bf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Yr(Hr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Yr(Hr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.w_=t,this.E_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.w_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.E_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.w_===t.w_&&this.E_===t.E_},t.prototype.toJSON=function(){return{latitude:this.w_,longitude:this.E_}},t.prototype.C=function(t){return ni(this.w_,t.w_)||ni(this.E_,t.E_)},t}(),Gf=function(){function t(t){this.T_=t}return t.fromBase64String=function(e){try{return new t(bi.fromBase64String(e))}catch(e){throw new Yr(Hr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(bi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.T_.toBase64()},t.prototype.toUint8Array=function(){return this.T_.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.T_.isEqual(t.T_)},t}(),Kf=new Map,Wf=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Yr(Hr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Yr(Hr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Of("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Hf=function(){function t(t,e){this.I_="(lite)",this.m_=new Wf({}),this.A_=!1,t instanceof Vr?(this.R_=t,this.P_=new Xr):(this.g_=t,this.R_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Yr(Hr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Vr(t.options.projectId)}(t),this.P_=new $r(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this.g_)throw new Yr(Hr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.g_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y_",{get:function(){return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"V_",{get:function(){return void 0!==this.p_},enumerable:!1,configurable:!0}),t.prototype.v_=function(t){if(this.A_)throw new Yr(Hr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.m_=new Wf(t),void 0!==t.credentials&&(this.P_=function(t){if(!t)return new Xr;switch(t.type){case"gapi":var e=t.client;return Kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Zr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Yr(Hr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype.b_=function(){return this.m_},t.prototype.S_=function(){return this.A_=!0,this.m_},t.prototype._delete=function(){return this.p_||(this.p_=this.D_()),this.p_},t.prototype.D_=function(){return function(t){var e=Kf.get(t);e&&(qr("ComponentProvider","Removing Datastore"),Kf.delete(t),e.terminate())}(this),Promise.resolve()},t}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yf(){if("undefined"==typeof Uint8Array)throw new Yr(Hr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Qf(){if("undefined"==typeof atob)throw new Yr(Hr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Xf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.fromBase64String=function(t){Qf();try{return new e(bi.fromBase64String(t))}catch(t){throw new Yr(Hr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){return Yf(),new e(bi.fromUint8Array(t))},e.prototype.toBase64=function(){return Qf(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return Yf(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(Gf),$f=function(){function t(){}return t.prototype.C_=function(t,e){switch(void 0===e&&(e="none"),uo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yo(t.integerValue||t.doubleValue);case 3:return this.N_(t.timestampValue);case 4:return this.x_(t,e);case 5:return t.stringValue;case 6:return this.F_(go(t.bytesValue));case 7:return this.O_(t.referenceValue);case 8:return this.M_(t.geoPointValue);case 9:return this.k_(t.arrayValue,e);case 10:return this.L_(t.mapValue,e);default:throw Gr()}},t.prototype.L_=function(t,e){var n=this,r={};return eo(t.fields||{},(function(t,i){r[t]=n.C_(i,e)})),r},t.prototype.M_=function(t){return new Bf(yo(t.latitude),yo(t.longitude))},t.prototype.k_=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.C_(t,e)}))},t.prototype.x_=function(t,e){switch(e){case"previous":var n=io(t);return null==n?null:this.C_(n,e);case"estimate":return this.N_(oo(t));default:return null}},t.prototype.N_=function(t){var e=vo(t);return new oi(e.seconds,e.nanos)},t.prototype.B_=function(t,e){var n=ai.Y(t);Kr(is(n));var r=new Vr(n.get(1),n.get(3)),i=new fi(n.B(5));return r.isEqual(e)||Fr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}(),Jf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.F_=function(t){return new Xf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return Ap.q_(e,this.firestore,null)},e}($f),Zf=function(){function t(t,e,n,r,i){this.U_=t,this.Q_=e,this.K_=n,this.W_=r,this.j_=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new yl(this.U_,this.j_,this.K_)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this.W_},t.prototype.data=function(){if(this.W_){if(this.j_){var t=new tl(this.U_,this.Q_,this.K_,this.W_,null);return this.j_.fromFirestore(t)}return this.Q_.C_(this.W_.En())}},t.prototype.get=function(t){if(this.W_){var e=this.W_.data().field(el("DocumentSnapshot.get",t));if(null!==e)return this.Q_.C_(e)}},t}(),tl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Zf);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function el(t,e){return"string"==typeof e?Zl(t,e):e instanceof Df?e.o_.G_:e.G_}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nl=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.G_=new hi(t)}return t.prototype.isEqual=function(t){return this.G_.isEqual(t.G_)},t}(),rl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).z_=new Hu,r.I_="name"in e?e.name:"[DEFAULT]",r}return i(e,t),e.prototype.D_=function(){return this.H_||Ip(this),this.H_.terminate()},e}(Hf);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function il(t,e,n){var r=this,i=new Nu;return t.di.enqueue((function(){return o(r,void 0,void 0,(function(){var r;return s(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,op(t,n)];case 1:return o.sent(),[4,sp(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Hr.FAILED_PRECONDITION||t.code===Hr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function ol(t){if(t.y_||t.V_)throw new Yr(Hr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sl=function(t){function e(e,n,r,i,o,s){var u=this;return(u=t.call(this,e,n,r,i,s)||this).U_=e,u.J_=e,u.metadata=o,u}return i(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this.W_){if(this.j_){var e=new ul(this.U_,this.Q_,this.K_,this.W_,this.metadata,null);return this.j_.fromFirestore(e,t)}return this.Q_.C_(this.W_.En(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this.W_){var n=this.W_.data().field(el("DocumentSnapshot.get",t));if(null!==n)return this.Q_.C_(n,e.serverTimestamps)}},e}(Zf),ul=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(sl),al=function(){function t(t,e,n,r){this.U_=t,this.Q_=e,this.Y_=r,this.metadata=new Sp(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Y_.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this.Y_.docs.forEach((function(r){t.call(e,new ul(n.U_,n.Q_,r.key,r,new Sp(n.Y_.ee.has(r.key),n.Y_.fromCache),n.query.j_))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this.Y_.se)throw new Yr(Hr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.X_&&this.Z_===e||(this.X_=function(t,e){if(t.Y_.te.W()){var n=0;return t.Y_.docChanges.map((function(e){var r=new ul(t.U_,t.Q_,e.doc.key,e.doc,new Sp(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t.Y_.te;return t.Y_.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new ul(t.U_,t.Q_,e.doc.key,e.doc,new Sp(t.Y_.ee.has(e.doc.key),t.Y_.fromCache),t.query.j_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:cl(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this.Z_=e),this.X_},t}();function cl(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gr()}}function hl(t,e){return t instanceof sl&&e instanceof sl?t.U_===e.U_&&t.K_.isEqual(e.K_)&&(null===t.W_?null===e.W_:t.W_.isEqual(e.W_))&&t.j_===e.j_:t instanceof al&&e instanceof al&&t.U_===e.U_&&Ll(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t.Y_.isEqual(e.Y_)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.F_=function(t){return new Gf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new yl(this.firestore,null,e)},e}($f);function ll(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Rf(t.firestore,rl),s=Vl(o);return e instanceof Df&&(e=e.o_),dl(o,("string"==typeof e||e instanceof nl?Kl(s,"updateDoc",t.K_,e,n,r):Gl(s,"updateDoc",t.K_,e)).ef(t.K_,bs.exists(!0)))}function pl(t){for(var e,n,r,i=this,u=[],a=1;a<arguments.length;a++)u[a-1]=arguments[a];var c={includeMetadataChanges:!1},h=0;"object"!=typeof u[h]||xu(u[h])||(c=u[h],h++);var f,l,p,d={includeMetadataChanges:c.includeMetadataChanges};if(xu(u[h])){var v=u[h];u[h]=null===(e=v.next)||void 0===e?void 0:e.bind(v),u[h+1]=null===(n=v.error)||void 0===n?void 0:n.bind(v),u[h+2]=null===(r=v.complete)||void 0===r?void 0:r.bind(v)}if(t instanceof yl)l=Rf(t.firestore,rl),p=Ks(t.K_.path),f={next:function(e){u[h]&&u[h](vl(l,t,e))},error:u[h+1],complete:u[h+2]};else{l=Rf(t.firestore,rl),p=t.tf;var y=new fl(l);f={next:function(e){u[h]&&u[h](new al(l,y,t,e))},error:u[h+1],complete:u[h+2]},Sl(t.tf)}var g=_p(l),m=new Nf(f),w=new fh(p,m,d);return l.z_.Ri((function(){return o(i,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=sh,[4,pp(g)];case 1:return[2,t.apply(void 0,[e.sent(),w])]}}))}))})),function(){m.r_(),l.z_.Ri((function(){return o(i,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=uh,[4,pp(g)];case 1:return[2,t.apply(void 0,[e.sent(),w])]}}))}))}))}}function dl(t,e){return function(t,e){var n=this,r=new Nu;return t.di.Ri((function(){return o(n,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return n=Ch,[4,lp(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(_p(t),e)}function vl(t,e,n){var r=n.docs.get(e.K_),i=new fl(t);return new sl(t,i,e.K_,r,new Sp(n.hasPendingWrites,n.fromCache),e.j_)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yl=function(){function t(t,e,n){this.j_=e,this.K_=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"nf",{get:function(){return this.K_.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this.K_.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this.K_.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ol(this.firestore,this.j_,this.K_.path.q())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this.K_)},t}(),gl=function(){function t(t,e,n){this.j_=e,this.tf=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this.tf)},t}(),ml=function(){};function wl(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o.sf(t)}return t}var bl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).rf=e,i.cf=n,i.uf=r,i.type="where",i}return i(e,t),e.prototype.sf=function(t){var e=Vl(t.firestore),n=function(t,e,n,r,i,o,s){var u;if(i.tt()){if("array-contains"===o||"array-contains-any"===o)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Dl(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var f=h[c];a.push(Nl(r,t,f))}u={arrayValue:{values:a}}}else u=Nl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Dl(s,o),u=Wl(n,"where",s,"in"===o||"not-in"===o);var l=ou.create(i,o,u);return function(t,e){if(e.An()){var n=Qs(t);if(null!==n&&!n.isEqual(e.field))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Ys(t);null!==r&&xl(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Yr(Hr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Yr(Hr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(t.tf,0,e,t.firestore.R_,this.rf,this.cf,this.uf);return new gl(t.firestore,t.j_,function(t,e){var n=t.filters.concat([e]);return new Bs(t.path,t.collectionGroup,t.Tn.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,n))},e}(ml),_l=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).rf=e,r.af=n,r.type="orderBy",r}return i(e,t),e.prototype.sf=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new mu(e,n);return function(t,e){if(null===Ys(t)){var n=Qs(t);null!==n&&xl(t,n,e.field)}}(t,r),r}(t.tf,this.rf,this.af);return new gl(t.firestore,t.j_,function(t,e){var n=t.Tn.concat([e]);return new Bs(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t.tf,e))},e}(ml),Il=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.hf=n,i.lf=r,i}return i(e,t),e.prototype.sf=function(t){return new gl(t.firestore,t.j_,Zs(t.tf,this.hf,this.lf))},e}(ml),El=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return i(e,t),e.prototype.sf=function(t){var e=Al(t,this.type,this._f,this.ff);return new gl(t.firestore,t.j_,function(t,e){return new Bs(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t.tf,e))},e}(ml),Tl=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i._f=n,i.ff=r,i}return i(e,t),e.prototype.sf=function(t){var e=Al(t,this.type,this._f,this.ff);return new gl(t.firestore,t.j_,function(t,e){return new Bs(t.path,t.collectionGroup,t.Tn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t.tf,e))},e}(ml);function Al(t,e,n,r){if(n[0]instanceof Df&&(n[0]=n[0].o_),n[0]instanceof Zf)return function(t,e,n,r,i){if(!r)throw new Yr(Hr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=$s(t);s<u.length;s++){var a=u[s];if(a.field.tt())o.push(mo(e,r.key));else{var c=r.field(a.field);if(ro(c))throw new Yr(Hr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.J();throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new du(o,i)}(t.tf,t.firestore.R_,e,n[0].W_,r);var i=Vl(t.firestore);return function(t,e,n,r,i,o){var s=t.Tn;if(i.length>s.length)throw new Yr(Hr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.tt()){if("string"!=typeof c)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Xs(t)&&-1!==c.indexOf("/"))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ai.Y(c));if(!fi.ot(h))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new fi(h);u.push(mo(e,f))}else{var l=Wl(n,r,c);u.push(l)}}return new du(u,o)}(t.tf,t.firestore.R_,i,e,n,r)}function Nl(t,e,n){if(n instanceof Df&&(n=n.o_),"string"==typeof n){if(""===n)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xs(e)&&-1!==n.indexOf("/"))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ai.Y(n));if(!fi.ot(r))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return mo(t,new fi(r))}if(n instanceof yl)return mo(t,n.K_);throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Cf(n)+".")}function Dl(t,e){if(!Array.isArray(t)||0===t.length)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function xl(t,e,n){if(!n.isEqual(e))throw new Yr(Hr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Sl(t){if(Hs(t)&&0===t.Tn.length)throw new Yr(Hr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ol=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,Ks(r))||this).firestore=e,i.nf=r,i.type="collection",i}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.tf.path.K()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.tf.path.J()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.nf.q();return t.W()?null:new yl(this.firestore,null,new fi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this.nf)},e}(gl);function kl(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(xf("collection","path",e),t instanceof Hf){var i=ai.Y.apply(ai,u([e],n));return Pf(i),new Ol(t,null,i)}if(!(t instanceof yl||t instanceof Ol))throw new Yr(Hr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=ai.Y.apply(ai,u([t.path],n)).child(ai.Y(e));return Pf(o),new Ol(t.firestore,null,o)}function Pl(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(1===arguments.length&&(e=ei.D()),xf("doc","path",e),t instanceof Hf){var i=ai.Y.apply(ai,u([e],n));return kf(i),new yl(t,null,new fi(i))}if(!(t instanceof yl||t instanceof Ol))throw new Yr(Hr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=t.nf.child(ai.Y.apply(ai,u([e],n)));return kf(o),new yl(t.firestore,t instanceof Ol?t.j_:null,new fi(o))}var Cl=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return i(e,t),e.prototype.F_=function(t){return new Gf(t)},e.prototype.O_=function(t){var e=this.B_(t,this.firestore.R_);return new yl(this.firestore,null,e)},e}($f);function Rl(t,e){return(t instanceof yl||t instanceof Ol)&&(e instanceof yl||e instanceof Ol)&&t.firestore===e.firestore&&t.path===e.path&&t.j_===e.j_}function Ll(t,e){return t instanceof gl&&e instanceof gl&&t.firestore===e.firestore&&tu(t.tf,e.tf)&&t.j_===e.j_}function Vl(t){var e=t.S_(),n=Du(t.R_);return new zl(t.R_,!!e.ignoreUndefinedProperties,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ml=/^__.*__$/,Ul=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[];return null!==this.en?n.push(new Ss(t,this.data,this.en,e)):n.push(new xs(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new ks(t,this.fieldTransforms)),n},t}(),jl=function(){function t(t,e,n){this.data=t,this.en=e,this.fieldTransforms=n}return t.prototype.ef=function(t,e){var n=[new Ss(t,this.data,this.en,e)];return this.fieldTransforms.length>0&&n.push(new ks(t,this.fieldTransforms)),n},t}();function ql(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Gr()}}var Fl=function(){function t(t,e,n,r,i,o){this.settings=t,this.t=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.df(),this.fieldTransforms=i||[],this.en=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a_",{get:function(){return this.settings.a_},enumerable:!1,configurable:!0}),t.prototype.wf=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.t,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.en)},t.prototype.Ef=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.Tf(t),r},t.prototype.If=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.wf({path:n,__:!1});return r.df(),r},t.prototype.mf=function(t){return this.wf({path:void 0,__:!0})},t.prototype.h_=function(t){return tp(t,this.settings.methodName,this.settings.Af||!1,this.path,this.settings.l_)},t.prototype.contains=function(t){return void 0!==this.en.find((function(e){return t.j(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.j(e.field)}))},t.prototype.df=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Tf(this.path.get(t))},t.prototype.Tf=function(t){if(0===t.length)throw this.h_("Document fields must not be empty");if(ql(this.a_)&&Ml.test(t))throw this.h_('Document fields cannot begin and end with "__"')},t}(),zl=function(){function t(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.serializer=n||Du(t)}return t.prototype.Rf=function(t,e,n,r){return void 0===r&&(r=!1),new Fl({a_:t,methodName:e,l_:n,path:hi.X(),__:!1,Af:r},this.t,this.serializer,this.ignoreUndefinedProperties)},t}();function Bl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Rf(o.merge||o.mergeFields?2:0,e,n,i);Xl("Data must be an object, but it was:",s,r);var u,a,c=Yl(r,s);if(o.merge)u=new gs(s.en),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=$l(e,l[f],n);if(!s.contains(p))throw new Yr(Hr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ep(h,p)||h.push(p)}u=new gs(h),a=s.fieldTransforms.filter((function(t){return u.un(t.field)}))}else u=null,a=s.fieldTransforms;return new Ul(new Vs(c),u,a)}function Gl(t,e,n,r){var i=t.Rf(1,e,n);Xl("Data must be an object, but it was:",i,r);var o=[],s=new Ms;eo(r,(function(t,r){var u=Zl(e,t,n);r instanceof Df&&(r=r.o_);var a=i.If(u);if(r instanceof Mf)o.push(u);else{var c=Hl(r,a);null!=c&&(o.push(u),s.set(u,c))}}));var u=new gs(o);return new jl(s.hn(),u,i.fieldTransforms)}function Kl(t,e,n,r,i,o){var s=t.Rf(1,e,n),u=[$l(e,r,n)],a=[i];if(o.length%2!=0)throw new Yr(Hr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push($l(e,o[c])),a.push(o[c+1]);for(var h=[],f=new Ms,l=u.length-1;l>=0;--l)if(!ep(h,u[l])){var p=u[l],d=a[l];d instanceof Df&&(d=d.o_);var v=s.If(p);if(d instanceof Mf)h.push(p);else{var y=Hl(d,v);null!=y&&(h.push(p),f.set(p,y))}}var g=new gs(h);return new jl(f.hn(),g,s.fieldTransforms)}function Wl(t,e,n,r){return void 0===r&&(r=!1),Hl(n,t.Rf(r?4:3,e))}function Hl(t,e){if(t instanceof Df&&(t=t.o_),Ql(t))return Xl("Unsupported field value:",e,t),Yl(t,e);if(t instanceof Vf)return function(t,e){if(!ql(e.a_))throw e.h_(t.c_+"() can only be used with update() and set()");if(!e.path)throw e.h_(t.c_+"() is not currently supported inside arrays");var n=t.u_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.en.push(e.path),t instanceof Array){if(e.settings.__&&4!==e.a_)throw e.h_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=Hl(o[i],e.mf(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(t instanceof Df&&(t=t.o_),null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return So(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=oi.fromDate(t);return{timestampValue:Oo(e.serializer,n)}}if(t instanceof oi){var r=new oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Oo(e.serializer,r)}}if(t instanceof Bf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gf)return{bytesValue:ko(e.serializer,t.T_)};if(t instanceof yl){var i=e.t,o=t.firestore.R_;if(!o.isEqual(i))throw e.h_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Ro(t.firestore.R_||e.t,t.K_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.h_("Unsupported field value: "+Cf(t))}(t,e)}function Yl(t,e){var n={};return no(t)?e.path&&e.path.length>0&&e.en.push(e.path):eo(t,(function(t,r){var i=Hl(r,e.Ef(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Ql(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof oi||t instanceof Bf||t instanceof Gf||t instanceof yl||t instanceof Vf)}function Xl(t,e,n){if(!Ql(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Cf(n);throw"an object"===r?e.h_(t+" a custom object"):e.h_(t+" "+r)}}function $l(t,e,n){if(e instanceof Df&&(e=e.o_),e instanceof nl)return e.G_;if("string"==typeof e)return Zl(t,e);throw tp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Jl=new RegExp("[~\\*/\\[\\]]");function Zl(t,e,n){if(e.search(Jl)>=0)throw tp("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(nl.bind.apply(nl,u([void 0],e.split("."))))).G_}catch(O){throw tp("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function tp(t,e,n,r,i){var o=r&&!r.W(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Yr(Hr.INVALID_ARGUMENT,(u+=". ")+t+a)}function ep(t,e){return t.some((function(t){return t.isEqual(e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var np=function(){function t(t){this.Nu=t,this.Pf=new Map,this.mutations=[],this.gf=!1,this.yf=null,this.Vf=new Set}return t.prototype.pf=function(t){return o(this,void 0,void 0,(function(){var e,n=this;return s(this,(function(r){switch(r.label){case 0:if(this.vf(),this.mutations.length>0)throw new Yr(Hr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return o(this,void 0,void 0,(function(){var n,r,i,o,u,a;return s(this,(function(s){switch(s.label){case 0:return n=Wr(t),r=qo(n.serializer)+"/documents",i={documents:e.map((function(t){return Vo(n.serializer,t)}))},[4,n.Ru("BatchGetDocuments",r,i)];case 1:return o=s.sent(),u=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Kr(!!e.found),e.found.name,e.found.updateTime;var n=Mo(t,e.found.name),r=Co(e.found.updateTime),i=new Vs({mapValue:{fields:e.found.fields}});return new qs(n,r,i,{})}(t,e):"missing"in e?function(t,e){Kr(!!e.missing),Kr(!!e.readTime);var n=Mo(t,e.missing),r=Co(e.readTime);return new Fs(n,r)}(t,e):Gr()}(n.serializer,t);u.set(e.key.toString(),e)})),a=[],[2,(e.forEach((function(t){var e=u.get(t.toString());Kr(!!e),a.push(e)})),a)]}}))}))}(this.Nu,t)];case 1:return[2,((e=r.sent()).forEach((function(t){t instanceof Fs||t instanceof qs?n.bf(t):Gr()})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.ef(t,this.rn(t))),this.Vf.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.ef(t,this.Sf(t)))}catch(t){this.yf=t}this.Vf.add(t.toString())},t.prototype.delete=function(t){this.write([new Rs(t,this.rn(t))]),this.Vf.add(t.toString())},t.prototype.commit=function(){return o(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(n){switch(n.label){case 0:if(this.vf(),this.yf)throw this.yf;return t=this.Pf,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=fi.st(n);e.mutations.push(new Ls(r,e.rn(r)))})),[4,function(t,e){return o(this,void 0,void 0,(function(){var n,r,i;return s(this,(function(o){switch(o.label){case 0:return n=Wr(t),r=qo(n.serializer)+"/documents",i={writes:e.map((function(t){return Bo(n.serializer,t)}))},[4,n.Au("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.Nu,this.mutations)];case 1:return n.sent(),this.gf=!0,[2]}}))}))},t.prototype.bf=function(t){var e;if(t instanceof qs)e=t.version;else{if(!(t instanceof Fs))throw Gr();e=si.min()}var n=this.Pf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Yr(Hr.ABORTED,"Document version changed between two reads.")}else this.Pf.set(t.key.toString(),e)},t.prototype.rn=function(t){var e=this.Pf.get(t.toString());return!this.Vf.has(t.toString())&&e?bs.updateTime(e):bs.on()},t.prototype.Sf=function(t){var e=this.Pf.get(t.toString());if(!this.Vf.has(t.toString())&&e){if(e.isEqual(si.min()))throw new Yr(Hr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return bs.updateTime(e)}return bs.exists(!0)},t.prototype.write=function(t){this.vf(),this.mutations=this.mutations.concat(t)},t.prototype.vf=function(){},t}(),rp=function(){function t(t,e,n,r){this.di=t,this.Nu=e,this.updateFunction=n,this.Ti=r,this.Df=5,this.Si=new Ru(this.di,"transaction_retry")}return t.prototype.run=function(){this.Cf()},t.prototype.Cf=function(){var t=this;this.Si.Bs((function(){return o(t,void 0,void 0,(function(){var t,e,n=this;return s(this,(function(r){return t=new np(this.Nu),(e=this.Nf(t))&&e.then((function(e){n.di.Ri((function(){return t.commit().then((function(){n.Ti.resolve(e)})).catch((function(t){n.xf(t)}))}))})).catch((function(t){n.xf(t)})),[2]}))}))}))},t.prototype.Nf=function(t){try{var e=this.updateFunction(t);return!li(e)&&e.catch&&e.then?e:(this.Ti.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ti.reject(t),null}},t.prototype.xf=function(t){var e=this;this.Df>0&&this.Ff(t)?(this.Df-=1,this.di.Ri((function(){return e.Cf(),Promise.resolve()}))):this.Ti.reject(t)},t.prototype.Ff=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Ai(e)}return!1},t}(),ip=function(){function t(t,e,n){var r=this;this.credentials=t,this.di=e,this.Fl=n,this.user=Mr.UNAUTHENTICATED,this.clientId=ei.D(),this.Of=function(){},this.g=new Nu,this.credentials.A((function(t){qr("FirestoreClient","Received user=",t.uid),r.user.isEqual(t)||(r.user=t,r.Of(t)),r.g.resolve()}))}return t.prototype.getConfiguration=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.g.promise];case 1:return[2,(t.sent(),{di:this.di,Fl:this.Fl,clientId:this.clientId,credentials:this.credentials,Yl:this.user,$h:100})]}}))}))},t.prototype.Mf=function(t){var e=this;this.Of=t,this.g.promise.then((function(){return e.Of(e.user)}))},t.prototype.kf=function(){if(this.di.Ci)throw new Yr(Hr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.di.Oi();var e=new Nu;return this.di.Ni((function(){return o(t,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.$f?[4,this.$f.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.Lf?[4,this.Lf.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.R(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Yu(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(t,e){return o(this,void 0,void 0,(function(){var n,r=this;return s(this,(function(i){switch(i.label){case 0:return t.di.Li(),qr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=i.sent(),[4,e.initialize(n)];case 2:return i.sent(),t.Mf((function(n){return t.di.Mi((function(){return o(r,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,vc(e.Cu,n)];case 1:return t.sent(),[2]}}))}))}))})),e.persistence.tc((function(){return t.terminate()})),t.Lf=e,[2]}}))}))}function sp(t,e){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return t.di.Li(),[4,up(t)];case 1:return n=i.sent(),qr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.Mf((function(n){return t.di.Mi((function(){return function(t,e){return o(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return(n=Wr(t)).di.Li(),qr("RemoteStore","RemoteStore received new credentials"),r=Fc(n),n.Mu.add(3),[4,Rc(n)];case 1:return i.sent(),r&&n.Bu.set("Unknown"),[4,n.xu.s_(e)];case 2:return i.sent(),n.Mu.delete(3),[4,Cc(n)];case 3:return i.sent(),[2]}}))}))}(e.Oh,n)}))})),t.$f=e,[2]}}))}))}function up(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t.Lf?[3,2]:(qr("FirestoreClient","Using default OfflineComponentProvider"),[4,op(t,new If)]);case 1:e.sent(),e.label=2;case 2:return[2,t.Lf]}}))}))}function ap(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return t.$f?[3,2]:(qr("FirestoreClient","Using default OnlineComponentProvider"),[4,sp(t,new Af)]);case 1:e.sent(),e.label=2;case 2:return[2,t.$f]}}))}))}function cp(t){return up(t).then((function(t){return t.persistence}))}function hp(t){return up(t).then((function(t){return t.Cu}))}function fp(t){return ap(t).then((function(t){return t.Oh}))}function lp(t){return ap(t).then((function(t){return t.ga}))}function pp(t){return o(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,ap(t)];case 1:return e=r.sent(),[2,((n=e.Mh).Ju=Oh.bind(null,e.ga),n.Zu=Ph.bind(null,e.ga),n)]}}))}))}function dp(t,e,n,r,i){var o=new Nf({next:function(o){e.Ri((function(){return uh(t,s)}));var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Yr(Hr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Yr(Hr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new fh(Ks(n.path),o,{includeMetadataChanges:!0,oa:!0});return sh(t,s)}function vp(t,e,n,r,i){var o=new Nf({next:function(n){e.Ri((function(){return uh(t,s)})),n.fromCache&&"server"===r.source?i.reject(new Yr(Hr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new fh(n,o,{includeMetadataChanges:!0,oa:!0});return sh(t,s)}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yp=function(){function t(t,e){this.U_=t,this.Bf=e,this.qf=[],this.Uf=!1,this.Qf=Vl(t)}return t.prototype.set=function(t,e,n){this.Kf();var r=gp(t,this.U_),i=Mp(r.j_,e,n),o=Bl(this.Qf,"WriteBatch.set",r.K_,i,null!==r.j_,n);return this.qf=this.qf.concat(o.ef(r.K_,bs.on())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.Kf();var o,s=gp(t,this.U_);return e instanceof Df&&(e=e.o_),o="string"==typeof e||e instanceof nl?Kl(this.Qf,"WriteBatch.update",s.K_,e,n,r):Gl(this.Qf,"WriteBatch.update",s.K_,e),this.qf=this.qf.concat(o.ef(s.K_,bs.exists(!0))),this},t.prototype.delete=function(t){this.Kf();var e=gp(t,this.U_);return this.qf=this.qf.concat(new Rs(e.K_,bs.on())),this},t.prototype.commit=function(){return this.Kf(),this.Uf=!0,this.qf.length>0?this.Bf(this.qf):Promise.resolve()},t.prototype.Kf=function(){if(this.Uf)throw new Yr(Hr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function gp(t,e){if(t instanceof Df&&(t=t.o_),t.firestore!==e)throw new Yr(Hr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).U_=e,r}return i(e,t),e.prototype.get=function(e){var n=this,r=gp(e,this.U_),i=new fl(this.U_);return t.prototype.get.call(this,e).then((function(t){return new sl(n.U_,i,r.K_,t.W_,new Sp(!1,!1),r.j_)}))},e}(function(){function t(t,e){this.U_=t,this.Wf=e,this.Qf=Vl(t)}return t.prototype.get=function(t){var e=this,n=gp(t,this.U_),r=new Cl(this.U_);return this.Wf.pf([n.K_]).then((function(t){if(!t||1!==t.length)return Gr();var i=t[0];if(i instanceof Fs)return new Zf(e.U_,r,n.K_,null,n.j_);if(i instanceof qs)return new Zf(e.U_,r,i.key,i,n.j_);throw Gr()}))},t.prototype.set=function(t,e,n){var r=gp(t,this.U_),i=Mp(r.j_,e,n),o=Bl(this.Qf,"Transaction.set",r.K_,i,null!==r.j_,n);return this.Wf.set(r.K_,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,s=gp(t,this.U_);return e instanceof Df&&(e=e.o_),o="string"==typeof e||e instanceof nl?Kl(this.Qf,"Transaction.update",s.K_,e,n,r):Gl(this.Qf,"Transaction.update",s.K_,e),this.Wf.update(s.K_,o),this},t.prototype.delete=function(t){var e=gp(t,this.U_);return this.Wf.delete(e.K_),this},t}()),wp=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ol(t);var n=_p(t),r=t.S_(),i=new Af;return il(n,i,new Ef(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.o_,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ol(t);var e=_p(t),n=t.S_(),r=new Af;return il(e,r,new Tf(r,n.cacheSizeBytes))}(t.o_)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.y_&&!t.V_)throw new Yr(Hr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Nu;return t.z_.Ni((function(){return o(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return Lu.Gs()?(e=t+"main",[4,Lu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(lc(t.R_,t.I_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t.o_)},t}(),bp=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n)||this).jf=r,i.INTERNAL={delete:function(){return i.terminate()}},e instanceof Vr||(i.Gf=e),i}return i(e,t),Object.defineProperty(e.prototype,"R_",{get:function(){return this.o_.R_},enumerable:!1,configurable:!0}),e.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.o_.b_()),t)).merge,this.o_.v_(t)},e.prototype.useEmulator=function(t,e){"firestore.googleapis.com"!==this.o_.b_().host&&zr("Host has been set in both settings() and useEmulator(), emulator host will be used"),this.settings({host:t+":"+e,ssl:!1,merge:!0})},e.prototype.enableNetwork=function(){return function(t){return function(t){var e=this;return t.di.enqueue((function(){return o(e,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,cp(t)];case 1:return e=r.sent(),[4,fp(t)];case 2:return n=r.sent(),[2,(e.ec(!0),function(t){var e=Wr(t);return e.Mu.delete(0),Cc(e)}(n))]}}))}))}))}(_p(t))}(this.o_)},e.prototype.disableNetwork=function(){return function(t){return function(t){var e=this;return t.di.enqueue((function(){return o(e,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,cp(t)];case 1:return e=r.sent(),[4,fp(t)];case 2:return n=r.sent(),[2,(e.ec(!1),function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return(e=Wr(t)).Mu.add(0),[4,Rc(e)];case 1:return n.sent(),e.Bu.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(_p(t))}(this.o_)},e.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Of("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.jf.enableMultiTabIndexedDbPersistence(this):this.jf.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.jf.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.app._removeServiceInstance("firestore-exp"),this.o_._delete()},e.prototype.waitForPendingWrites=function(){return function(t){return function(t){var e=this,n=new Nu;return t.di.Ri((function(){return o(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return e=jh,[4,lp(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(_p(t))}(this.o_)},e.prototype.onSnapshotsInSync=function(t){return function(t,e){var n=this,r=_p(t),i=xu(e)?e:{next:e},u=new Nf(i);return t.z_.Ri((function(){return o(n,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=function(t,e){Wr(t).Hu.add(e),e.next()},[4,pp(r)];case 1:return t.apply(void 0,[e.sent(),u]),[2]}}))}))})),function(){u.r_(),t.z_.Ri((function(){return o(n,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return t=function(t,e){Wr(t).Hu.delete(e)},[4,pp(r)];case 1:return t.apply(void 0,[e.sent(),u]),[2]}}))}))}))}}(this.o_,t)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Gf)throw new Yr(Hr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Gf},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Lp(this,kl(this.o_,t))}catch(t){throw Np(t,"collection()","Firestore.collection()")}},e.prototype.doc=function(t){try{return new Ap(this,Pl(this.o_,t))}catch(t){throw Np(t,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(t){try{return new Pp(this,function(t,e){if(xf("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new gl(t,null,function(t){return new Bs(ai.X(),t)}(e))}(this.o_,t))}catch(t){throw Np(t,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Nu;return t.di.Ri((function(){return o(n,void 0,void 0,(function(){var n;return s(this,(function(i){switch(i.label){case 0:return[4,function(t){return ap(t).then((function(t){return t.Nu}))}(t)];case 1:return n=i.sent(),new rp(t.di,n,e,r).run(),[2]}}))}))})),r.promise}(_p(t),(function(n){return e(new mp(t,n))}))}(this.o_,(function(n){return t(new Ep(e,n))}))},e.prototype.batch=function(){var t=this;return _p(this.o_),new Tp(new yp(this.o_,(function(e){return dl(t.o_,e)})))},e}(Df);function _p(t){return t.H_||Ip(t),t.H_.kf(),t.H_}function Ip(t){var e=t.S_(),n=function(t,e,n){return new Lr(t,e,n.host,n.ssl,n.experimentalForceLongPolling,n.experimentalAutoDetectLongPolling)}(t.R_,t.I_,e);t.H_=new ip(t.P_,t.z_,n)}var Ep=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return i(e,t),e.prototype.get=function(t){var e=this,n=Vp(t);return this.o_.get(n).then((function(t){return new Op(e.U_,t)}))},e.prototype.set=function(t,e,n){var r=Vp(t);return n?(Sf("Transaction.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Vp(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,u([s,e,n],i)),this},e.prototype.delete=function(t){var e=Vp(t);return this.o_.delete(e),this},e}(Df),Tp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.set=function(t,e,n){var r=Vp(t);return n?(Sf("WriteBatch.set",n),this.o_.set(r,e,n)):this.o_.set(r,e),this},e.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=Vp(t);return 2===arguments.length?this.o_.update(s,e):(r=this.o_).update.apply(r,u([s,e,n],i)),this},e.prototype.delete=function(t){var e=Vp(t);return this.o_.delete(e),this},e.prototype.commit=function(){return this.o_.commit()},e}(Df),Ap=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r.Q_=new Jf(e),r}return i(e,t),e.zf=function(t,n,r){if(t.length%2!=0)throw new Yr(Hr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.J()+" has "+t.length);return new e(n,new yl(n.o_,r,new fi(t)))},e.q_=function(t,n,r){return new e(n,new yl(n.o_,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Lp(this.firestore,this.o_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){try{return new Lp(this.firestore,kl(this.o_,t))}catch(t){throw Np(t,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(t){return t instanceof Df&&(t=t.o_),t instanceof yl&&Rl(this.o_,t)},e.prototype.set=function(t,e){e=Sf("DocumentReference.set",e);try{return function(t,e,n){var r=Rf(t.firestore,rl),i=Mp(t.j_,e,n);return dl(r,Bl(Vl(r),"setDoc",t.K_,i,null!==t.j_,n).ef(t.K_,bs.on()))}(this.o_,t,e)}catch(t){throw Np(t,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?ll(this.o_,t):ll.apply(void 0,u([this.o_,t,e],n))}catch(t){throw Np(t,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return dl(Rf((t=this.o_).firestore,rl),[new Rs(t.K_,bs.on())]);var t},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dp(e),i=xp(e,(function(e){return new Op(t.firestore,new sl(t.firestore.o_,t.Q_,e.K_,e.W_,e.metadata,t.o_.j_))}));return pl(this.o_,r,i)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=Rf(t.firestore,rl),r=_p(n),i=new fl(n),u=new Nu;return n.z_.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,hp(r)];case 1:return[4,function(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=Wr(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Oc.cs(t,e)}))}(t,e)];case 1:return(r=s.sent())instanceof qs?n.resolve(r):r instanceof Fs?n.resolve(null):n.reject(new Yr(Hr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=Yu(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}}))}))}(e.sent(),t.K_,u)];case 2:return e.sent(),[2]}}))}))})),u.promise.then((function(e){return new sl(n,i,t.K_,e,new Sp(e instanceof qs&&e.an,!0),t.j_)}))}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=Rf(t.firestore,rl),r=_p(n),i=new Nu;return n.z_.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,pp(r)];case 1:return[4,dp(e.sent(),n.z_,t.K_,{source:"server"},i)];case 2:return e.sent(),[2]}}))}))})),i.promise.then((function(e){return vl(n,t,e)}))}(this.o_):function(t){var e=this,n=Rf(t.firestore,rl),r=_p(n),i=new Nu;return n.z_.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,pp(r)];case 1:return[4,dp(e.sent(),n.z_,t.K_,{source:"default"},i)];case 2:return e.sent(),[2]}}))}))})),i.promise.then((function(e){return vl(n,t,e)}))}(this.o_)).then((function(t){return new Op(e.firestore,new sl(e.firestore.o_,e.Q_,t.K_,t.W_,t.metadata,e.o_.j_))}))},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Df);function Np(t,e,n){return t.message=t.message.replace(e,n),t}function Dp(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!xu(r))return r}return{}}function xp(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=xu(t[0])?t[0]:xu(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Sp=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Op=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return i(e,t),Object.defineProperty(e.prototype,"ref",{get:function(){return new Ap(this.U_,this.o_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this.o_.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(t){return this.o_.data(t)},e.prototype.get=function(t,e){return this.o_.get(t,e)},e.prototype.isEqual=function(t){return hl(this.o_,t.o_)},e}(Df),kp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.data=function(t){return this.o_.data(t)},e}(Op),Pp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).firestore=e,r}return i(e,t),e.prototype.where=function(t,n,r){try{return new e(this.firestore,wl(this.o_,function(t,e,n){var r=e,i=el("where",t);return new bl(i,r,n)}(t,n,r)))}catch(t){throw Np(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,wl(this.o_,function(t,e){void 0===e&&(e="asc");var n=e,r=el("orderBy",t);return new _l(r,n)}(t,n)))}catch(t){throw Np(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,wl(this.o_,function(t){return Lf("limit",t),new Il("limit",t,"F")}(t)))}catch(t){throw Np(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,wl(this.o_,function(t){return Lf("limitToLast",t),new Il("limitToLast",t,"L")}(t)))}catch(t){throw Np(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,wl(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new El("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Np(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,wl(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new El("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Np(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,wl(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Tl("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Np(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,wl(this.o_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Tl("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Np(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(t){return Ll(this.o_,t.o_)},e.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=this,n=Rf(t.firestore,rl),r=_p(n),i=new fl(n),u=new Nu;return n.z_.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,hp(r)];case 1:return[4,function(t,e,n){return o(this,void 0,void 0,(function(){var r,i,o,u,a,c;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,Ic(t,e,!0)];case 1:return r=s.sent(),i=new Nh(e,r.Bc),o=i.gh(r.documents),u=i.Zn(o,!1),n.resolve(u.snapshot),[3,3];case 2:return a=s.sent(),c=Yu(a,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))}(e.sent(),t.tf,u)];case 2:return e.sent(),[2]}}))}))})),u.promise.then((function(e){return new al(n,i,t,e)}))}(this.o_):"server"===(null==t?void 0:t.source)?function(t){var e=this,n=Rf(t.firestore,rl),r=_p(n),i=new fl(n),u=new Nu;return n.z_.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,pp(r)];case 1:return[4,vp(e.sent(),n.z_,t.tf,{source:"server"},u)];case 2:return e.sent(),[2]}}))}))})),u.promise.then((function(e){return new al(n,i,t,e)}))}(this.o_):function(t){var e=this,n=Rf(t.firestore,rl),r=_p(n),i=new fl(n);Sl(t.tf);var u=new Nu;return n.z_.Ri((function(){return o(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,pp(r)];case 1:return[4,vp(e.sent(),n.z_,t.tf,{source:"default"},u)];case 2:return e.sent(),[2]}}))}))})),u.promise.then((function(e){return new al(n,i,t,e)}))}(this.o_)).then((function(t){return new Rp(e.firestore,t)}))},e.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dp(e),i=xp(e,(function(e){return new Rp(t.firestore,e)}));return pl(this.o_,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Df),Cp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return i(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.o_.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new kp(this.U_,this.o_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this.o_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this.o_.newIndex},enumerable:!1,configurable:!0}),e}(Df),Rp=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).U_=e,r}return i(e,t),Object.defineProperty(e.prototype,"query",{get:function(){return new Pp(this.U_,this.o_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.o_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.o_.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this.o_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var t=this;return this.o_.docs.map((function(e){return new kp(t.U_,e)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(t){var e=this;return this.o_.docChanges(t).map((function(t){return new Cp(e.U_,t)}))},e.prototype.forEach=function(t,e){var n=this;this.o_.forEach((function(r){t.call(e,new kp(n.U_,r))}))},e.prototype.isEqual=function(t){return hl(this.o_,t.o_)},e}(Df),Lp=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r.o_=n,r}return i(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.o_.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.o_.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.o_.parent;return t?new Ap(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new Ap(this.firestore,void 0===t?Pl(this.o_):Pl(this.o_,t))}catch(t){throw Np(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Rf(t.firestore,rl),r=Pl(t),i=Mp(t.j_,e);return dl(n,Bl(Vl(t.firestore),"addDoc",r.K_,i,null!==t.j_,{}).ef(r.K_,bs.exists(!1))).then((function(){return r}))}(this.o_,t).then((function(t){return new Ap(e.firestore,t)}))},e.prototype.isEqual=function(t){return Rl(this.o_,t.o_)},e.prototype.withConverter=function(t){return new e(this.firestore,this.o_.withConverter(t))},e}(Pp);function Vp(t){return t instanceof Df&&(t=t.o_),Rf(t,yl)}function Mp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Up=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,new(nl.bind.apply(nl,u([void 0],e))))||this}return i(e,t),e.documentId=function(){return new e(hi.et().J())},e.prototype.isEqual=function(t){return t instanceof Df&&(t=t.o_),t instanceof nl&&this.o_.G_.isEqual(t.G_)},e}(Df),jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.serverTimestamp=function(){var t=new jf("serverTimestamp");return t.c_="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new Mf("deleteField");return t.c_="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new qf("arrayUnion",t)}.apply(void 0,t);return r.c_="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ff("arrayRemove",t)}.apply(void 0,t);return r.c_="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(t){return new zf("increment",t)}(t);return n.c_="FieldValue.increment",new e(n)},e.prototype.isEqual=function(t){return this.o_.isEqual(t.o_)},e}(Df),qp={Firestore:bp,GeoPoint:Bf,Timestamp:oi,Blob:Xf,Transaction:Ep,WriteBatch:Tp,DocumentReference:Ap,DocumentSnapshot:Op,Query:Pp,QueryDocumentSnapshot:kp,QuerySnapshot:Rp,CollectionReference:Lp,FieldPath:Up,FieldValue:jp,setLogLevel:function(t){var e;e=t,Ur.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(t){!function(t,e){t.INTERNAL.registerComponent(new Rr.wA("firestore",(function(t){return function(t,e){return new bp(t,new rl(t,e),new wp)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},qp)))}(t),t.registerVersion("@firebase/firestore","2.0.3")}Fp(a.Z)}}]);
//# sourceMappingURL=170-legacy.84dab125.js.map